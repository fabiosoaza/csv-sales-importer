2020-09-20 14:40:09,240 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 10813 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 14:40:09,248 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 14:40:10,535 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 14:40:11,052 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 14:40:11,052 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 14:40:11,052 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 14:40:11,313 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 14:40:11,315 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 14:40:11,315 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 14:40:11,333 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 14:40:11,348 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in/
2020-09-20 14:40:11,353 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 1 routes, of which 1 are started
2020-09-20 14:40:11,365 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.051 seconds
2020-09-20 14:40:11,377 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.759 seconds (JVM running for 3.52)
2020-09-20 14:40:11,388 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 14:40:11,391 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 1 routes (timeout 45 seconds)
2020-09-20 14:40:11,401 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in/
2020-09-20 14:40:11,401 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 1 routes completed in 0 seconds
2020-09-20 14:40:11,411 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.098 seconds
2020-09-20 14:40:11,412 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.024 seconds
2020-09-20 14:41:23,229 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 10987 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 14:41:23,235 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 14:41:24,440 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 14:41:25,056 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 14:41:25,056 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 14:41:25,057 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 14:41:25,278 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 14:41:25,281 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 14:41:25,281 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 14:41:25,296 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 14:41:25,307 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 14:41:25,312 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 1 routes, of which 1 are started
2020-09-20 14:41:25,313 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.034 seconds
2020-09-20 14:41:25,319 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.66 seconds (JVM running for 3.508)
2020-09-20 14:41:25,331 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 14:41:25,338 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 1 routes (timeout 45 seconds)
2020-09-20 14:41:25,362 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 14:41:25,363 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 1 routes completed in 0 seconds
2020-09-20 14:41:25,372 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.093 seconds
2020-09-20 14:41:25,372 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.041 seconds
2020-09-20 14:43:27,285 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 11391 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 14:43:27,292 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 14:43:28,416 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 14:43:28,816 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 14:43:28,816 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 14:43:28,817 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 14:43:29,002 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 14:43:29,004 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 14:43:29,005 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 14:43:29,018 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 14:43:29,026 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 14:43:29,029 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 1 routes, of which 1 are started
2020-09-20 14:43:29,030 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.028 seconds
2020-09-20 14:43:29,036 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.258 seconds (JVM running for 2.945)
2020-09-20 14:43:29,054 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 14:43:29,056 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 1 routes (timeout 45 seconds)
2020-09-20 14:43:29,060 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 14:43:29,061 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 1 routes completed in 0 seconds
2020-09-20 14:43:29,067 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.065 seconds
2020-09-20 14:43:29,067 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.013 seconds
2020-09-20 14:44:37,020 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 11501 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 14:44:37,025 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 14:44:38,061 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 14:44:38,637 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 14:44:38,638 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 14:44:38,639 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 14:44:38,865 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 14:44:38,868 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 14:44:38,869 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 14:44:38,884 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 14:44:38,895 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 14:44:38,900 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 1 routes, of which 1 are started
2020-09-20 14:44:38,900 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.034 seconds
2020-09-20 14:44:38,908 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.523 seconds (JVM running for 3.321)
2020-09-20 14:44:38,937 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 14:44:38,940 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 1 routes (timeout 45 seconds)
2020-09-20 14:44:38,947 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 14:44:38,947 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 1 routes completed in 0 seconds
2020-09-20 14:44:38,959 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.093 seconds
2020-09-20 14:44:38,959 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.022 seconds
2020-09-20 14:46:00,003 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 11651 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 14:46:00,009 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 14:46:01,247 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 14:46:01,645 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=3000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 14:46:01,703 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 14:46:01,704 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 14:46:01,704 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 14:46:01,907 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 14:46:01,909 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 14:46:01,910 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 14:46:01,925 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 14:46:01,936 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 14:46:01,941 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 1 routes, of which 1 are started
2020-09-20 14:46:01,941 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.034 seconds
2020-09-20 14:46:01,948 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.559 seconds (JVM running for 3.412)
2020-09-20 14:46:01,959 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 14:46:01,963 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 1 routes (timeout 45 seconds)
2020-09-20 14:46:01,987 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 14:46:01,989 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 1 routes completed in 0 seconds
2020-09-20 14:46:01,998 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.091 seconds
2020-09-20 14:46:01,999 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.040 seconds
2020-09-20 14:55:01,914 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 11989 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 14:55:01,921 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 14:55:02,982 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 14:55:03,411 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file://home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=3000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 14:55:03,494 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 14:55:03,495 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 14:55:03,495 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 14:55:03,756 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 14:55:03,759 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 14:55:03,759 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 14:55:03,777 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 14:55:03,789 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file://home/fabio/Documents/sales-importer/in
2020-09-20 14:55:03,795 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 1 routes, of which 1 are started
2020-09-20 14:55:03,796 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.038 seconds
2020-09-20 14:55:03,804 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.477 seconds (JVM running for 3.306)
2020-09-20 14:55:03,845 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 14:55:03,848 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 1 routes (timeout 45 seconds)
2020-09-20 14:55:03,855 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file://home/fabio/Documents/sales-importer/in
2020-09-20 14:55:03,856 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 1 routes completed in 0 seconds
2020-09-20 14:55:03,866 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.109 seconds
2020-09-20 14:55:03,867 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.021 seconds
2020-09-20 14:55:36,295 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 12140 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 14:55:36,301 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 14:55:37,546 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 14:55:38,009 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file://home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=3000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 14:55:38,110 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 14:55:38,111 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 14:55:38,111 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 14:55:38,339 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 14:55:38,342 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 14:55:38,342 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 14:55:38,356 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 14:55:38,366 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file://home/fabio/Documents/sales-importer/in
2020-09-20 14:55:38,371 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 1 routes, of which 1 are started
2020-09-20 14:55:38,371 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.031 seconds
2020-09-20 14:55:38,377 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.696 seconds (JVM running for 4.064)
2020-09-20 14:55:38,403 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 14:55:38,409 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 1 routes (timeout 45 seconds)
2020-09-20 14:55:38,416 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file://home/fabio/Documents/sales-importer/in
2020-09-20 14:55:38,416 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 1 routes completed in 0 seconds
2020-09-20 14:55:38,424 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.084 seconds
2020-09-20 14:55:38,425 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.022 seconds
2020-09-20 14:56:08,141 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 12296 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 14:56:08,146 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 14:56:09,124 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 14:56:09,516 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:/home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=3000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 14:56:09,597 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 14:56:09,597 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 14:56:09,597 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 14:56:09,855 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 14:56:09,857 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 14:56:09,858 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 14:56:09,875 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 14:56:09,887 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 14:56:09,892 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 1 routes, of which 1 are started
2020-09-20 14:56:09,892 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.036 seconds
2020-09-20 14:56:09,899 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.242 seconds (JVM running for 3.813)
2020-09-20 14:56:09,936 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 14:56:09,938 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 1 routes (timeout 45 seconds)
2020-09-20 14:56:09,944 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 14:56:09,945 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 1 routes completed in 0 seconds
2020-09-20 14:56:09,953 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.097 seconds
2020-09-20 14:56:09,953 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.017 seconds
2020-09-20 14:59:35,777 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 12631 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 14:59:35,801 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 14:59:37,663 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 14:59:38,392 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:/home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=3000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 14:59:38,504 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 14:59:38,507 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 14:59:38,509 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 14:59:38,886 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 14:59:38,890 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 14:59:38,891 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 14:59:38,911 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 14:59:38,923 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 14:59:38,931 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 1 routes, of which 1 are started
2020-09-20 14:59:38,931 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.042 seconds
2020-09-20 14:59:38,936 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.078 seconds (JVM running for 5.677)
2020-09-20 14:59:39,044 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 14:59:39,048 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 1 routes (timeout 45 seconds)
2020-09-20 14:59:39,060 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 14:59:39,061 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 1 routes completed in 0 seconds
2020-09-20 14:59:39,070 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.181 seconds
2020-09-20 14:59:39,071 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.026 seconds
2020-09-20 15:03:05,930 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 13007 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 15:03:05,936 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 15:03:08,205 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 15:03:08,924 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=3000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 15:03:09,024 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 15:03:09,024 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 15:03:09,025 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 15:03:09,451 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 15:03:09,471 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 15:03:09,472 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 15:03:09,510 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 15:03:09,523 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:03:09,535 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 1 routes, of which 1 are started
2020-09-20 15:03:09,535 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.081 seconds
2020-09-20 15:03:09,542 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.722 seconds (JVM running for 6.498)
2020-09-20 15:03:09,584 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 15:03:09,589 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 1 routes (timeout 45 seconds)
2020-09-20 15:03:09,610 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:03:09,618 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 1 routes completed in 0 seconds
2020-09-20 15:03:09,626 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.172 seconds
2020-09-20 15:03:09,627 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.043 seconds
2020-09-20 15:15:22,512 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 14272 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 15:15:22,519 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 15:15:23,584 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 15:15:24,004 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=3000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors ]]
2020-09-20 15:15:24,082 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 15:15:24,083 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 15:15:24,083 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 15:15:24,306 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 15:15:24,308 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 15:15:24,308 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 15:15:24,323 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 15:15:24,335 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:15:24,339 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 1 routes, of which 1 are started
2020-09-20 15:15:24,339 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.033 seconds
2020-09-20 15:15:24,360 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.567 seconds (JVM running for 3.484)
2020-09-20 15:15:24,371 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 15:15:24,374 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 1 routes (timeout 45 seconds)
2020-09-20 15:15:24,379 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:15:24,379 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 1 routes completed in 0 seconds
2020-09-20 15:15:24,388 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.082 seconds
2020-09-20 15:15:24,388 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.017 seconds
2020-09-20 15:16:51,461 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 14481 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 15:16:51,467 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 15:16:52,696 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 15:16:53,150 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=3000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors ]]
2020-09-20 15:16:53,231 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 15:16:53,231 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 15:16:53,231 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 15:16:53,506 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 15:16:53,509 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 15:16:53,509 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 15:16:53,525 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 15:16:53,536 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:16:53,554 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 1 routes, of which 1 are started
2020-09-20 15:16:53,554 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.047 seconds
2020-09-20 15:16:53,559 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.833 seconds (JVM running for 3.649)
2020-09-20 15:16:53,569 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 15:16:53,572 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 1 routes (timeout 45 seconds)
2020-09-20 15:16:53,577 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:16:53,578 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 1 routes completed in 0 seconds
2020-09-20 15:16:53,588 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.081 seconds
2020-09-20 15:16:53,588 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.019 seconds
2020-09-20 15:21:07,847 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 14923 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 15:21:07,854 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 15:21:08,931 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 15:21:09,341 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=3000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors ]]&readLock=idempotent
2020-09-20 15:21:09,421 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 15:21:09,421 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 15:21:09,422 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 15:21:09,649 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLoggingListener -  - 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2020-09-20 15:21:09,656 [main] ERROR o.s.boot.SpringApplication -  - Application run failed
org.apache.camel.FailedToCreateRouteException: Failed to create route filesystemReadingId: Route(filesystemReadingId)[From[file:///home/fabio/Documents... because of Failed to resolve endpoint: file:///home/fabio/Documents/sales-importer/in?delay=3000&move=%2Fhome%2Ffabio%2FDocuments%2Fsales-importer%2Fout&moveFailed=%2Fhome%2Ffabio%2FDocuments%2Fsales-importer%2Ferrors+%5D%5D&readLock=idempotent&recursive=true&scheduler=spring&scheduler.cron=0%2F5+*+*+%3F+*+* due to: IdempotentRepository must be configured when using readLock=idempotent
	at org.apache.camel.reifier.RouteReifier.createRoute(RouteReifier.java:118)
	at org.apache.camel.impl.DefaultCamelContext.startRouteDefinitions(DefaultCamelContext.java:426)
	at org.apache.camel.impl.DefaultCamelContext.startRouteDefinitions(DefaultCamelContext.java:388)
	at org.apache.camel.impl.engine.AbstractCamelContext.doInit(AbstractCamelContext.java:2680)
	at org.apache.camel.support.service.BaseService.init(BaseService.java:83)
	at org.apache.camel.impl.engine.AbstractCamelContext.init(AbstractCamelContext.java:2452)
	at org.apache.camel.support.service.BaseService.start(BaseService.java:111)
	at org.apache.camel.impl.engine.AbstractCamelContext.start(AbstractCamelContext.java:2469)
	at org.apache.camel.spring.SpringCamelContext.start(SpringCamelContext.java:130)
	at org.apache.camel.spring.SpringCamelContext.onApplicationEvent(SpringCamelContext.java:167)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:172)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:165)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:139)
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:404)
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:361)
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:898)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:554)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:758)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:750)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:397)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:315)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1237)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1226)
	at com.github.fabiosoaza.salesimporter.application.SalesImporterApplication.main(SalesImporterApplication.java:12)
Caused by: org.apache.camel.ResolveEndpointFailedException: Failed to resolve endpoint: file:///home/fabio/Documents/sales-importer/in?delay=3000&move=%2Fhome%2Ffabio%2FDocuments%2Fsales-importer%2Fout&moveFailed=%2Fhome%2Ffabio%2FDocuments%2Fsales-importer%2Ferrors+%5D%5D&readLock=idempotent&recursive=true&scheduler=spring&scheduler.cron=0%2F5+*+*+%3F+*+* due to: IdempotentRepository must be configured when using readLock=idempotent
	at org.apache.camel.impl.engine.AbstractCamelContext.doGetEndpoint(AbstractCamelContext.java:888)
	at org.apache.camel.impl.engine.AbstractCamelContext.getEndpoint(AbstractCamelContext.java:777)
	at org.apache.camel.support.CamelContextHelper.getMandatoryEndpoint(CamelContextHelper.java:58)
	at org.apache.camel.reifier.AbstractReifier.resolveEndpoint(AbstractReifier.java:177)
	at org.apache.camel.reifier.RouteReifier.doCreateRoute(RouteReifier.java:250)
	at org.apache.camel.reifier.RouteReifier.createRoute(RouteReifier.java:112)
	... 23 common frames omitted
Caused by: java.lang.IllegalArgumentException: IdempotentRepository must be configured when using readLock=idempotent
	at org.apache.camel.component.file.GenericFileEndpoint.doInit(GenericFileEndpoint.java:1706)
	at org.apache.camel.support.service.BaseService.init(BaseService.java:83)
	at org.apache.camel.support.service.ServiceHelper.initService(ServiceHelper.java:55)
	at org.apache.camel.impl.engine.AbstractCamelContext.internalAddService(AbstractCamelContext.java:1476)
	at org.apache.camel.impl.engine.AbstractCamelContext.addService(AbstractCamelContext.java:1418)
	at org.apache.camel.impl.engine.AbstractCamelContext.addService(AbstractCamelContext.java:1413)
	at org.apache.camel.impl.engine.AbstractCamelContext.addService(AbstractCamelContext.java:1408)
	at org.apache.camel.impl.engine.AbstractCamelContext.doGetEndpoint(AbstractCamelContext.java:872)
	... 28 common frames omitted
2020-09-20 15:22:25,138 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 15145 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 15:22:25,228 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 15:22:26,338 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 15:22:26,710 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors ]]
2020-09-20 15:22:26,781 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 15:22:26,782 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 15:22:26,782 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 15:22:26,999 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 15:22:27,001 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 15:22:27,002 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 15:22:27,016 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 15:22:27,026 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:22:27,041 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 1 routes, of which 1 are started
2020-09-20 15:22:27,041 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.042 seconds
2020-09-20 15:22:27,049 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.591 seconds (JVM running for 3.375)
2020-09-20 15:22:27,058 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 15:22:27,061 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 1 routes (timeout 45 seconds)
2020-09-20 15:22:27,067 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:22:27,067 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 1 routes completed in 0 seconds
2020-09-20 15:22:27,078 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.079 seconds
2020-09-20 15:22:27,079 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.021 seconds
2020-09-20 15:22:52,154 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 15302 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 15:22:52,161 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 15:22:53,291 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 15:22:53,699 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 15:22:53,782 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 15:22:53,782 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 15:22:53,783 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 15:22:54,066 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 15:22:54,069 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 15:22:54,069 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 15:22:54,089 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 15:22:54,101 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:22:54,106 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 1 routes, of which 1 are started
2020-09-20 15:22:54,106 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.040 seconds
2020-09-20 15:22:54,113 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.706 seconds (JVM running for 3.479)
2020-09-20 15:22:54,147 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 15:22:54,151 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 1 routes (timeout 45 seconds)
2020-09-20 15:22:54,155 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:22:54,155 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 1 routes completed in 0 seconds
2020-09-20 15:22:54,162 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.096 seconds
2020-09-20 15:22:54,162 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.015 seconds
2020-09-20 15:32:18,438 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 15994 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 15:32:18,442 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 15:32:19,454 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 15:32:19,838 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 15:32:19,922 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 15:32:19,922 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 15:32:19,922 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 15:32:20,147 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLoggingListener -  - 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2020-09-20 15:32:20,153 [main] ERROR o.s.boot.SpringApplication -  - Application run failed
org.apache.camel.FailedToCreateRouteException: Failed to create route filesystemReadingId at: >>> To[salesImport] <<< in route: Route(filesystemReadingId)[From[file:///home/fabio/Documents... because of No endpoint could be found for: salesImport, please check your classpath contains the needed Camel component jar.
	at org.apache.camel.reifier.RouteReifier.doCreateRoute(RouteReifier.java:385)
	at org.apache.camel.reifier.RouteReifier.createRoute(RouteReifier.java:112)
	at org.apache.camel.impl.DefaultCamelContext.startRouteDefinitions(DefaultCamelContext.java:426)
	at org.apache.camel.impl.DefaultCamelContext.startRouteDefinitions(DefaultCamelContext.java:388)
	at org.apache.camel.impl.engine.AbstractCamelContext.doInit(AbstractCamelContext.java:2680)
	at org.apache.camel.support.service.BaseService.init(BaseService.java:83)
	at org.apache.camel.impl.engine.AbstractCamelContext.init(AbstractCamelContext.java:2452)
	at org.apache.camel.support.service.BaseService.start(BaseService.java:111)
	at org.apache.camel.impl.engine.AbstractCamelContext.start(AbstractCamelContext.java:2469)
	at org.apache.camel.spring.SpringCamelContext.start(SpringCamelContext.java:130)
	at org.apache.camel.spring.SpringCamelContext.onApplicationEvent(SpringCamelContext.java:167)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:172)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:165)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:139)
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:404)
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:361)
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:898)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:554)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:758)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:750)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:397)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:315)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1237)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1226)
	at com.github.fabiosoaza.salesimporter.application.SalesImporterApplication.main(SalesImporterApplication.java:12)
Caused by: org.apache.camel.NoSuchEndpointException: No endpoint could be found for: salesImport, please check your classpath contains the needed Camel component jar.
	at org.apache.camel.impl.engine.AbstractCamelContext.doGetEndpoint(AbstractCamelContext.java:840)
	at org.apache.camel.impl.engine.AbstractCamelContext.getEndpoint(AbstractCamelContext.java:777)
	at org.apache.camel.support.CamelContextHelper.resolveEndpoint(CamelContextHelper.java:123)
	at org.apache.camel.reifier.SendReifier.resolveEndpoint(SendReifier.java:43)
	at org.apache.camel.reifier.SendReifier.createProcessor(SendReifier.java:36)
	at org.apache.camel.reifier.ProcessorReifier.makeProcessor(ProcessorReifier.java:752)
	at org.apache.camel.reifier.ProcessorReifier.addRoutes(ProcessorReifier.java:495)
	at org.apache.camel.reifier.RouteReifier.doCreateRoute(RouteReifier.java:383)
	... 24 common frames omitted
2020-09-20 15:33:03,049 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 16055 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 15:33:03,054 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 15:33:04,205 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 15:33:04,647 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 15:33:04,716 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 15:33:04,716 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 15:33:04,717 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 15:33:04,958 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 15:33:04,960 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 15:33:04,960 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 15:33:04,979 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 15:33:04,990 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:33:04,991 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 15:33:04,996 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 2 routes, of which 2 are started
2020-09-20 15:33:04,996 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.038 seconds
2020-09-20 15:33:05,016 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.613 seconds (JVM running for 3.457)
2020-09-20 15:33:05,017 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG o.a.c.c.file.GenericFileConsumer -  - Took 0.016 seconds to poll: /home/fabio/Documents/sales-importer/in
2020-09-20 15:33:05,028 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG o.a.c.c.file.GenericFileConsumer -  - Total 1 files to consume
2020-09-20 15:33:05,030 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG o.a.c.c.file.GenericFileConsumer -  - About to process file: GenericFile[/home/fabio/Documents/sales-importer/in/sales.csv] using exchange: Exchange[]
2020-09-20 15:33:05,031 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 15:33:05,034 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 2 routes (timeout 45 seconds)
2020-09-20 15:33:05,039 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 15:33:05,040 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Waiting as there are still 2 inflight and pending exchanges to complete, timeout in 45 seconds. Inflights per route: [filesystemReadingId = 2]
2020-09-20 15:33:05,041 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 15:33:05,048 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG o.a.c.c.f.GenericFileOnCompletion -  - Done processing file: GenericFile[/home/fabio/Documents/sales-importer/in/sales.csv] using exchange: Exchange[]
2020-09-20 15:33:05,051 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG o.a.c.c.f.s.GenericFileProcessStrategySupport -  - Renaming file: GenericFile[/home/fabio/Documents/sales-importer/in/sales.csv] to: GenericFile[/home/fabio/Documents/sales-importer/out/sales.csv]
2020-09-20 15:33:06,041 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: salesImportId shutdown complete, was consuming from: direct://salesImport
2020-09-20 15:33:06,041 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:33:06,041 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 2 routes completed in 1 seconds
2020-09-20 15:33:06,050 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 1.092 seconds
2020-09-20 15:33:06,050 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 1.019 seconds
2020-09-20 15:34:22,249 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 16401 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 15:34:22,255 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 15:34:23,326 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 15:34:23,688 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 15:34:23,759 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 15:34:23,760 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 15:34:23,760 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 15:34:23,969 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 15:34:23,971 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 15:34:23,971 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 15:34:24,001 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 15:34:24,010 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:34:24,011 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 15:34:24,015 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 2 routes, of which 2 are started
2020-09-20 15:34:24,015 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.045 seconds
2020-09-20 15:34:24,021 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.377 seconds (JVM running for 3.2)
2020-09-20 15:34:24,031 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 15:34:24,034 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 2 routes (timeout 45 seconds)
2020-09-20 15:34:24,039 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: salesImportId shutdown complete, was consuming from: direct://salesImport
2020-09-20 15:34:24,041 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:34:24,041 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 2 routes completed in 0 seconds
2020-09-20 15:34:24,049 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.079 seconds
2020-09-20 15:34:24,049 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.018 seconds
2020-09-20 15:39:19,019 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 16682 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 15:39:19,024 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 15:39:20,230 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 15:39:20,640 [main] INFO  o.s.s.c.ThreadPoolTaskScheduler -  - Initializing ExecutorService 'taskScheduler'
2020-09-20 15:39:20,718 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 15:39:20,800 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 15:39:20,801 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 15:39:20,801 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 15:39:21,045 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 15:39:21,047 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 15:39:21,047 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 15:39:21,060 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 15:39:21,068 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:39:21,070 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 15:39:21,074 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 2 routes, of which 2 are started
2020-09-20 15:39:21,074 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.029 seconds
2020-09-20 15:39:21,081 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.713 seconds (JVM running for 3.586)
2020-09-20 15:39:21,092 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 15:39:21,094 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 2 routes (timeout 45 seconds)
2020-09-20 15:39:21,099 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: salesImportId shutdown complete, was consuming from: direct://salesImport
2020-09-20 15:39:21,101 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:39:21,101 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 2 routes completed in 0 seconds
2020-09-20 15:39:21,109 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.064 seconds
2020-09-20 15:39:21,109 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.017 seconds
2020-09-20 15:39:21,109 [SpringContextShutdownHook] INFO  o.s.s.c.ThreadPoolTaskScheduler -  - Shutting down ExecutorService 'taskScheduler'
2020-09-20 15:47:52,277 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 17655 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 15:47:52,282 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 15:47:53,416 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 15:47:53,875 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=quartz&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 15:47:53,956 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 15:47:53,956 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 15:47:53,957 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 15:47:54,102 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLoggingListener -  - 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2020-09-20 15:47:54,107 [main] ERROR o.s.boot.SpringApplication -  - Application run failed
org.apache.camel.FailedToCreateRouteException: Failed to create route filesystemReadingId: Route(filesystemReadingId)[From[file:///home/fabio/Documents... because of Failed to resolve endpoint: file:///home/fabio/Documents/sales-importer/in?delay=1000&move=%2Fhome%2Ffabio%2FDocuments%2Fsales-importer%2Fout&moveFailed=%2Fhome%2Ffabio%2FDocuments%2Fsales-importer%2Ferrors&recursive=true&scheduler=quartz&scheduler.cron=0%2F5+*+*+%3F+*+* due to: Cannot load org.apache.camel.pollconsumer.quartz.QuartzScheduledPollConsumerScheduler from classpath. Make sure camel-quartz.jar is on the classpath.
	at org.apache.camel.reifier.RouteReifier.createRoute(RouteReifier.java:118)
	at org.apache.camel.impl.DefaultCamelContext.startRouteDefinitions(DefaultCamelContext.java:426)
	at org.apache.camel.impl.DefaultCamelContext.startRouteDefinitions(DefaultCamelContext.java:388)
	at org.apache.camel.impl.engine.AbstractCamelContext.doInit(AbstractCamelContext.java:2680)
	at org.apache.camel.support.service.BaseService.init(BaseService.java:83)
	at org.apache.camel.impl.engine.AbstractCamelContext.init(AbstractCamelContext.java:2452)
	at org.apache.camel.support.service.BaseService.start(BaseService.java:111)
	at org.apache.camel.impl.engine.AbstractCamelContext.start(AbstractCamelContext.java:2469)
	at org.apache.camel.spring.SpringCamelContext.start(SpringCamelContext.java:130)
	at org.apache.camel.spring.SpringCamelContext.onApplicationEvent(SpringCamelContext.java:167)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:172)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:165)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:139)
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:404)
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:361)
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:898)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:554)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:758)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:750)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:397)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:315)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1237)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1226)
	at com.github.fabiosoaza.salesimporter.application.SalesImporterApplication.main(SalesImporterApplication.java:13)
Caused by: org.apache.camel.ResolveEndpointFailedException: Failed to resolve endpoint: file:///home/fabio/Documents/sales-importer/in?delay=1000&move=%2Fhome%2Ffabio%2FDocuments%2Fsales-importer%2Fout&moveFailed=%2Fhome%2Ffabio%2FDocuments%2Fsales-importer%2Ferrors&recursive=true&scheduler=quartz&scheduler.cron=0%2F5+*+*+%3F+*+* due to: Cannot load org.apache.camel.pollconsumer.quartz.QuartzScheduledPollConsumerScheduler from classpath. Make sure camel-quartz.jar is on the classpath.
	at org.apache.camel.impl.engine.AbstractCamelContext.doGetEndpoint(AbstractCamelContext.java:888)
	at org.apache.camel.impl.engine.AbstractCamelContext.getEndpoint(AbstractCamelContext.java:777)
	at org.apache.camel.support.CamelContextHelper.getMandatoryEndpoint(CamelContextHelper.java:58)
	at org.apache.camel.reifier.AbstractReifier.resolveEndpoint(AbstractReifier.java:177)
	at org.apache.camel.reifier.RouteReifier.doCreateRoute(RouteReifier.java:250)
	at org.apache.camel.reifier.RouteReifier.createRoute(RouteReifier.java:112)
	... 23 common frames omitted
Caused by: java.lang.IllegalArgumentException: Cannot load org.apache.camel.pollconsumer.quartz.QuartzScheduledPollConsumerScheduler from classpath. Make sure camel-quartz.jar is on the classpath.
	at org.apache.camel.support.ScheduledPollEndpoint.configureScheduledPollConsumerProperties(ScheduledPollEndpoint.java:150)
	at org.apache.camel.support.ScheduledPollEndpoint.configureProperties(ScheduledPollEndpoint.java:114)
	at org.apache.camel.support.DefaultComponent.setProperties(DefaultComponent.java:464)
	at org.apache.camel.component.file.GenericFileComponent.createEndpoint(GenericFileComponent.java:69)
	at org.apache.camel.component.file.GenericFileComponent.createEndpoint(GenericFileComponent.java:38)
	at org.apache.camel.support.DefaultComponent.createEndpoint(DefaultComponent.java:240)
	at org.apache.camel.impl.engine.AbstractCamelContext.doGetEndpoint(AbstractCamelContext.java:855)
	... 28 common frames omitted
Caused by: java.lang.ClassNotFoundException: org.apache.camel.pollconsumer.quartz.QuartzScheduledPollConsumerScheduler
	at org.apache.camel.impl.engine.DefaultClassResolver.resolveMandatoryClass(DefaultClassResolver.java:96)
	at org.apache.camel.support.ScheduledPollEndpoint.configureScheduledPollConsumerProperties(ScheduledPollEndpoint.java:147)
	... 34 common frames omitted
2020-09-20 15:51:53,258 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 18204 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 15:51:53,263 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 15:51:54,347 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 15:51:54,797 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 15:51:54,888 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 15:51:54,888 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 15:51:54,889 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 15:51:55,181 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 15:51:55,183 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 15:51:55,183 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 15:51:55,219 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 15:51:55,233 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:51:55,235 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 15:51:55,240 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 2 routes, of which 2 are started
2020-09-20 15:51:55,240 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.059 seconds
2020-09-20 15:51:55,247 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.673 seconds (JVM running for 3.56)
2020-09-20 15:51:55,258 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 15:51:55,261 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 2 routes (timeout 45 seconds)
2020-09-20 15:51:55,266 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: salesImportId shutdown complete, was consuming from: direct://salesImport
2020-09-20 15:51:55,267 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:51:55,267 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 2 routes completed in 0 seconds
2020-09-20 15:51:55,277 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.096 seconds
2020-09-20 15:51:55,277 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.019 seconds
2020-09-20 15:53:37,345 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 18478 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 15:53:37,350 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 15:53:38,605 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 15:53:39,036 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 15:53:39,102 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 15:53:39,102 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 15:53:39,102 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 15:53:39,286 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 15:53:39,288 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 15:53:39,288 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 15:53:39,302 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 15:53:39,322 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:53:39,326 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 15:53:39,329 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 2 routes, of which 2 are started
2020-09-20 15:53:39,329 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.043 seconds
2020-09-20 15:53:39,335 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.582 seconds (JVM running for 3.467)
2020-09-20 15:53:39,344 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 15:53:39,347 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 2 routes (timeout 45 seconds)
2020-09-20 15:53:39,351 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: salesImportId shutdown complete, was consuming from: direct://salesImport
2020-09-20 15:53:39,352 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:53:39,353 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 2 routes completed in 0 seconds
2020-09-20 15:53:39,362 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.076 seconds
2020-09-20 15:53:39,363 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.019 seconds
2020-09-20 15:55:21,688 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 18615 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 15:55:21,706 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 15:55:22,841 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 15:55:23,276 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 15:55:23,357 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 15:55:23,358 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 15:55:23,358 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 15:55:23,625 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 15:55:23,627 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 15:55:23,627 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 15:55:23,654 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 15:55:23,665 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:55:23,667 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 15:55:23,690 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 2 routes, of which 2 are started
2020-09-20 15:55:23,691 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.066 seconds
2020-09-20 15:55:23,697 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.654 seconds (JVM running for 3.438)
2020-09-20 15:55:23,707 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 15:55:23,710 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 2 routes (timeout 45 seconds)
2020-09-20 15:55:23,716 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: salesImportId shutdown complete, was consuming from: direct://salesImport
2020-09-20 15:55:23,717 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:55:23,718 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 2 routes completed in 0 seconds
2020-09-20 15:55:23,727 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.102 seconds
2020-09-20 15:55:23,727 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.020 seconds
2020-09-20 15:56:37,167 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 18841 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 15:56:37,173 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 15:56:38,311 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 15:56:38,695 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 15:56:38,766 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 15:56:38,766 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 15:56:38,767 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 15:56:38,998 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 15:56:39,001 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 15:56:39,002 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 15:56:39,020 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 15:56:39,044 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:56:39,046 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 15:56:39,049 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 2 routes, of which 2 are started
2020-09-20 15:56:39,049 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.050 seconds
2020-09-20 15:56:39,056 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.517 seconds (JVM running for 3.342)
2020-09-20 15:56:39,066 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 15:56:39,070 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 2 routes (timeout 45 seconds)
2020-09-20 15:56:39,075 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: salesImportId shutdown complete, was consuming from: direct://salesImport
2020-09-20 15:56:39,076 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:56:39,076 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 2 routes completed in 0 seconds
2020-09-20 15:56:39,086 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.087 seconds
2020-09-20 15:56:39,086 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.020 seconds
2020-09-20 15:57:28,327 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 18915 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 15:57:28,334 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 15:57:29,451 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 15:57:29,917 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 15:57:30,001 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 15:57:30,002 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 15:57:30,002 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 15:57:30,291 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 15:57:30,294 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 15:57:30,294 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 15:57:30,311 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 15:57:30,331 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:57:30,336 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 15:57:30,340 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 2 routes, of which 2 are started
2020-09-20 15:57:30,341 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.049 seconds
2020-09-20 15:57:30,348 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.792 seconds (JVM running for 3.574)
2020-09-20 15:57:30,357 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 15:57:30,359 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 2 routes (timeout 45 seconds)
2020-09-20 15:57:30,365 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: salesImportId shutdown complete, was consuming from: direct://salesImport
2020-09-20 15:57:30,367 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:57:30,367 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 2 routes completed in 0 seconds
2020-09-20 15:57:30,378 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.087 seconds
2020-09-20 15:57:30,379 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.022 seconds
2020-09-20 15:57:47,373 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 18982 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 15:57:47,379 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 15:57:48,694 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 15:57:49,156 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 15:57:49,233 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 15:57:49,233 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 15:57:49,233 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 15:57:49,459 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 15:57:49,462 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 15:57:49,462 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 15:57:49,481 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 15:57:49,491 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:57:49,493 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 15:57:49,512 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 2 routes, of which 2 are started
2020-09-20 15:57:49,513 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.052 seconds
2020-09-20 15:57:49,518 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.775 seconds (JVM running for 3.558)
2020-09-20 15:57:49,529 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 15:57:49,532 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 2 routes (timeout 45 seconds)
2020-09-20 15:57:49,537 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: salesImportId shutdown complete, was consuming from: direct://salesImport
2020-09-20 15:57:49,538 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:57:49,539 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 2 routes completed in 0 seconds
2020-09-20 15:57:49,547 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.087 seconds
2020-09-20 15:57:49,547 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.018 seconds
2020-09-20 15:58:26,822 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 19076 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 15:58:26,827 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 15:58:27,985 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 15:58:28,421 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 15:58:28,507 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 15:58:28,508 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 15:58:28,508 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 15:58:28,770 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 15:58:28,772 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 15:58:28,772 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 15:58:28,790 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 15:58:28,800 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:58:28,801 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 15:58:28,818 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 2 routes, of which 2 are started
2020-09-20 15:58:28,818 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.048 seconds
2020-09-20 15:58:28,823 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.631 seconds (JVM running for 3.558)
2020-09-20 15:58:28,833 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 15:58:28,837 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 2 routes (timeout 45 seconds)
2020-09-20 15:58:28,842 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: salesImportId shutdown complete, was consuming from: direct://salesImport
2020-09-20 15:58:28,843 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 15:58:28,844 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 2 routes completed in 0 seconds
2020-09-20 15:58:28,853 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.083 seconds
2020-09-20 15:58:28,853 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.020 seconds
2020-09-20 16:15:44,407 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 20278 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 16:15:44,419 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 16:15:46,357 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 16:15:46,996 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 16:15:47,105 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 16:15:47,106 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 16:15:47,106 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 16:15:47,530 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 16:15:47,537 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 16:15:47,539 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 16:15:47,563 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 16:15:47,583 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 16:15:47,586 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 16:15:47,613 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 2 routes, of which 2 are started
2020-09-20 16:15:47,614 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.079 seconds
2020-09-20 16:15:47,619 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.261 seconds (JVM running for 5.886)
2020-09-20 16:15:47,654 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 16:15:47,658 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 2 routes (timeout 45 seconds)
2020-09-20 16:15:47,686 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: salesImportId shutdown complete, was consuming from: direct://salesImport
2020-09-20 16:15:47,687 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 16:15:47,688 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 2 routes completed in 0 seconds
2020-09-20 16:15:47,700 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.165 seconds
2020-09-20 16:15:47,700 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.046 seconds
2020-09-20 16:17:13,589 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 20505 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 16:17:13,598 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 16:17:14,958 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 16:17:15,420 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 16:17:15,505 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 16:17:15,505 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 16:17:15,505 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 16:17:15,734 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 16:17:15,736 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 16:17:15,736 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 16:17:15,754 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 16:17:15,776 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 16:17:15,781 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 16:17:15,785 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 2 routes, of which 2 are started
2020-09-20 16:17:15,786 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.052 seconds
2020-09-20 16:17:15,793 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.894 seconds (JVM running for 3.72)
2020-09-20 16:17:15,805 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 16:17:15,807 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 2 routes (timeout 45 seconds)
2020-09-20 16:17:15,813 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: salesImportId shutdown complete, was consuming from: direct://salesImport
2020-09-20 16:17:15,814 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 16:17:15,814 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 2 routes completed in 0 seconds
2020-09-20 16:17:15,823 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.089 seconds
2020-09-20 16:17:15,823 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.018 seconds
2020-09-20 16:17:34,609 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 20556 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 16:17:34,614 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 16:17:35,725 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 16:17:36,179 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 16:17:36,263 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 16:17:36,264 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 16:17:36,264 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 16:17:36,503 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 16:17:36,505 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 16:17:36,505 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 16:17:36,522 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 16:17:36,547 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 16:17:36,549 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 16:17:36,553 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 2 routes, of which 2 are started
2020-09-20 16:17:36,553 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.050 seconds
2020-09-20 16:17:36,560 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.573 seconds (JVM running for 3.397)
2020-09-20 16:17:36,571 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 16:17:36,573 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 2 routes (timeout 45 seconds)
2020-09-20 16:17:36,578 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: salesImportId shutdown complete, was consuming from: direct://salesImport
2020-09-20 16:17:36,578 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 16:17:36,579 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 2 routes completed in 0 seconds
2020-09-20 16:17:36,588 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.085 seconds
2020-09-20 16:17:36,588 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.017 seconds
2020-09-20 16:20:54,874 [main] ERROR o.s.boot.SpringApplication -  - Application run failed
java.lang.IllegalStateException: Failed to load property source from 'file:/opt/projects/source/sales-importer/bin/main/application.yml' (classpath:/application.yml)
	at org.springframework.boot.context.config.ConfigFileApplicationListener$Loader.load(ConfigFileApplicationListener.java:553)
	at org.springframework.boot.context.config.ConfigFileApplicationListener$Loader.loadForFileExtension(ConfigFileApplicationListener.java:498)
	at org.springframework.boot.context.config.ConfigFileApplicationListener$Loader.load(ConfigFileApplicationListener.java:468)
	at org.springframework.boot.context.config.ConfigFileApplicationListener$Loader.lambda$null$7(ConfigFileApplicationListener.java:447)
	at java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.context.config.ConfigFileApplicationListener$Loader.lambda$load$8(ConfigFileApplicationListener.java:447)
	at java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.context.config.ConfigFileApplicationListener$Loader.load(ConfigFileApplicationListener.java:444)
	at org.springframework.boot.context.config.ConfigFileApplicationListener$Loader.lambda$load$0(ConfigFileApplicationListener.java:347)
	at org.springframework.boot.context.config.FilteredPropertySource.apply(FilteredPropertySource.java:54)
	at org.springframework.boot.context.config.ConfigFileApplicationListener$Loader.load(ConfigFileApplicationListener.java:335)
	at org.springframework.boot.context.config.ConfigFileApplicationListener.addPropertySources(ConfigFileApplicationListener.java:226)
	at org.springframework.boot.context.config.ConfigFileApplicationListener.postProcessEnvironment(ConfigFileApplicationListener.java:210)
	at org.springframework.boot.context.config.ConfigFileApplicationListener.onApplicationEnvironmentPreparedEvent(ConfigFileApplicationListener.java:200)
	at org.springframework.boot.context.config.ConfigFileApplicationListener.onApplicationEvent(ConfigFileApplicationListener.java:188)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:172)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:165)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:139)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:127)
	at org.springframework.boot.context.event.EventPublishingRunListener.environmentPrepared(EventPublishingRunListener.java:80)
	at org.springframework.boot.SpringApplicationRunListeners.environmentPrepared(SpringApplicationRunListeners.java:53)
	at org.springframework.boot.SpringApplication.prepareEnvironment(SpringApplication.java:345)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:308)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1237)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1226)
	at com.github.fabiosoaza.salesimporter.application.SalesImporterApplication.main(SalesImporterApplication.java:13)
Caused by: org.yaml.snakeyaml.scanner.ScannerException: mapping values are not allowed here
 in 'reader', line 5, column 15:
    filesProcessor:
                  ^

	at org.yaml.snakeyaml.scanner.ScannerImpl.fetchValue(ScannerImpl.java:870)
	at org.yaml.snakeyaml.scanner.ScannerImpl.fetchMoreTokens(ScannerImpl.java:358)
	at org.yaml.snakeyaml.scanner.ScannerImpl.peekToken(ScannerImpl.java:250)
	at org.yaml.snakeyaml.parser.ParserImpl$ParseDocumentEnd.produce(ParserImpl.java:253)
	at org.yaml.snakeyaml.parser.ParserImpl.peekEvent(ParserImpl.java:158)
	at org.yaml.snakeyaml.parser.ParserImpl.getEvent(ParserImpl.java:168)
	at org.yaml.snakeyaml.composer.Composer.getNode(Composer.java:97)
	at org.yaml.snakeyaml.constructor.BaseConstructor.getData(BaseConstructor.java:134)
	at org.yaml.snakeyaml.Yaml$1.next(Yaml.java:494)
	at org.springframework.beans.factory.config.YamlProcessor.process(YamlProcessor.java:200)
	at org.springframework.beans.factory.config.YamlProcessor.process(YamlProcessor.java:164)
	at org.springframework.boot.env.OriginTrackedYamlLoader.load(OriginTrackedYamlLoader.java:82)
	at org.springframework.boot.env.YamlPropertySourceLoader.load(YamlPropertySourceLoader.java:50)
	at org.springframework.boot.context.config.ConfigFileApplicationListener$Loader.loadDocuments(ConfigFileApplicationListener.java:607)
	at org.springframework.boot.context.config.ConfigFileApplicationListener$Loader.load(ConfigFileApplicationListener.java:523)
	... 25 common frames omitted
2020-09-20 16:21:39,407 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 20982 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 16:21:39,412 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 16:21:40,603 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 16:21:41,022 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 16:21:41,079 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 16:21:41,079 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 16:21:41,080 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 16:21:41,284 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 16:21:41,286 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 16:21:41,287 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 16:21:41,302 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 16:21:41,318 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 16:21:41,323 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 16:21:41,327 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 2 routes, of which 2 are started
2020-09-20 16:21:41,328 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.043 seconds
2020-09-20 16:21:41,334 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.579 seconds (JVM running for 3.351)
2020-09-20 16:21:41,344 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-20 16:21:41,346 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 2 routes (timeout 45 seconds)
2020-09-20 16:21:41,351 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: salesImportId shutdown complete, was consuming from: direct://salesImport
2020-09-20 16:21:41,351 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 16:21:41,352 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 2 routes completed in 0 seconds
2020-09-20 16:21:41,361 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 0.076 seconds
2020-09-20 16:21:41,361 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.017 seconds
2020-09-20 16:25:25,518 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 21176 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 16:25:25,522 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 16:25:27,058 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 16:25:27,077 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 16:25:27,078 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 16:25:27,078 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 16:25:27,193 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 16:25:27,193 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1621 ms
2020-09-20 16:25:27,481 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 16:25:27,734 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 16:25:28,101 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 16:25:28,130 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 16:25:28,135 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 16:25:28,193 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 16:25:28,193 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 16:25:28,194 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 16:25:28,452 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 16:25:28,454 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 16:25:28,455 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 16:25:28,471 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 16:25:28,479 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 16:25:28,481 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 16:25:28,485 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 2 routes, of which 2 are started
2020-09-20 16:25:28,485 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.033 seconds
2020-09-20 16:25:28,491 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 3.625 seconds (JVM running for 4.471)
2020-09-20 16:25:30,006 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG o.a.c.c.file.GenericFileConsumer -  - Took 0.005 seconds to poll: /home/fabio/Documents/sales-importer/in
2020-09-20 16:25:30,022 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG o.a.c.c.file.GenericFileConsumer -  - Total 1 files to consume
2020-09-20 16:25:30,027 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG o.a.c.c.file.GenericFileConsumer -  - About to process file: GenericFile[/home/fabio/Documents/sales-importer/in/sales.csv] using exchange: Exchange[]
2020-09-20 16:25:30,042 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 16:25:30,044 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 16:25:30,048 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG o.a.c.c.f.GenericFileOnCompletion -  - Done processing file: GenericFile[/home/fabio/Documents/sales-importer/in/sales.csv] using exchange: Exchange[]
2020-09-20 16:25:30,051 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG o.a.c.c.f.s.GenericFileProcessStrategySupport -  - Renaming file: GenericFile[/home/fabio/Documents/sales-importer/in/sales.csv] to: GenericFile[/home/fabio/Documents/sales-importer/out/sales.csv]
2020-09-20 16:25:35,000 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG o.a.c.c.file.GenericFileConsumer -  - Took 0.000 seconds to poll: /home/fabio/Documents/sales-importer/in
2020-09-20 16:25:40,001 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG o.a.c.c.file.GenericFileConsumer -  - Took 0.000 seconds to poll: /home/fabio/Documents/sales-importer/in
2020-09-20 16:25:45,001 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG o.a.c.c.file.GenericFileConsumer -  - Took 0.000 seconds to poll: /home/fabio/Documents/sales-importer/in
2020-09-20 16:25:50,001 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG o.a.c.c.file.GenericFileConsumer -  - Took 0.000 seconds to poll: /home/fabio/Documents/sales-importer/in
2020-09-20 16:25:55,001 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG o.a.c.c.file.GenericFileConsumer -  - Took 0.000 seconds to poll: /home/fabio/Documents/sales-importer/in
2020-09-20 16:26:00,001 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG o.a.c.c.file.GenericFileConsumer -  - Took 0.000 seconds to poll: /home/fabio/Documents/sales-importer/in
2020-09-20 16:26:05,000 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG o.a.c.c.file.GenericFileConsumer -  - Took 0.000 seconds to poll: /home/fabio/Documents/sales-importer/in
2020-09-20 16:26:10,001 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG o.a.c.c.file.GenericFileConsumer -  - Took 0.000 seconds to poll: /home/fabio/Documents/sales-importer/in
2020-09-20 16:26:15,001 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG o.a.c.c.file.GenericFileConsumer -  - Took 0.000 seconds to poll: /home/fabio/Documents/sales-importer/in
2020-09-20 16:26:32,513 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 21395 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 16:26:32,520 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 16:26:34,090 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 16:26:34,110 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 16:26:34,111 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 16:26:34,112 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 16:26:34,216 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 16:26:34,216 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1620 ms
2020-09-20 16:26:34,490 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 16:26:34,784 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 16:26:35,285 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 16:26:35,321 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 16:26:35,330 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 16:26:35,397 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 16:26:35,398 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 16:26:35,398 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 16:26:35,599 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 16:26:35,602 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 16:26:35,602 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 16:26:35,617 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 16:26:35,625 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 16:26:35,626 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 16:26:35,629 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 2 routes, of which 2 are started
2020-09-20 16:26:35,630 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.030 seconds
2020-09-20 16:26:35,635 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 3.863 seconds (JVM running for 4.671)
2020-09-20 16:27:00,042 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 16:27:00,044 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 17:20:27,807 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 25967 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 17:20:27,825 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 17:20:29,814 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 17:20:29,831 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 17:20:29,831 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 17:20:29,832 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 17:20:29,942 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 17:20:29,942 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 2010 ms
2020-09-20 17:20:30,278 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 17:20:30,635 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 17:20:31,064 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 17:20:31,105 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 17:20:31,114 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 17:20:31,202 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 17:20:31,203 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 17:20:31,203 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 17:20:31,464 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 17:20:31,467 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 17:20:31,467 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 17:20:31,489 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 17:20:31,497 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 17:20:31,499 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 17:20:31,499 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-20 17:20:31,502 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 3 routes, of which 3 are started
2020-09-20 17:20:31,503 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.037 seconds
2020-09-20 17:20:31,509 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.504 seconds (JVM running for 5.423)
2020-09-20 17:20:35,038 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 17:20:35,039 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 17:20:35,061 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 17:20:35,063 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-20 17:20:35,064 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 17:20:35,064 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-20 17:20:35,065 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 17:20:35,065 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro 0022345675434544345Jose da SilvaRural
2020-09-20 17:20:35,065 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 17:20:35,065 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro 0022345675433444345Eduardo PereiraRural
2020-09-20 17:20:35,065 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 17:20:35,065 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-20 17:20:35,066 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 17:20:35,066 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-20 17:22:51,761 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 26152 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 17:22:51,768 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 17:22:53,438 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 17:22:53,455 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 17:22:53,455 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 17:22:53,456 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 17:22:53,576 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 17:22:53,576 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1718 ms
2020-09-20 17:22:53,863 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 17:22:54,151 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 17:22:54,595 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 17:22:54,627 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 17:22:54,633 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 17:22:54,705 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 17:22:54,705 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 17:22:54,705 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 17:22:54,950 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 17:22:54,952 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 17:22:54,952 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 17:22:54,972 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 17:22:54,979 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 17:22:54,980 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 17:22:54,981 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-20 17:22:54,983 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 3 routes, of which 3 are started
2020-09-20 17:22:54,984 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.034 seconds
2020-09-20 17:22:54,989 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 3.808 seconds (JVM running for 4.598)
2020-09-20 17:23:10,036 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 17:23:10,038 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 17:23:10,062 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 17:23:10,063 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-20 17:23:10,065 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 17:23:10,065 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-20 17:23:10,065 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 17:23:10,065 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-20 17:23:10,065 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 17:23:10,065 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-20 17:23:10,066 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 17:23:10,066 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-20 17:23:10,066 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 17:23:10,066 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-20 17:51:24,047 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 27983 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 17:51:24,050 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 17:51:24,973 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 17:51:24,986 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 17:51:24,986 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 17:51:24,986 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 17:51:25,068 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 17:51:25,068 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 974 ms
2020-09-20 17:51:25,294 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 17:51:25,489 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 17:51:25,786 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 17:51:25,808 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 17:51:25,812 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 17:51:25,866 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 17:51:25,866 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 17:51:25,867 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 17:51:26,075 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Pausing ProtocolHandler ["http-nio-8080"]
2020-09-20 17:51:26,086 [main] INFO  o.a.catalina.core.StandardService -  - Stopping service [Tomcat]
2020-09-20 17:51:26,090 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Stopping ProtocolHandler ["http-nio-8080"]
2020-09-20 17:51:26,133 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Destroying ProtocolHandler ["http-nio-8080"]
2020-09-20 17:51:26,135 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLoggingListener -  - 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2020-09-20 17:51:26,139 [main] ERROR o.s.boot.SpringApplication -  - Application run failed
org.apache.camel.FailedToCreateRouteException: Failed to create route unmarshalSellerId at: >>> DoTry[[Unmarshal[org.apache.camel.model.dataformat.BindyDataFormat@4d18b73a], DoCatch[ [class java.lang.Exception] -> [Log[ Erro ao fazer parse da linha. Exception: ${exception} ${headers.CamelFileName}]]]]] <<< in route: Route(unmarshalSellerId)[From[direct:unmarshalSeller] -> [Do... because of Data format 'bindy-csv' could not be created. Ensure that the data format is valid and the associated Camel component is present on the classpath
	at org.apache.camel.reifier.RouteReifier.doCreateRoute(RouteReifier.java:385)
	at org.apache.camel.reifier.RouteReifier.createRoute(RouteReifier.java:112)
	at org.apache.camel.impl.DefaultCamelContext.startRouteDefinitions(DefaultCamelContext.java:426)
	at org.apache.camel.impl.DefaultCamelContext.startRouteDefinitions(DefaultCamelContext.java:388)
	at org.apache.camel.impl.engine.AbstractCamelContext.doInit(AbstractCamelContext.java:2680)
	at org.apache.camel.support.service.BaseService.init(BaseService.java:83)
	at org.apache.camel.impl.engine.AbstractCamelContext.init(AbstractCamelContext.java:2452)
	at org.apache.camel.support.service.BaseService.start(BaseService.java:111)
	at org.apache.camel.impl.engine.AbstractCamelContext.start(AbstractCamelContext.java:2469)
	at org.apache.camel.spring.SpringCamelContext.start(SpringCamelContext.java:130)
	at org.apache.camel.spring.SpringCamelContext.onApplicationEvent(SpringCamelContext.java:167)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:172)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:165)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:139)
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:404)
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:361)
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:898)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:554)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:143)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:758)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:750)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:397)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:315)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1237)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1226)
	at com.github.fabiosoaza.salesimporter.application.SalesImporterApplication.main(SalesImporterApplication.java:12)
Caused by: java.lang.IllegalArgumentException: Data format 'bindy-csv' could not be created. Ensure that the data format is valid and the associated Camel component is present on the classpath
	at org.apache.camel.reifier.dataformat.DataFormatReifier.createDataFormat(DataFormatReifier.java:221)
	at org.apache.camel.reifier.dataformat.DataFormatReifier.getDataFormat(DataFormatReifier.java:194)
	at org.apache.camel.reifier.dataformat.DataFormatReifier.getDataFormat(DataFormatReifier.java:154)
	at org.apache.camel.reifier.UnmarshalReifier.createProcessor(UnmarshalReifier.java:35)
	at org.apache.camel.reifier.ProcessorReifier.createProcessor(ProcessorReifier.java:731)
	at org.apache.camel.reifier.ProcessorReifier.createOutputsProcessor(ProcessorReifier.java:689)
	at org.apache.camel.reifier.TryReifier.createProcessor(TryReifier.java:38)
	at org.apache.camel.reifier.ProcessorReifier.makeProcessor(ProcessorReifier.java:752)
	at org.apache.camel.reifier.ProcessorReifier.addRoutes(ProcessorReifier.java:495)
	at org.apache.camel.reifier.RouteReifier.doCreateRoute(RouteReifier.java:383)
	... 25 common frames omitted
2020-09-20 17:51:26,146 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Shutting down ExecutorService 'applicationTaskExecutor'
2020-09-20 17:51:27,604 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 28035 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 17:51:27,611 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 17:51:29,701 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 17:51:29,721 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 17:51:29,722 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 17:51:29,722 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 17:51:29,835 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 17:51:29,835 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 2098 ms
2020-09-20 17:51:30,201 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 17:51:30,535 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 17:51:30,982 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 17:51:31,020 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 17:51:31,028 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 17:51:31,144 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 17:51:31,144 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 17:51:31,145 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 17:51:31,429 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Pausing ProtocolHandler ["http-nio-8080"]
2020-09-20 17:51:31,439 [main] INFO  o.a.catalina.core.StandardService -  - Stopping service [Tomcat]
2020-09-20 17:51:31,444 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Stopping ProtocolHandler ["http-nio-8080"]
2020-09-20 17:51:31,489 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Destroying ProtocolHandler ["http-nio-8080"]
2020-09-20 17:51:31,492 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLoggingListener -  - 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2020-09-20 17:51:31,498 [main] ERROR o.s.boot.SpringApplication -  - Application run failed
org.apache.camel.FailedToCreateRouteException: Failed to create route unmarshalSellerId at: >>> DoTry[[Unmarshal[org.apache.camel.model.dataformat.BindyDataFormat@1c5d3a37], DoCatch[ [class java.lang.Exception] -> [Log[ Erro ao fazer parse da linha. Exception: ${exception} ${headers.CamelFileName}]]]]] <<< in route: Route(unmarshalSellerId)[From[direct:unmarshalSeller] -> [Do... because of Data format 'bindy-csv' could not be created. Ensure that the data format is valid and the associated Camel component is present on the classpath
	at org.apache.camel.reifier.RouteReifier.doCreateRoute(RouteReifier.java:385)
	at org.apache.camel.reifier.RouteReifier.createRoute(RouteReifier.java:112)
	at org.apache.camel.impl.DefaultCamelContext.startRouteDefinitions(DefaultCamelContext.java:426)
	at org.apache.camel.impl.DefaultCamelContext.startRouteDefinitions(DefaultCamelContext.java:388)
	at org.apache.camel.impl.engine.AbstractCamelContext.doInit(AbstractCamelContext.java:2680)
	at org.apache.camel.support.service.BaseService.init(BaseService.java:83)
	at org.apache.camel.impl.engine.AbstractCamelContext.init(AbstractCamelContext.java:2452)
	at org.apache.camel.support.service.BaseService.start(BaseService.java:111)
	at org.apache.camel.impl.engine.AbstractCamelContext.start(AbstractCamelContext.java:2469)
	at org.apache.camel.spring.SpringCamelContext.start(SpringCamelContext.java:130)
	at org.apache.camel.spring.SpringCamelContext.onApplicationEvent(SpringCamelContext.java:167)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:172)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:165)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:139)
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:404)
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:361)
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:898)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:554)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:143)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:758)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:750)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:397)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:315)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1237)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1226)
	at com.github.fabiosoaza.salesimporter.application.SalesImporterApplication.main(SalesImporterApplication.java:12)
Caused by: java.lang.IllegalArgumentException: Data format 'bindy-csv' could not be created. Ensure that the data format is valid and the associated Camel component is present on the classpath
	at org.apache.camel.reifier.dataformat.DataFormatReifier.createDataFormat(DataFormatReifier.java:221)
	at org.apache.camel.reifier.dataformat.DataFormatReifier.getDataFormat(DataFormatReifier.java:194)
	at org.apache.camel.reifier.dataformat.DataFormatReifier.getDataFormat(DataFormatReifier.java:154)
	at org.apache.camel.reifier.UnmarshalReifier.createProcessor(UnmarshalReifier.java:35)
	at org.apache.camel.reifier.ProcessorReifier.createProcessor(ProcessorReifier.java:731)
	at org.apache.camel.reifier.ProcessorReifier.createOutputsProcessor(ProcessorReifier.java:689)
	at org.apache.camel.reifier.TryReifier.createProcessor(TryReifier.java:38)
	at org.apache.camel.reifier.ProcessorReifier.makeProcessor(ProcessorReifier.java:752)
	at org.apache.camel.reifier.ProcessorReifier.addRoutes(ProcessorReifier.java:495)
	at org.apache.camel.reifier.RouteReifier.doCreateRoute(RouteReifier.java:383)
	... 25 common frames omitted
2020-09-20 17:51:31,507 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Shutting down ExecutorService 'applicationTaskExecutor'
2020-09-20 17:58:56,760 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 28901 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 17:58:56,767 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 17:58:58,842 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 17:58:58,856 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 17:58:58,857 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 17:58:58,857 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 17:58:58,962 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 17:58:58,963 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 2098 ms
2020-09-20 17:58:59,212 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 17:58:59,487 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 17:58:59,893 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 17:58:59,937 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 17:58:59,943 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 17:59:00,043 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 17:59:00,044 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 17:59:00,044 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 17:59:00,355 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 17:59:00,360 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 17:59:00,360 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 17:59:00,381 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 17:59:00,388 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 17:59:00,390 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 17:59:00,390 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-20 17:59:00,391 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-20 17:59:00,391 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-20 17:59:00,391 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-20 17:59:00,395 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 6 routes, of which 6 are started
2020-09-20 17:59:00,396 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.040 seconds
2020-09-20 17:59:00,403 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.57 seconds (JVM running for 5.41)
2020-09-20 17:59:05,037 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 17:59:05,038 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 17:59:05,057 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 17:59:05,077 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: The separator has not been defined in the annotation @CsvRecord or not instantiated during initModel. must be specified sales.csv
2020-09-20 17:59:05,078 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 17:59:05,079 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: The separator has not been defined in the annotation @CsvRecord or not instantiated during initModel. must be specified sales.csv
2020-09-20 17:59:05,079 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 17:59:05,080 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: The separator has not been defined in the annotation @CsvRecord or not instantiated during initModel. must be specified sales.csv
2020-09-20 17:59:05,080 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 17:59:05,081 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: The separator has not been defined in the annotation @CsvRecord or not instantiated during initModel. must be specified sales.csv
2020-09-20 17:59:05,081 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 17:59:05,081 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: The separator has not been defined in the annotation @CsvRecord or not instantiated during initModel. must be specified sales.csv
2020-09-20 17:59:05,082 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 17:59:05,082 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: The separator has not been defined in the annotation @CsvRecord or not instantiated during initModel. must be specified sales.csv
2020-09-20 18:00:19,402 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 29049 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 18:00:19,408 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 18:00:21,944 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 18:00:21,969 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 18:00:21,970 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 18:00:21,970 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 18:00:22,201 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 18:00:22,201 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 2705 ms
2020-09-20 18:00:23,025 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 18:00:23,400 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 18:00:24,053 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 18:00:24,061 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext -  - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'; nested exception is org.springframework.boot.web.server.PortInUseException: Port 8080 is already in use
2020-09-20 18:00:24,063 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Shutting down ExecutorService 'applicationTaskExecutor'
2020-09-20 18:00:24,066 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Pausing ProtocolHandler ["http-nio-8080"]
2020-09-20 18:00:24,067 [main] INFO  o.a.catalina.core.StandardService -  - Stopping service [Tomcat]
2020-09-20 18:00:24,072 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Stopping ProtocolHandler ["http-nio-8080"]
2020-09-20 18:00:24,073 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Destroying ProtocolHandler ["http-nio-8080"]
2020-09-20 18:00:24,083 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLoggingListener -  - 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2020-09-20 18:00:24,088 [main] ERROR o.s.b.d.LoggingFailureAnalysisReporter -  - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Web server failed to start. Port 8080 was already in use.

Action:

Identify and stop the process that's listening on port 8080 or configure this application to listen on another port.

2020-09-20 18:00:43,288 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 29122 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 18:00:43,318 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 18:00:46,649 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 18:00:46,671 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 18:00:46,672 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 18:00:46,672 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 18:00:46,879 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 18:00:46,894 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 3350 ms
2020-09-20 18:00:47,493 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 18:00:48,072 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 18:00:48,946 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 18:00:49,132 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 18:00:49,148 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 18:00:49,307 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 18:00:49,308 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 18:00:49,308 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 18:00:49,950 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 18:00:49,953 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 18:00:49,953 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 18:00:49,983 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 18:00:50,005 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 18:00:50,006 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 18:00:50,006 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-20 18:00:50,007 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-20 18:00:50,007 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-20 18:00:50,007 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-20 18:00:50,019 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 6 routes, of which 6 are started
2020-09-20 18:00:50,020 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.069 seconds
2020-09-20 18:00:50,031 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 8.181 seconds (JVM running for 10.03)
2020-09-20 18:01:00,025 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 18:01:00,026 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 18:01:00,045 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 18:01:00,089 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: No position 1 defined for the field: 001, line: 1 must be specified sales.csv
2020-09-20 18:01:00,091 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 18:01:00,093 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: No position 1 defined for the field: 001, line: 1 must be specified sales.csv
2020-09-20 18:01:00,094 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 18:01:00,095 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: No position 1 defined for the field: 002, line: 1 must be specified sales.csv
2020-09-20 18:01:00,096 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 18:01:00,097 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: No position 1 defined for the field: 002, line: 1 must be specified sales.csv
2020-09-20 18:01:00,098 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 18:01:00,099 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: No position 1 defined for the field: 003, line: 1 must be specified sales.csv
2020-09-20 18:01:00,099 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 18:01:00,100 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: No position 1 defined for the field: 003, line: 1 must be specified sales.csv
2020-09-20 18:12:08,519 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 30172 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 18:12:08,525 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 18:12:10,345 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 18:12:10,360 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 18:12:10,361 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 18:12:10,361 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 18:12:10,459 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 18:12:10,459 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1848 ms
2020-09-20 18:12:10,784 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 18:12:11,132 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 18:12:11,502 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 18:12:11,541 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 18:12:11,550 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 18:12:11,675 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 18:12:11,675 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 18:12:11,675 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 18:12:11,992 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 18:12:11,994 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 18:12:11,994 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 18:12:12,019 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 18:12:12,029 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 18:12:12,032 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 18:12:12,032 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-20 18:12:12,032 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-20 18:12:12,033 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-20 18:12:12,033 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-20 18:12:12,039 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 6 routes, of which 6 are started
2020-09-20 18:12:12,039 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.047 seconds
2020-09-20 18:12:12,047 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.34 seconds (JVM running for 5.24)
2020-09-20 18:12:15,026 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 18:12:15,027 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 18:12:15,046 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 18:12:15,074 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] WARN  o.a.c.d.bindy.BindyCsvFactory -  - Potentially invalid model: existing @DataField 'cpf' replaced by 'salary'
2020-09-20 18:12:15,082 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: No position 4 defined for the field: 50000, line: 1 must be specified sales.csv
2020-09-20 18:12:15,084 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 18:12:15,084 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: No position 4 defined for the field: 40000.99, line: 1 must be specified sales.csv
2020-09-20 18:12:15,085 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 18:12:15,085 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: No position 4 defined for the field: Rural, line: 1 must be specified sales.csv
2020-09-20 18:12:15,086 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 18:12:15,086 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: No position 4 defined for the field: Rural, line: 1 must be specified sales.csv
2020-09-20 18:12:15,087 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 18:12:15,087 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: No position 4 defined for the field: Pedro, line: 1 must be specified sales.csv
2020-09-20 18:12:15,088 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 18:12:15,089 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: No position 4 defined for the field: Paulo, line: 1 must be specified sales.csv
2020-09-20 18:14:40,644 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 30464 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 18:14:40,656 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 18:14:42,643 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 18:14:42,661 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 18:14:42,662 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 18:14:42,663 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 18:14:42,775 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 18:14:42,775 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 2011 ms
2020-09-20 18:14:43,064 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 18:14:43,459 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 18:14:43,905 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 18:14:43,947 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 18:14:43,956 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 18:14:44,068 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 18:14:44,068 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 18:14:44,069 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 18:14:44,396 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 18:14:44,399 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 18:14:44,399 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 18:14:44,427 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 18:14:44,435 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 18:14:44,437 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 18:14:44,437 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-20 18:14:44,438 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-20 18:14:44,438 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-20 18:14:44,438 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-20 18:14:44,442 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 6 routes, of which 6 are started
2020-09-20 18:14:44,442 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.045 seconds
2020-09-20 18:14:44,450 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.605 seconds (JVM running for 5.46)
2020-09-20 18:14:45,015 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 18:14:45,016 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 18:14:45,033 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 18:14:45,059 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] WARN  o.a.c.d.bindy.BindyCsvFactory -  - Potentially invalid model: existing @DataField 'cpf' replaced by 'salary'
2020-09-20 18:14:45,066 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: No position 4 defined for the field: 50000, line: 1 must be specified sales.csv
2020-09-20 18:14:45,068 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 18:14:45,069 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: No position 4 defined for the field: 40000.99, line: 1 must be specified sales.csv
2020-09-20 18:14:45,070 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 18:14:45,070 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 18:14:45,070 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 18:14:45,071 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 18:15:33,508 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 30682 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 18:15:33,514 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 18:15:35,158 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 18:15:35,173 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 18:15:35,174 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 18:15:35,175 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 18:15:35,286 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 18:15:35,286 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1678 ms
2020-09-20 18:15:35,573 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 18:15:35,862 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 18:15:36,200 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 18:15:36,234 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 18:15:36,242 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 18:15:36,334 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 18:15:36,335 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 18:15:36,335 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 18:15:36,691 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 18:15:36,693 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 18:15:36,693 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 18:15:36,713 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 18:15:36,722 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 18:15:36,723 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 18:15:36,724 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-20 18:15:36,724 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-20 18:15:36,724 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-20 18:15:36,724 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-20 18:15:36,728 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 6 routes, of which 6 are started
2020-09-20 18:15:36,729 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.037 seconds
2020-09-20 18:15:36,735 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 3.869 seconds (JVM running for 4.706)
2020-09-20 18:16:05,036 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 18:16:05,037 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 18:16:05,054 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 18:16:05,084 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 18:16:05,085 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 18:16:05,085 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 18:16:05,086 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 18:16:05,086 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio Parse dos registros do arquivo. sales.csv
2020-09-20 18:17:19,136 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 30996 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 18:17:19,143 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 18:17:20,978 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 18:17:20,999 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 18:17:21,000 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 18:17:21,000 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 18:17:21,117 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 18:17:21,118 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1899 ms
2020-09-20 18:17:21,522 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 18:17:21,893 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 18:17:22,317 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 18:17:22,357 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 18:17:22,366 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 18:17:22,489 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 18:17:22,490 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 18:17:22,490 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 18:17:22,830 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 18:17:22,832 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 18:17:22,833 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 18:17:22,857 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 18:17:22,867 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 18:17:22,868 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 18:17:22,868 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-20 18:17:22,868 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-20 18:17:22,869 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-20 18:17:22,869 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-20 18:17:22,873 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 6 routes, of which 6 are started
2020-09-20 18:17:22,873 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.043 seconds
2020-09-20 18:17:22,882 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.58 seconds (JVM running for 5.489)
2020-09-20 18:18:30,618 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 31240 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 18:18:30,624 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-20 18:18:30,625 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 18:18:32,231 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 18:18:32,245 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 18:18:32,246 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 18:18:32,246 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 18:18:32,348 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 18:18:32,348 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1631 ms
2020-09-20 18:18:32,640 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 18:18:32,966 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 18:18:33,398 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 18:18:33,438 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 18:18:33,445 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 18:18:33,534 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 18:18:33,534 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 18:18:33,534 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 18:18:33,810 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 18:18:33,813 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 18:18:33,814 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 18:18:33,836 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 18:18:33,843 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 18:18:33,844 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 18:18:33,844 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-20 18:18:33,845 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-20 18:18:33,845 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-20 18:18:33,845 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-20 18:18:33,849 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 6 routes, of which 6 are started
2020-09-20 18:18:33,849 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.038 seconds
2020-09-20 18:18:33,854 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 3.912 seconds (JVM running for 4.912)
2020-09-20 18:18:45,023 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 18:18:45,024 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 18:18:45,044 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-20 18:18:45,070 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-20 18:18:45,071 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro 0022345675434544345Jose da SilvaRural
2020-09-20 18:18:45,071 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro 0022345675433444345Eduardo PereiraRural
2020-09-20 18:18:45,071 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-20 18:18:45,071 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-20 18:19:41,418 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 31508 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 18:19:41,424 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-20 18:19:41,425 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 18:19:43,306 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 18:19:43,328 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 18:19:43,329 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 18:19:43,329 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 18:19:43,452 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 18:19:43,452 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1926 ms
2020-09-20 18:19:43,787 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 18:19:44,136 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 18:19:44,678 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 18:19:44,708 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 18:19:44,716 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 18:19:44,823 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 18:19:44,824 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 18:19:44,824 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 18:19:45,126 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 18:19:45,128 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 18:19:45,129 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 18:19:45,149 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 18:19:45,158 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 18:19:45,159 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 18:19:45,160 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-20 18:19:45,160 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-20 18:19:45,160 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-20 18:19:45,160 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-20 18:19:45,165 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 6 routes, of which 6 are started
2020-09-20 18:19:45,166 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.039 seconds
2020-09-20 18:19:45,177 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.551 seconds (JVM running for 5.366)
2020-09-20 18:20:05,033 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 18:20:05,035 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 18:20:05,052 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-20 18:20:05,079 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-20 18:20:05,080 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-20 18:20:05,082 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: Parsing error detected for field defined at the position: 4, line: 1 sales.csv
2020-09-20 18:20:05,083 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-20 18:20:05,083 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: Parsing error detected for field defined at the position: 4, line: 1 sales.csv
2020-09-20 18:20:05,084 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-20 18:20:05,084 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: Parsing error detected for field defined at the position: 4, line: 1 sales.csv
2020-09-20 18:20:05,085 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-20 18:20:05,086 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: Parsing error detected for field defined at the position: 4, line: 1 sales.csv
2020-09-20 18:22:00,046 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 31817 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 18:22:00,051 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-20 18:22:00,053 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 18:22:02,035 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 18:22:02,067 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 18:22:02,068 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 18:22:02,069 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 18:22:02,228 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 18:22:02,228 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 2106 ms
2020-09-20 18:22:02,631 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 18:22:03,018 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 18:22:03,486 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 18:22:03,515 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 18:22:03,522 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 18:22:03,648 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 18:22:03,649 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 18:22:03,652 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 18:22:04,034 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 18:22:04,037 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 18:22:04,038 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 18:22:04,065 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 18:22:04,075 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 18:22:04,076 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 18:22:04,077 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-20 18:22:04,077 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-20 18:22:04,077 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-20 18:22:04,077 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-20 18:22:04,084 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 6 routes, of which 6 are started
2020-09-20 18:22:04,085 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.051 seconds
2020-09-20 18:22:04,093 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.772 seconds (JVM running for 5.688)
2020-09-20 18:23:10,013 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 18:23:10,014 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 18:23:10,029 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro 0011234567891234Pedro50000
2020-09-20 18:23:10,030 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro 0013245678865434Paulo40000.99
2020-09-20 18:23:10,030 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-20 18:23:10,055 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: Parsing error detected for field defined at the position: 4, line: 1 sales.csv
2020-09-20 18:23:10,056 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-20 18:23:10,057 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Exception: java.lang.IllegalArgumentException: Parsing error detected for field defined at the position: 4, line: 1 sales.csv
2020-09-20 18:23:10,057 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-20 18:23:10,058 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-20 18:27:13,482 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 32291 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 18:27:13,489 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-20 18:27:13,491 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 18:27:15,172 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 18:27:15,191 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 18:27:15,192 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 18:27:15,192 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 18:27:15,317 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 18:27:15,317 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1722 ms
2020-09-20 18:27:15,636 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 18:27:15,978 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 18:27:16,362 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 18:27:16,400 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 18:27:16,407 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 18:27:16,490 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 18:27:16,491 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 18:27:16,491 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 18:27:16,807 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 18:27:16,809 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 18:27:16,809 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 18:27:16,827 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 18:27:16,835 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 18:27:16,836 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 18:27:16,836 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-20 18:27:16,837 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-20 18:27:16,837 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-20 18:27:16,837 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-20 18:27:16,840 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 6 routes, of which 6 are started
2020-09-20 18:27:16,841 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.034 seconds
2020-09-20 18:27:16,848 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.037 seconds (JVM running for 4.847)
2020-09-20 18:31:45,013 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 18:31:45,014 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 18:31:45,034 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro 0011234567891234Pedro50000
2020-09-20 18:31:45,035 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro 0013245678865434Paulo40000.99
2020-09-20 18:31:45,035 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-20 18:31:45,075 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Parsing error detected for field defined at the position: 4, line: 1 - java.lang.IllegalArgumentException: Parsing error detected for field defined at the position: 4, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.setDataFieldValue(BindyCsvFactory.java:264)
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:186)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.TryProcessor$TryState.run(TryProcessor.java:108)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.NumberFormatException
	at java.math.BigDecimal.<init>(BigDecimal.java:497)
	at java.math.BigDecimal.<init>(BigDecimal.java:383)
	at java.math.BigDecimal.<init>(BigDecimal.java:809)
	at org.apache.camel.dataformat.bindy.format.factories.BigDecimalFormatFactory$BigDecimalFormat.parse(BigDecimalFormatFactory.java:62)
	at org.apache.camel.dataformat.bindy.format.factories.BigDecimalFormatFactory$BigDecimalFormat.parse(BigDecimalFormatFactory.java:47)
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.setDataFieldValue(BindyCsvFactory.java:259)
	... 27 more

2020-09-20 18:31:45,076 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-20 18:31:45,078 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Parsing error detected for field defined at the position: 4, line: 1 - java.lang.IllegalArgumentException: Parsing error detected for field defined at the position: 4, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.setDataFieldValue(BindyCsvFactory.java:264)
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:186)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.TryProcessor$TryState.run(TryProcessor.java:108)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.NumberFormatException
	at java.math.BigDecimal.<init>(BigDecimal.java:497)
	at java.math.BigDecimal.<init>(BigDecimal.java:383)
	at java.math.BigDecimal.<init>(BigDecimal.java:809)
	at org.apache.camel.dataformat.bindy.format.factories.BigDecimalFormatFactory$BigDecimalFormat.parse(BigDecimalFormatFactory.java:62)
	at org.apache.camel.dataformat.bindy.format.factories.BigDecimalFormatFactory$BigDecimalFormat.parse(BigDecimalFormatFactory.java:47)
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.setDataFieldValue(BindyCsvFactory.java:259)
	... 27 more

2020-09-20 18:31:45,079 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-20 18:31:45,079 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-20 18:38:15,365 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 534 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 18:38:15,370 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-20 18:38:15,371 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 18:38:17,053 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 18:38:17,073 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 18:38:17,074 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 18:38:17,075 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 18:38:17,221 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 18:38:17,222 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1755 ms
2020-09-20 18:38:17,566 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 18:38:17,932 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 18:38:18,363 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 18:38:18,390 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 18:38:18,397 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 18:38:18,478 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 18:38:18,479 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 18:38:18,479 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 18:38:18,757 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 18:38:18,760 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 18:38:18,760 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 18:38:18,783 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 18:38:18,790 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 18:38:18,792 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 18:38:18,792 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-20 18:38:18,792 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-20 18:38:18,792 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-20 18:38:18,792 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-20 18:38:18,796 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 6 routes, of which 6 are started
2020-09-20 18:38:18,797 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.039 seconds
2020-09-20 18:38:18,803 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.236 seconds (JVM running for 5.139)
2020-09-20 18:38:35,033 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 18:38:35,034 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 18:38:35,050 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-20 18:38:35,074 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-20 18:38:35,075 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-20 18:38:35,076 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-20 18:38:35,077 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-20 18:38:35,079 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-20 18:53:54,240 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 2275 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 18:53:54,245 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-20 18:53:54,246 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 18:53:55,933 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 18:53:55,955 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 18:53:55,956 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 18:53:55,957 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 18:53:56,103 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 18:53:56,104 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1767 ms
2020-09-20 18:53:56,470 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 18:53:56,781 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 18:53:57,373 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 18:53:57,411 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 18:53:57,417 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 18:53:57,500 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 18:53:57,500 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 18:53:57,501 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 18:53:57,783 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 18:53:57,786 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 18:53:57,786 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 18:53:57,807 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 18:53:57,816 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 18:53:57,817 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 18:53:57,817 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-20 18:53:57,818 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-20 18:53:57,818 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-20 18:53:57,818 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-20 18:53:57,818 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-20 18:53:57,823 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 7 routes, of which 7 are started
2020-09-20 18:53:57,823 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.039 seconds
2020-09-20 18:53:57,829 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.358 seconds (JVM running for 5.196)
2020-09-20 18:54:15,017 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 18:54:15,019 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 18:54:15,042 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-20 18:54:15,069 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-20 18:54:15,070 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-20 18:54:15,071 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-20 18:54:15,072 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-20 18:54:15,074 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-20 19:27:38,970 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 5632 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 19:27:38,976 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-20 19:27:38,977 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 19:27:40,897 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 19:27:40,922 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 19:27:40,923 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 19:27:40,924 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 19:27:41,044 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 19:27:41,045 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1994 ms
2020-09-20 19:27:41,432 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 19:27:41,730 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 19:27:42,182 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 19:27:42,233 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 19:27:42,244 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 19:27:42,358 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 19:27:42,359 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 19:27:42,360 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 19:27:42,661 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 19:27:42,664 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 19:27:42,664 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 19:27:42,698 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 19:27:42,709 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 19:27:42,711 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 19:27:42,711 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-20 19:27:42,712 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-20 19:27:42,712 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-20 19:27:42,712 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-20 19:27:42,713 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-20 19:27:42,718 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 7 routes, of which 7 are started
2020-09-20 19:27:42,719 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.058 seconds
2020-09-20 19:27:42,726 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.563 seconds (JVM running for 5.46)
2020-09-20 19:30:20,023 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 19:30:20,024 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 19:30:20,047 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-20 19:30:20,078 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-20 19:30:20,080 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-20 19:30:20,081 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-20 19:30:20,082 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-20 19:30:20,083 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-20 19:30:25,493 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado Importao. [sales.csv]
2020-09-20 19:34:27,835 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 6306 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 19:34:27,842 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-20 19:34:27,842 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 19:34:29,543 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 19:34:29,557 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 19:34:29,558 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 19:34:29,558 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 19:34:29,666 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 19:34:29,666 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1715 ms
2020-09-20 19:34:30,041 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 19:34:30,355 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 19:34:30,816 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 19:34:30,864 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 19:34:30,873 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 19:34:30,994 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 19:34:30,994 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 19:34:30,995 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 19:34:31,287 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 19:34:31,289 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 19:34:31,289 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 19:34:31,313 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 19:34:31,323 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 19:34:31,325 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 19:34:31,325 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-20 19:34:31,325 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-20 19:34:31,325 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-20 19:34:31,325 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-20 19:34:31,325 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-20 19:34:31,330 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 7 routes, of which 7 are started
2020-09-20 19:34:31,330 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.043 seconds
2020-09-20 19:34:31,337 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.229 seconds (JVM running for 5.105)
2020-09-20 19:34:55,042 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 19:34:55,044 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 19:34:55,067 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-20 19:34:55,108 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-20 19:34:55,109 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-20 19:34:55,111 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-20 19:34:55,112 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-20 19:34:55,114 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-20 19:35:01,602 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR o.a.c.p.e.DefaultErrorHandler -  - Failed delivery for (MessageId: ID-unicred-fabio-souza-1600641295052-0-2 on ExchangeId: ID-unicred-fabio-souza-1600641295052-0-1). Exhausted after delivery attempt: 1 caught: java.lang.ClassCastException: org.apache.camel.component.file.GenericFileMessage cannot be cast to com.github.fabiosoaza.salesimporter.infrastructure.record.ImportRecord

Message History (complete message history is disabled)
---------------------------------------------------------------------------------------------------------------------------------------
RouteId              ProcessorId          Processor                                                                        Elapsed (ms)
[filesystemReadingI] [filesystemReadingI] [from[file:///home/fabio/Documents/sales-importer/in?delay=1000&move=%2Fhome%2F] [      6592]
	...
[direct:transform  ] [process1          ] [Processor@0x463045fb                                                          ] [         0]

Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------

java.lang.ClassCastException: org.apache.camel.component.file.GenericFileMessage cannot be cast to com.github.fabiosoaza.salesimporter.infrastructure.record.ImportRecord
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:174)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.LongPipeline.reduce(LongPipeline.java:461)
	at java.util.stream.LongPipeline.sum(LongPipeline.java:419)
	at java.util.stream.ReferencePipeline.count(ReferencePipeline.java:593)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesSumarizer.countByType(SalesSumarizer.java:30)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesSumarizer.sum(SalesSumarizer.java:18)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.TransformerProcessor.process(TransformerProcessor.java:26)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-20 19:35:01,603 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] WARN  o.a.c.c.f.GenericFileOnCompletion -  - Rollback file strategy: org.apache.camel.component.file.strategy.GenericFileRenameProcessStrategy@bbd6fb2 for file: GenericFile[/home/fabio/Documents/sales-importer/in/sales.csv]
2020-09-20 19:36:43,705 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 6547 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 19:36:43,711 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-20 19:36:43,712 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 19:36:45,616 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 19:36:45,635 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 19:36:45,636 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 19:36:45,636 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 19:36:45,764 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 19:36:45,764 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1967 ms
2020-09-20 19:36:46,185 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 19:36:46,526 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 19:36:46,945 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 19:36:46,981 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 19:36:46,987 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 19:36:47,073 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 19:36:47,073 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 19:36:47,074 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 19:36:47,375 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 19:36:47,378 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 19:36:47,378 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 19:36:47,401 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 19:36:47,408 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 19:36:47,410 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 19:36:47,410 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-20 19:36:47,410 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-20 19:36:47,410 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-20 19:36:47,410 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-20 19:36:47,411 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-20 19:36:47,414 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 7 routes, of which 7 are started
2020-09-20 19:36:47,415 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.039 seconds
2020-09-20 19:36:47,424 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.502 seconds (JVM running for 5.351)
2020-09-20 19:37:25,042 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 19:37:25,043 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 19:37:25,064 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-20 19:37:25,099 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-20 19:37:25,101 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-20 19:37:25,102 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-20 19:37:25,103 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-20 19:37:25,105 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-20 19:39:29,366 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 6862 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 19:39:29,372 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-20 19:39:29,373 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 19:39:31,206 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 19:39:31,224 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 19:39:31,225 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 19:39:31,225 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 19:39:31,333 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 19:39:31,334 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1856 ms
2020-09-20 19:39:31,761 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 19:39:32,184 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 19:39:32,673 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 19:39:32,730 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 19:39:32,739 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 19:39:32,853 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 19:39:32,854 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 19:39:32,854 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 19:39:33,267 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 19:39:33,270 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 19:39:33,270 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 19:39:33,303 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 19:39:33,317 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 19:39:33,318 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 19:39:33,319 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-20 19:39:33,319 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-20 19:39:33,319 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-20 19:39:33,320 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-20 19:39:33,320 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-20 19:39:33,325 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 7 routes, of which 7 are started
2020-09-20 19:39:33,326 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.057 seconds
2020-09-20 19:39:33,331 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.718 seconds (JVM running for 5.668)
2020-09-20 19:39:35,038 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 19:39:35,039 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 19:39:35,062 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-20 19:39:35,096 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-20 19:39:35,097 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-20 19:39:35,098 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-20 19:39:35,099 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-20 19:39:35,100 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-20 19:39:47,677 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado Importao. Summary [totalClients=2, totalSellers=2, mostExpensiveSaleId=, worstPerformanceSellerName=]
2020-09-20 19:54:10,495 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 8067 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 19:54:10,501 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-20 19:54:10,501 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 19:54:12,376 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 19:54:12,392 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 19:54:12,392 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 19:54:12,393 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 19:54:12,513 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 19:54:12,513 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1914 ms
2020-09-20 19:54:12,972 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 19:54:13,422 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 19:54:13,853 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 19:54:13,882 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 19:54:13,889 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 19:54:14,002 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 19:54:14,003 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 19:54:14,004 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 19:54:14,388 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 19:54:14,392 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 19:54:14,392 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 19:54:14,425 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 19:54:14,435 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 19:54:14,438 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 19:54:14,438 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-20 19:54:14,439 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-20 19:54:14,439 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-20 19:54:14,440 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-20 19:54:14,440 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-20 19:54:14,445 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 7 routes, of which 7 are started
2020-09-20 19:54:14,445 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.056 seconds
2020-09-20 19:54:14,455 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.756 seconds (JVM running for 5.609)
2020-09-20 20:02:05,039 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 20:02:05,041 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 20:02:05,064 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-20 20:02:05,089 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-20 20:02:05,090 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-20 20:02:05,091 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-20 20:02:05,092 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-20 20:02:05,094 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] WARN  o.a.c.d.bindy.BindyCsvFactory -  - Potentially invalid model: existing @DataField 'id' replaced by 'recordType'
2020-09-20 20:02:05,094 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] WARN  o.a.c.d.bindy.BindyCsvFactory -  - Potentially invalid model: existing @DataField 'quantity' replaced by 'id'
2020-09-20 20:02:05,094 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] WARN  o.a.c.d.bindy.BindyCsvFactory -  - Potentially invalid model: existing @DataField 'price' replaced by 'items'
2020-09-20 20:02:05,098 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Can not findForFormattingOptions a suitable formatter for the type: java.util.List - java.lang.IllegalArgumentException: Can not findForFormattingOptions a suitable formatter for the type: java.util.List
	at org.apache.camel.dataformat.bindy.format.factories.DefaultFactoryRegistry.findForFormattingOptions(DefaultFactoryRegistry.java:122)
	at org.apache.camel.dataformat.bindy.FormatFactory.doGetFormat(FormatFactory.java:32)
	at org.apache.camel.dataformat.bindy.FormatFactory.getFormat(FormatFactory.java:44)
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.setDataFieldValue(BindyCsvFactory.java:241)
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:186)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.TryProcessor$TryState.run(TryProcessor.java:108)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-20 20:02:05,098 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-20 20:02:05,099 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Can not findForFormattingOptions a suitable formatter for the type: java.util.List - java.lang.IllegalArgumentException: Can not findForFormattingOptions a suitable formatter for the type: java.util.List
	at org.apache.camel.dataformat.bindy.format.factories.DefaultFactoryRegistry.findForFormattingOptions(DefaultFactoryRegistry.java:122)
	at org.apache.camel.dataformat.bindy.FormatFactory.doGetFormat(FormatFactory.java:32)
	at org.apache.camel.dataformat.bindy.FormatFactory.getFormat(FormatFactory.java:44)
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.setDataFieldValue(BindyCsvFactory.java:241)
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:186)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.TryProcessor$TryState.run(TryProcessor.java:108)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-20 20:02:57,448 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR o.a.c.p.e.DefaultErrorHandler -  - Failed delivery for (MessageId: ID-unicred-fabio-souza-1600642925051-0-2 on ExchangeId: ID-unicred-fabio-souza-1600642925051-0-1). Exhausted after delivery attempt: 1 caught: java.lang.ClassCastException: java.lang.String cannot be cast to com.github.fabiosoaza.salesimporter.infrastructure.record.ImportRecord

Message History (complete message history is disabled)
---------------------------------------------------------------------------------------------------------------------------------------
RouteId              ProcessorId          Processor                                                                        Elapsed (ms)
[filesystemReadingI] [filesystemReadingI] [from[file:///home/fabio/Documents/sales-importer/in?delay=1000&move=%2Fhome%2F] [     52433]
	...
[direct:transform  ] [process1          ] [Processor@0x47187f50                                                          ] [         0]

Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------

java.lang.ClassCastException: java.lang.String cannot be cast to com.github.fabiosoaza.salesimporter.infrastructure.record.ImportRecord
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:174)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.LongPipeline.reduce(LongPipeline.java:461)
	at java.util.stream.LongPipeline.sum(LongPipeline.java:419)
	at java.util.stream.ReferencePipeline.count(ReferencePipeline.java:593)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesSumarizer.countByType(SalesSumarizer.java:29)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesSumarizer.sum(SalesSumarizer.java:17)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.TransformerProcessor.process(TransformerProcessor.java:26)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-20 20:02:57,450 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] WARN  o.a.c.c.f.GenericFileOnCompletion -  - Rollback file strategy: org.apache.camel.component.file.strategy.GenericFileRenameProcessStrategy@6ae3f96f for file: GenericFile[/home/fabio/Documents/sales-importer/in/sales.csv]
2020-09-20 21:59:23,874 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 19526 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 21:59:23,880 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-20 21:59:23,881 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 21:59:25,534 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 21:59:25,548 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 21:59:25,549 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 21:59:25,549 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 21:59:25,656 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 21:59:25,657 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1704 ms
2020-09-20 21:59:26,013 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 21:59:26,442 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 21:59:26,820 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 21:59:26,856 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 21:59:26,864 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 21:59:26,980 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 21:59:26,981 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 21:59:26,981 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 21:59:27,289 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 21:59:27,291 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 21:59:27,291 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 21:59:27,315 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 21:59:27,324 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 21:59:27,326 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 21:59:27,326 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-20 21:59:27,326 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-20 21:59:27,326 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-20 21:59:27,327 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-20 21:59:27,327 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-20 21:59:27,331 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 7 routes, of which 7 are started
2020-09-20 21:59:27,331 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.042 seconds
2020-09-20 21:59:27,338 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.259 seconds (JVM running for 5.145)
2020-09-20 22:00:50,038 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 22:00:50,040 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 22:00:50,060 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-20 22:00:50,061 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-20 22:00:50,086 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-20 22:00:50,087 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-20 22:00:50,088 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-20 22:00:50,089 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-20 22:00:50,090 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-20 22:00:50,090 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-20 22:00:50,091 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-20 22:00:50,097 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.TryProcessor$TryState.run(TryProcessor.java:108)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-20 22:23:50,770 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 21802 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 22:23:50,776 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-20 22:23:50,777 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 22:23:52,464 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 22:23:52,483 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 22:23:52,484 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 22:23:52,484 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 22:23:52,566 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 22:23:52,566 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1664 ms
2020-09-20 22:23:52,914 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 22:23:53,310 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 22:23:53,800 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 22:23:53,847 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 22:23:53,854 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 22:23:53,970 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 22:23:53,971 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 22:23:53,971 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 22:23:54,336 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Pausing ProtocolHandler ["http-nio-8080"]
2020-09-20 22:23:54,346 [main] INFO  o.a.catalina.core.StandardService -  - Stopping service [Tomcat]
2020-09-20 22:23:54,351 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Stopping ProtocolHandler ["http-nio-8080"]
2020-09-20 22:23:54,398 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Destroying ProtocolHandler ["http-nio-8080"]
2020-09-20 22:23:54,402 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLoggingListener -  - 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2020-09-20 22:23:54,408 [main] ERROR o.s.boot.SpringApplication -  - Application run failed
org.apache.camel.FailedToCreateRouteException: Failed to create route direct:transform at: >>> process[Processor@0x0] <<< in route: Route(direct:transform)[From[direct:transform] -> [process[P... because of ref must be specified on: process[Processor@0x0]
	at org.apache.camel.reifier.RouteReifier.doCreateRoute(RouteReifier.java:385)
	at org.apache.camel.reifier.RouteReifier.createRoute(RouteReifier.java:112)
	at org.apache.camel.impl.DefaultCamelContext.startRouteDefinitions(DefaultCamelContext.java:426)
	at org.apache.camel.impl.DefaultCamelContext.startRouteDefinitions(DefaultCamelContext.java:388)
	at org.apache.camel.impl.engine.AbstractCamelContext.doInit(AbstractCamelContext.java:2680)
	at org.apache.camel.support.service.BaseService.init(BaseService.java:83)
	at org.apache.camel.impl.engine.AbstractCamelContext.init(AbstractCamelContext.java:2452)
	at org.apache.camel.support.service.BaseService.start(BaseService.java:111)
	at org.apache.camel.impl.engine.AbstractCamelContext.start(AbstractCamelContext.java:2469)
	at org.apache.camel.spring.SpringCamelContext.start(SpringCamelContext.java:130)
	at org.apache.camel.spring.SpringCamelContext.onApplicationEvent(SpringCamelContext.java:167)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:172)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:165)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:139)
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:404)
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:361)
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:898)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:554)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:143)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:758)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:750)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:397)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:315)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1237)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1226)
	at com.github.fabiosoaza.salesimporter.application.SalesImporterApplication.main(SalesImporterApplication.java:12)
Caused by: java.lang.IllegalArgumentException: ref must be specified on: process[Processor@0x0]
	at org.apache.camel.util.ObjectHelper.notNull(ObjectHelper.java:171)
	at org.apache.camel.reifier.ProcessReifier.createProcessor(ProcessReifier.java:39)
	at org.apache.camel.reifier.ProcessorReifier.makeProcessor(ProcessorReifier.java:752)
	at org.apache.camel.reifier.ProcessorReifier.addRoutes(ProcessorReifier.java:495)
	at org.apache.camel.reifier.RouteReifier.doCreateRoute(RouteReifier.java:383)
	... 25 common frames omitted
2020-09-20 22:23:54,418 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Shutting down ExecutorService 'applicationTaskExecutor'
2020-09-20 22:25:17,514 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 21954 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 22:25:17,519 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-20 22:25:17,520 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 22:25:19,411 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 22:25:19,430 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 22:25:19,431 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 22:25:19,431 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 22:25:19,569 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 22:25:19,569 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1953 ms
2020-09-20 22:25:19,972 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 22:25:20,398 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 22:25:20,879 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 22:25:20,992 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 22:25:20,998 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 22:25:21,132 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 22:25:21,133 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 22:25:21,133 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 22:25:21,586 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 22:25:21,588 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 22:25:21,589 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 22:25:21,623 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 22:25:21,638 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 22:25:21,640 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 22:25:21,641 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-20 22:25:21,641 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-20 22:25:21,642 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-20 22:25:21,642 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-20 22:25:21,642 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-20 22:25:21,647 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 7 routes, of which 7 are started
2020-09-20 22:25:21,648 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.062 seconds
2020-09-20 22:25:21,654 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.899 seconds (JVM running for 5.731)
2020-09-20 22:25:25,037 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 22:25:25,039 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 22:25:25,059 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-20 22:25:25,060 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-20 22:25:25,083 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-20 22:25:25,084 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-20 22:25:25,086 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-20 22:25:25,086 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-20 22:25:25,088 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-20 22:25:25,089 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-20 22:25:25,089 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-20 22:25:25,093 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.TryProcessor$TryState.run(TryProcessor.java:108)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-20 22:30:20,510 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 22576 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 22:30:20,516 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-20 22:30:20,518 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 22:30:22,574 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 22:30:22,593 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 22:30:22,594 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 22:30:22,594 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 22:30:22,714 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 22:30:22,714 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 2080 ms
2020-09-20 22:30:23,094 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 22:30:23,423 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 22:30:23,822 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 22:30:23,874 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 22:30:23,883 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 22:30:23,997 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 22:30:23,998 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 22:30:23,998 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 22:30:24,340 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 22:30:24,343 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 22:30:24,343 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 22:30:24,371 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 22:30:24,382 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 22:30:24,384 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 22:30:24,385 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-20 22:30:24,385 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-20 22:30:24,385 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-20 22:30:24,386 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-20 22:30:24,386 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-20 22:30:24,390 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 7 routes, of which 7 are started
2020-09-20 22:30:24,391 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.050 seconds
2020-09-20 22:30:24,398 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.737 seconds (JVM running for 5.577)
2020-09-20 22:30:25,015 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 22:30:25,016 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 22:30:25,032 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-20 22:30:25,033 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-20 22:30:25,064 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-20 22:30:25,065 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-20 22:30:25,066 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-20 22:30:25,067 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-20 22:30:25,069 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-20 22:30:25,069 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-20 22:30:25,070 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-20 22:30:25,074 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.TryProcessor$TryState.run(TryProcessor.java:108)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-20 22:30:47,248 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado Importao. Summary [totalClients=2, totalSellers=2, mostExpensiveSaleId=, worstPerformanceSellerName=]
2020-09-20 22:30:55,001 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 22:30:55,002 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 22:30:55,006 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-20 22:30:55,007 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-20 22:30:55,010 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-20 22:30:55,013 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-20 22:30:55,015 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-20 22:30:55,018 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-20 22:30:55,020 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-20 22:30:55,022 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-20 22:30:55,023 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-20 22:30:55,024 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.TryProcessor$TryState.run(TryProcessor.java:108)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-20 22:31:16,661 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado Importao. Summary [totalClients=2, totalSellers=2, mostExpensiveSaleId=, worstPerformanceSellerName=]
2020-09-20 22:31:55,003 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 22:31:55,004 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 22:31:55,007 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-20 22:31:55,009 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-20 22:31:55,011 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-20 22:31:55,013 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-20 22:31:55,015 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-20 22:31:55,018 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-20 22:31:55,021 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-20 22:31:55,023 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-20 22:31:55,024 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-20 22:31:55,026 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.TryProcessor$TryState.run(TryProcessor.java:108)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-20 22:31:55,027 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-20 22:31:57,659 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.r.RecordsValidatorProcessor -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.validate(RecordsValidatorProcessor.java:55)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.isValidImportRecord(RecordsValidatorProcessor.java:45)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.lambda$0(RecordsValidatorProcessor.java:38)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:174)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.process(RecordsValidatorProcessor.java:40)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-20 22:32:01,369 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado Importao. Summary [totalClients=2, totalSellers=2, mostExpensiveSaleId=, worstPerformanceSellerName=]
2020-09-20 23:27:42,236 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 28891 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 23:27:42,242 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-20 23:27:42,244 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 23:27:43,905 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 23:27:43,924 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 23:27:43,925 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 23:27:43,925 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 23:27:44,041 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 23:27:44,041 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1688 ms
2020-09-20 23:27:44,388 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 23:27:44,801 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 23:27:45,296 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 23:27:45,337 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 23:27:45,343 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 23:27:45,441 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 23:27:45,442 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 23:27:45,442 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 23:27:45,769 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 23:27:45,771 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 23:27:45,771 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 23:27:45,790 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 23:27:45,800 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 23:27:45,801 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 23:27:45,802 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-20 23:27:45,802 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-20 23:27:45,802 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-20 23:27:45,802 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-20 23:27:45,802 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-20 23:27:45,807 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 7 routes, of which 7 are started
2020-09-20 23:27:45,807 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.038 seconds
2020-09-20 23:27:45,812 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.274 seconds (JVM running for 5.082)
2020-09-20 23:28:40,033 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 23:28:40,034 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 23:28:40,053 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-20 23:28:40,054 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-20 23:28:40,082 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-20 23:28:40,083 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-20 23:28:40,085 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-20 23:28:40,085 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-20 23:28:40,087 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-20 23:28:40,088 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-20 23:28:40,088 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-20 23:28:40,091 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.TryProcessor$TryState.run(TryProcessor.java:108)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-20 23:28:40,092 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-20 23:28:49,703 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.r.RecordsValidatorProcessor -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.validate(RecordsValidatorProcessor.java:55)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.isValidImportRecord(RecordsValidatorProcessor.java:45)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.lambda$0(RecordsValidatorProcessor.java:38)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:174)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.process(RecordsValidatorProcessor.java:40)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-20 23:29:04,131 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado Importao. Summary [totalClients=2, totalSellers=2, mostExpensiveSaleId=10, worstPerformanceSellerName=]
2020-09-20 23:31:15,003 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 23:31:15,004 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 23:31:15,009 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-20 23:31:15,010 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-20 23:31:15,012 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-20 23:31:15,015 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-20 23:31:15,019 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-20 23:31:15,021 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-20 23:31:15,023 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-20 23:31:15,025 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-20 23:31:15,026 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-20 23:31:15,029 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-20 23:31:15,030 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.TryProcessor$TryState.run(TryProcessor.java:108)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-20 23:31:15,030 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-20 23:31:15,032 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.r.RecordsValidatorProcessor -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.validate(RecordsValidatorProcessor.java:55)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.isValidImportRecord(RecordsValidatorProcessor.java:45)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.lambda$0(RecordsValidatorProcessor.java:38)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:174)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.process(RecordsValidatorProcessor.java:40)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-20 23:31:15,033 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado Importao. Summary [totalClients=2, totalSellers=2, mostExpensiveSaleId=05, worstPerformanceSellerName=]
2020-09-20 23:35:23,754 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 29532 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-20 23:35:23,760 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-20 23:35:23,761 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-20 23:35:25,507 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-20 23:35:25,524 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-20 23:35:25,525 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-20 23:35:25,525 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-20 23:35:25,641 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-20 23:35:25,641 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1765 ms
2020-09-20 23:35:25,973 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-20 23:35:26,290 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-20 23:35:26,797 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-20 23:35:26,831 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-20 23:35:26,838 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-20 23:35:26,950 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-20 23:35:26,951 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-20 23:35:26,951 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-20 23:35:27,306 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-20 23:35:27,308 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-20 23:35:27,309 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-20 23:35:27,334 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-20 23:35:27,343 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-20 23:35:27,345 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-20 23:35:27,346 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-20 23:35:27,346 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-20 23:35:27,346 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-20 23:35:27,346 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-20 23:35:27,347 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-20 23:35:27,351 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 7 routes, of which 7 are started
2020-09-20 23:35:27,352 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.045 seconds
2020-09-20 23:35:27,359 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.329 seconds (JVM running for 5.084)
2020-09-20 23:36:15,034 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 23:36:15,035 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 23:36:15,055 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-20 23:36:15,057 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-20 23:36:15,088 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-20 23:36:15,090 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-20 23:36:15,092 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-20 23:36:15,093 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-20 23:36:15,095 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-20 23:36:15,096 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-20 23:36:15,097 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-20 23:36:15,097 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-20 23:36:15,102 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.TryProcessor$TryState.run(TryProcessor.java:108)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-20 23:36:15,102 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-20 23:36:15,136 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.r.RecordsValidatorProcessor -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.validate(RecordsValidatorProcessor.java:55)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.isValidImportRecord(RecordsValidatorProcessor.java:45)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.lambda$0(RecordsValidatorProcessor.java:38)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:174)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.process(RecordsValidatorProcessor.java:40)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-20 23:36:15,144 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado Importao. Summary [totalClients=2, totalSellers=2, mostExpensiveSaleId=05, worstPerformanceSellerName=Paulo]
2020-09-20 23:38:50,003 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-20 23:38:50,003 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-20 23:38:50,007 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-20 23:38:50,008 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-20 23:38:50,010 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-20 23:38:50,012 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-20 23:38:50,014 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-20 23:38:50,016 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-20 23:38:50,018 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-20 23:38:50,020 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-20 23:38:50,022 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-20 23:38:50,024 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-20 23:38:50,024 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-20 23:38:50,026 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.TryProcessor$TryState.run(TryProcessor.java:108)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-20 23:38:50,028 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-20 23:38:50,030 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.r.RecordsValidatorProcessor -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.validate(RecordsValidatorProcessor.java:55)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.isValidImportRecord(RecordsValidatorProcessor.java:45)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.lambda$0(RecordsValidatorProcessor.java:38)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:174)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.process(RecordsValidatorProcessor.java:40)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-20 23:38:50,032 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado Importao. Summary [totalClients=2, totalSellers=2, mostExpensiveSaleId=04, worstPerformanceSellerName=Paulo]
2020-09-21 00:31:10,668 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 3222 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-21 00:31:10,683 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-21 00:31:10,684 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-21 00:31:12,561 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-21 00:31:12,582 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-21 00:31:12,583 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-21 00:31:12,583 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-21 00:31:12,715 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-21 00:31:12,716 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1927 ms
2020-09-21 00:31:13,092 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-21 00:31:13,414 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 00:31:13,778 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-21 00:31:13,806 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-21 00:31:13,812 [main] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - uri: file:///home/fabio/Documents/sales-importer/in?scheduler=spring&scheduler.cron=0/5+*+*+?+*+*&delay=1000&recursive=true&move=/home/fabio/Documents/sales-importer/out&moveFailed=/home/fabio/Documents/sales-importer/errors
2020-09-21 00:31:13,913 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-21 00:31:13,913 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-21 00:31:13,915 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-21 00:31:14,243 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-21 00:31:14,245 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-21 00:31:14,245 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-21 00:31:14,269 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-21 00:31:14,277 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-21 00:31:14,278 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-21 00:31:14,279 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-21 00:31:14,279 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-21 00:31:14,279 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-21 00:31:14,279 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-21 00:31:14,279 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-21 00:31:14,283 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 7 routes, of which 7 are started
2020-09-21 00:31:14,283 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.040 seconds
2020-09-21 00:31:14,291 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.5 seconds (JVM running for 5.283)
2020-09-21 00:31:45,042 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.r.FileSystemImportRoutes -  - Importando o arquivo sales.csv
2020-09-21 00:31:45,044 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-21 00:31:45,067 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-21 00:31:45,070 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-21 00:31:45,110 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-21 00:31:45,111 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-21 00:31:45,113 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-21 00:31:45,114 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-21 00:31:45,117 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-21 00:31:45,117 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-21 00:31:45,118 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-21 00:31:45,119 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-21 00:31:45,120 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-21 00:31:45,125 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.TryProcessor$TryState.run(TryProcessor.java:108)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 00:31:45,126 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-21 00:31:45,154 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.r.RecordsValidatorProcessor -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.validate(RecordsValidatorProcessor.java:55)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.isValidImportRecord(RecordsValidatorProcessor.java:45)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.lambda$0(RecordsValidatorProcessor.java:38)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:174)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.process(RecordsValidatorProcessor.java:40)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 00:31:45,164 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado Importao. Summary [totalClients=2, totalSellers=2, mostExpensiveSaleId=04, worstPerformanceSellerName=Pedro]
2020-09-21 00:52:54,777 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 5192 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-21 00:52:54,784 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-21 00:52:54,785 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-21 00:52:56,701 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-21 00:52:56,725 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-21 00:52:56,726 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-21 00:52:56,726 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-21 00:52:56,859 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-21 00:52:56,859 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1929 ms
2020-09-21 00:52:57,245 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-21 00:52:57,642 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 00:52:58,157 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-21 00:52:58,205 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-21 00:52:58,350 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-21 00:52:58,351 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-21 00:52:58,351 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-21 00:52:58,763 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-21 00:52:58,766 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-21 00:52:58,766 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-21 00:52:58,794 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-21 00:52:58,803 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-21 00:52:58,805 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: exportReportId started and consuming from: direct://exportReport
2020-09-21 00:52:58,805 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-21 00:52:58,805 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-21 00:52:58,806 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-21 00:52:58,806 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-21 00:52:58,806 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-21 00:52:58,806 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-21 00:52:58,810 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 8 routes, of which 8 are started
2020-09-21 00:52:58,810 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.046 seconds
2020-09-21 00:52:58,817 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.635 seconds (JVM running for 5.379)
2020-09-21 00:53:10,038 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Importando o arquivo sales.csv
2020-09-21 00:53:10,040 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-21 00:53:10,063 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-21 00:53:10,066 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-21 00:53:10,109 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-21 00:53:10,110 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-21 00:53:10,112 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-21 00:53:10,113 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-21 00:53:10,116 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-21 00:53:10,117 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-21 00:53:10,118 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-21 00:53:10,119 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-21 00:53:10,120 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-21 00:53:10,125 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.TryProcessor$TryState.run(TryProcessor.java:108)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 00:53:10,126 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-21 00:53:10,164 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.r.RecordsValidatorProcessor -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.validate(RecordsValidatorProcessor.java:55)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.isValidImportRecord(RecordsValidatorProcessor.java:45)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.lambda$0(RecordsValidatorProcessor.java:38)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:174)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.process(RecordsValidatorProcessor.java:40)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 00:53:10,176 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado da Importao. Summary [totalClients=2, totalSellers=2, mostExpensiveSaleId=04, worstPerformanceSellerName=Pedro]
2020-09-21 00:53:10,179 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesExportRoutes -  -  Resultado 2204Pedro

2020-09-21 00:55:29,698 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 5672 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-21 00:55:29,702 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-21 00:55:29,703 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-21 00:55:31,352 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-21 00:55:31,369 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-21 00:55:31,369 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-21 00:55:31,370 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-21 00:55:31,488 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-21 00:55:31,488 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1714 ms
2020-09-21 00:55:31,829 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-21 00:55:32,136 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 00:55:32,516 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-21 00:55:32,565 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-21 00:55:32,668 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-21 00:55:32,669 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-21 00:55:32,669 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-21 00:55:32,976 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-21 00:55:32,979 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-21 00:55:32,979 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-21 00:55:33,011 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-21 00:55:33,020 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-21 00:55:33,021 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: exportReportId started and consuming from: direct://exportReport
2020-09-21 00:55:33,021 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-21 00:55:33,022 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-21 00:55:33,022 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-21 00:55:33,022 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-21 00:55:33,022 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-21 00:55:33,022 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-21 00:55:33,026 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 8 routes, of which 8 are started
2020-09-21 00:55:33,027 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.050 seconds
2020-09-21 00:55:33,033 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.143 seconds (JVM running for 5.054)
2020-09-21 00:55:40,037 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Importando o arquivo sales.csv
2020-09-21 00:55:40,039 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-21 00:55:40,059 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-21 00:55:40,062 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-21 00:55:40,091 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-21 00:55:40,092 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-21 00:55:40,094 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-21 00:55:40,095 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-21 00:55:40,098 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-21 00:55:40,099 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-21 00:55:40,099 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-21 00:55:40,100 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-21 00:55:40,100 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-21 00:55:40,104 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.TryProcessor$TryState.run(TryProcessor.java:108)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 00:55:40,104 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-21 00:55:40,130 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.r.RecordsValidatorProcessor -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.validate(RecordsValidatorProcessor.java:55)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.isValidImportRecord(RecordsValidatorProcessor.java:45)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.lambda$0(RecordsValidatorProcessor.java:38)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:174)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.process(RecordsValidatorProcessor.java:40)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 00:55:40,138 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado da Importao. Summary [totalClients=2, totalSellers=2, mostExpensiveSaleId=04, worstPerformanceSellerName=Pedro]
2020-09-21 00:55:40,141 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesExportRoutes -  -  Resultado 2204Pedro

2020-09-21 01:00:17,074 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 6360 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-21 01:00:17,080 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-21 01:00:17,081 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-21 01:00:19,117 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-21 01:00:19,139 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-21 01:00:19,140 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-21 01:00:19,140 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-21 01:00:19,256 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-21 01:00:19,256 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 2087 ms
2020-09-21 01:00:19,575 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-21 01:00:19,937 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 01:00:20,346 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-21 01:00:20,380 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-21 01:00:20,480 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-21 01:00:20,480 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-21 01:00:20,481 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-21 01:00:20,817 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-21 01:00:20,819 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-21 01:00:20,820 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-21 01:00:20,845 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-21 01:00:20,855 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-21 01:00:20,856 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: exportReportId started and consuming from: direct://exportReport
2020-09-21 01:00:20,857 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-21 01:00:20,857 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-21 01:00:20,857 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-21 01:00:20,858 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-21 01:00:20,858 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-21 01:00:20,858 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-21 01:00:20,863 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 8 routes, of which 8 are started
2020-09-21 01:00:20,863 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.046 seconds
2020-09-21 01:00:20,870 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.572 seconds (JVM running for 5.441)
2020-09-21 01:00:40,044 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Importando o arquivo sales.csv
2020-09-21 01:00:40,046 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-21 01:00:40,069 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-21 01:00:40,071 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-21 01:00:40,105 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-21 01:00:40,107 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-21 01:00:40,108 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-21 01:00:40,109 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-21 01:00:40,111 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-21 01:00:40,112 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-21 01:00:40,113 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-21 01:00:40,114 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-21 01:00:40,114 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-21 01:00:40,120 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.TryProcessor$TryState.run(TryProcessor.java:108)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 01:00:40,121 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-21 01:00:40,158 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.r.RecordsValidatorProcessor -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.validate(RecordsValidatorProcessor.java:55)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.isValidImportRecord(RecordsValidatorProcessor.java:45)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.lambda$0(RecordsValidatorProcessor.java:38)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:174)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.process(RecordsValidatorProcessor.java:40)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 01:00:40,171 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado da Importao. Summary [totalClients=2, totalSellers=2, mostExpensiveSaleId=04, worstPerformanceSellerName=Pedro]
2020-09-21 01:00:40,174 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesExportRoutes -  -  Resultado Total ClientsTotal SellersMost Expensive Sale IdWorst Performance Seller
2204Pedro

2020-09-21 01:03:45,003 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Importando o arquivo sales.csv
2020-09-21 01:03:45,003 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-21 01:03:45,008 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-21 01:03:45,011 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-21 01:03:45,015 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-21 01:03:45,018 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-21 01:03:45,020 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-21 01:03:45,023 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-21 01:03:45,025 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-21 01:03:45,026 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-21 01:03:45,028 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-21 01:03:45,030 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-21 01:03:45,030 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-21 01:03:45,032 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.TryProcessor$TryState.run(TryProcessor.java:108)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 01:03:45,032 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-21 01:03:45,034 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.r.RecordsValidatorProcessor -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.validate(RecordsValidatorProcessor.java:55)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.isValidImportRecord(RecordsValidatorProcessor.java:45)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.lambda$0(RecordsValidatorProcessor.java:38)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:174)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.process(RecordsValidatorProcessor.java:40)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 01:03:45,036 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado da Importao. Summary [totalClients=2, totalSellers=2, mostExpensiveSaleId=04, worstPerformanceSellerName=Pedro]
2020-09-21 01:03:45,037 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesExportRoutes -  -  Resultado Total ClientsTotal SellersMost Expensive Sale IdWorst Performance Seller
2204Pedro

2020-09-21 01:03:56,734 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 6768 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-21 01:03:56,740 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-21 01:03:56,741 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-21 01:03:58,538 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-21 01:03:58,556 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-21 01:03:58,557 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-21 01:03:58,558 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-21 01:03:58,697 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-21 01:03:58,697 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1877 ms
2020-09-21 01:03:58,993 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-21 01:03:59,293 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 01:03:59,677 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-21 01:03:59,711 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-21 01:03:59,833 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-21 01:03:59,834 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-21 01:03:59,834 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-21 01:04:00,183 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-21 01:04:00,186 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-21 01:04:00,186 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-21 01:04:00,214 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-21 01:04:00,224 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-21 01:04:00,226 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: exportReportId started and consuming from: direct://exportReport
2020-09-21 01:04:00,226 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-21 01:04:00,227 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-21 01:04:00,227 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-21 01:04:00,227 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-21 01:04:00,228 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-21 01:04:00,228 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-21 01:04:00,233 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 8 routes, of which 8 are started
2020-09-21 01:04:00,234 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.050 seconds
2020-09-21 01:04:00,241 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.264 seconds (JVM running for 5.069)
2020-09-21 01:04:20,034 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Importando o arquivo sales.csv
2020-09-21 01:04:20,036 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-21 01:04:20,060 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-21 01:04:20,062 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-21 01:04:20,098 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-21 01:04:20,099 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-21 01:04:20,101 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-21 01:04:20,102 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-21 01:04:20,104 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-21 01:04:20,105 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-21 01:04:20,105 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-21 01:04:20,106 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-21 01:04:20,106 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-21 01:04:20,111 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.TryProcessor$TryState.run(TryProcessor.java:108)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 01:04:20,112 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-21 01:04:20,149 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.r.RecordsValidatorProcessor -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.validate(RecordsValidatorProcessor.java:55)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.isValidImportRecord(RecordsValidatorProcessor.java:45)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.lambda$0(RecordsValidatorProcessor.java:38)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:174)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.process(RecordsValidatorProcessor.java:40)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 01:04:20,161 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado da Importao. Summary [totalClients=2, totalSellers=2, mostExpensiveSaleId=04, worstPerformanceSellerName=Pedro]
2020-09-21 01:04:20,164 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesExportRoutes -  -  Resultado Total ClientsTotal SellersMost Expensive Sale IdWorst Performance Seller
2204Pedro

2020-09-21 01:30:50,603 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 10208 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-21 01:30:50,607 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-21 01:30:50,608 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-21 01:30:52,448 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-21 01:30:52,465 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-21 01:30:52,466 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-21 01:30:52,466 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-21 01:30:52,609 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-21 01:30:52,609 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1893 ms
2020-09-21 01:30:52,978 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-21 01:30:53,313 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 01:30:53,737 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-21 01:30:53,766 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-21 01:30:53,854 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-21 01:30:53,855 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-21 01:30:53,855 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-21 01:30:53,891 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Pausing ProtocolHandler ["http-nio-8080"]
2020-09-21 01:30:53,904 [main] INFO  o.a.catalina.core.StandardService -  - Stopping service [Tomcat]
2020-09-21 01:30:53,914 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Stopping ProtocolHandler ["http-nio-8080"]
2020-09-21 01:30:53,954 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Destroying ProtocolHandler ["http-nio-8080"]
2020-09-21 01:30:53,957 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLoggingListener -  - 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2020-09-21 01:30:53,962 [main] ERROR o.s.boot.SpringApplication -  - Application run failed
org.apache.camel.FailedToStartRouteException: Failed to start route filesystemReadingId because of duplicate id detected: filesystemReadingId. Please correct ids to be unique among all your routes.
	at org.apache.camel.impl.DefaultCamelContext.startRouteDefinitions(DefaultCamelContext.java:408)
	at org.apache.camel.impl.DefaultCamelContext.startRouteDefinitions(DefaultCamelContext.java:388)
	at org.apache.camel.impl.engine.AbstractCamelContext.doInit(AbstractCamelContext.java:2680)
	at org.apache.camel.support.service.BaseService.init(BaseService.java:83)
	at org.apache.camel.impl.engine.AbstractCamelContext.init(AbstractCamelContext.java:2452)
	at org.apache.camel.support.service.BaseService.start(BaseService.java:111)
	at org.apache.camel.impl.engine.AbstractCamelContext.start(AbstractCamelContext.java:2469)
	at org.apache.camel.spring.SpringCamelContext.start(SpringCamelContext.java:130)
	at org.apache.camel.spring.SpringCamelContext.onApplicationEvent(SpringCamelContext.java:167)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:172)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:165)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:139)
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:404)
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:361)
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:898)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:554)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:143)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:758)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:750)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:397)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:315)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1237)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1226)
	at com.github.fabiosoaza.salesimporter.application.SalesImporterApplication.main(SalesImporterApplication.java:12)
2020-09-21 01:30:53,971 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Shutting down ExecutorService 'applicationTaskExecutor'
2020-09-21 01:35:20,640 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 10947 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-21 01:35:20,646 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-21 01:35:20,647 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-21 01:35:22,300 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-21 01:35:22,317 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-21 01:35:22,317 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-21 01:35:22,318 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-21 01:35:22,431 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-21 01:35:22,432 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1706 ms
2020-09-21 01:35:22,730 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-21 01:35:23,047 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 01:35:23,462 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-21 01:35:23,503 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-21 01:35:23,619 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-21 01:35:23,619 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-21 01:35:23,620 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-21 01:35:23,829 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Pausing ProtocolHandler ["http-nio-8080"]
2020-09-21 01:35:23,838 [main] INFO  o.a.catalina.core.StandardService -  - Stopping service [Tomcat]
2020-09-21 01:35:23,843 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Stopping ProtocolHandler ["http-nio-8080"]
2020-09-21 01:35:23,888 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Destroying ProtocolHandler ["http-nio-8080"]
2020-09-21 01:35:23,891 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLoggingListener -  - 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2020-09-21 01:35:23,897 [main] ERROR o.s.boot.SpringApplication -  - Application run failed
org.apache.camel.FailedToCreateRouteException: Failed to create route filesystemWritingId: Route(filesystemWritingId)[From[filesystemWriting] -> [Log[E... because of No endpoint could be found for: filesystemWriting, please check your classpath contains the needed Camel component jar.
	at org.apache.camel.reifier.RouteReifier.createRoute(RouteReifier.java:118)
	at org.apache.camel.impl.DefaultCamelContext.startRouteDefinitions(DefaultCamelContext.java:426)
	at org.apache.camel.impl.DefaultCamelContext.startRouteDefinitions(DefaultCamelContext.java:388)
	at org.apache.camel.impl.engine.AbstractCamelContext.doInit(AbstractCamelContext.java:2680)
	at org.apache.camel.support.service.BaseService.init(BaseService.java:83)
	at org.apache.camel.impl.engine.AbstractCamelContext.init(AbstractCamelContext.java:2452)
	at org.apache.camel.support.service.BaseService.start(BaseService.java:111)
	at org.apache.camel.impl.engine.AbstractCamelContext.start(AbstractCamelContext.java:2469)
	at org.apache.camel.spring.SpringCamelContext.start(SpringCamelContext.java:130)
	at org.apache.camel.spring.SpringCamelContext.onApplicationEvent(SpringCamelContext.java:167)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:172)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:165)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:139)
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:404)
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:361)
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:898)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:554)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:143)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:758)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:750)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:397)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:315)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1237)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1226)
	at com.github.fabiosoaza.salesimporter.application.SalesImporterApplication.main(SalesImporterApplication.java:12)
Caused by: org.apache.camel.NoSuchEndpointException: No endpoint could be found for: filesystemWriting, please check your classpath contains the needed Camel component jar.
	at org.apache.camel.impl.engine.AbstractCamelContext.doGetEndpoint(AbstractCamelContext.java:840)
	at org.apache.camel.impl.engine.AbstractCamelContext.getEndpoint(AbstractCamelContext.java:777)
	at org.apache.camel.support.CamelContextHelper.getMandatoryEndpoint(CamelContextHelper.java:58)
	at org.apache.camel.reifier.AbstractReifier.resolveEndpoint(AbstractReifier.java:177)
	at org.apache.camel.reifier.RouteReifier.doCreateRoute(RouteReifier.java:250)
	at org.apache.camel.reifier.RouteReifier.createRoute(RouteReifier.java:112)
	... 24 common frames omitted
2020-09-21 01:35:23,910 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Shutting down ExecutorService 'applicationTaskExecutor'
2020-09-21 01:36:21,225 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 11077 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-21 01:36:21,231 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-21 01:36:21,232 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-21 01:36:23,265 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-21 01:36:23,288 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-21 01:36:23,289 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-21 01:36:23,290 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-21 01:36:23,430 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-21 01:36:23,430 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 2101 ms
2020-09-21 01:36:23,775 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-21 01:36:24,203 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 01:36:24,610 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-21 01:36:24,635 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-21 01:36:24,746 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-21 01:36:24,746 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-21 01:36:24,747 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-21 01:36:25,108 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-21 01:36:25,110 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-21 01:36:25,111 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-21 01:36:25,146 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-21 01:36:25,158 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-21 01:36:25,160 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemWritingId started and consuming from: direct://filesystemWriting
2020-09-21 01:36:25,161 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: exportReportId started and consuming from: direct://exportReport
2020-09-21 01:36:25,161 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-21 01:36:25,161 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-21 01:36:25,162 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-21 01:36:25,162 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-21 01:36:25,162 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-21 01:36:25,162 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-21 01:36:25,167 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 9 routes, of which 9 are started
2020-09-21 01:36:25,167 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.059 seconds
2020-09-21 01:36:25,175 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.827 seconds (JVM running for 5.7)
2020-09-21 01:36:55,040 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Importando o arquivo sales.csv
2020-09-21 01:36:55,041 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-21 01:36:55,064 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-21 01:36:55,066 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-21 01:36:55,099 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-21 01:36:55,100 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-21 01:36:55,102 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-21 01:36:55,103 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-21 01:36:55,105 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-21 01:36:55,105 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-21 01:36:55,106 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-21 01:36:55,107 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-21 01:36:55,107 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-21 01:36:55,111 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.TryProcessor$TryState.run(TryProcessor.java:108)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 01:36:55,114 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-21 01:36:55,147 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.r.RecordsValidatorProcessor -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.validate(RecordsValidatorProcessor.java:55)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.isValidImportRecord(RecordsValidatorProcessor.java:45)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.lambda$0(RecordsValidatorProcessor.java:38)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:174)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.process(RecordsValidatorProcessor.java:40)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 01:36:55,161 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado da Importao. Summary [totalClients=2, totalSellers=2, mostExpensiveSaleId=04, worstPerformanceSellerName=Pedro]
2020-09-21 01:36:55,165 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesExportRoutes -  -  Resultado Total ClientsTotal SellersMost Expensive Sale IdWorst Performance Seller
2204Pedro

2020-09-21 01:36:55,166 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Exportando o arquivo sales.out.csv
2020-09-21 01:37:35,001 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Importando o arquivo sales.csv
2020-09-21 01:37:35,001 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-21 01:37:35,003 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-21 01:37:35,004 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-21 01:37:35,005 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-21 01:37:35,007 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-21 01:37:35,008 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-21 01:37:35,009 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-21 01:37:35,010 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-21 01:37:35,011 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-21 01:37:35,012 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-21 01:37:35,013 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-21 01:37:35,014 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-21 01:37:35,015 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.TryProcessor$TryState.run(TryProcessor.java:108)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 01:37:35,016 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-21 01:37:35,018 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.r.RecordsValidatorProcessor -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.validate(RecordsValidatorProcessor.java:55)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.isValidImportRecord(RecordsValidatorProcessor.java:45)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.lambda$0(RecordsValidatorProcessor.java:38)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:174)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.RecordsValidatorProcessor.process(RecordsValidatorProcessor.java:40)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 01:37:35,021 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado da Importao. Summary [totalClients=2, totalSellers=2, mostExpensiveSaleId=04, worstPerformanceSellerName=Pedro]
2020-09-21 01:37:35,021 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesExportRoutes -  -  Resultado Total ClientsTotal SellersMost Expensive Sale IdWorst Performance Seller
2204Pedro

2020-09-21 01:37:35,022 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Exportando o arquivo sales.out.csv
2020-09-21 02:49:24,494 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 18692 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-21 02:49:24,499 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-21 02:49:24,500 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-21 02:49:26,323 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-21 02:49:26,340 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-21 02:49:26,341 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-21 02:49:26,341 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-21 02:49:26,442 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-21 02:49:26,442 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1862 ms
2020-09-21 02:49:26,789 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-21 02:49:27,138 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 02:49:27,583 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-21 02:49:27,619 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-21 02:49:27,716 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-21 02:49:27,716 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-21 02:49:27,717 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-21 02:49:28,098 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-21 02:49:28,101 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-21 02:49:28,102 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-21 02:49:28,131 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-21 02:49:28,142 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-21 02:49:28,143 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemWritingId started and consuming from: direct://filesystemWriting
2020-09-21 02:49:28,144 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemWritingErrorsId started and consuming from: direct://filesystemWritingErrors
2020-09-21 02:49:28,144 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: exportReportId started and consuming from: direct://exportReport
2020-09-21 02:49:28,145 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-21 02:49:28,145 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-21 02:49:28,145 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-21 02:49:28,145 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-21 02:49:28,146 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-21 02:49:28,146 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-21 02:49:28,150 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 10 routes, of which 10 are started
2020-09-21 02:49:28,151 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.053 seconds
2020-09-21 02:49:28,158 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.537 seconds (JVM running for 5.43)
2020-09-21 02:49:30,010 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Importando o arquivo sales.csv
2020-09-21 02:49:30,011 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-21 02:49:30,031 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-21 02:49:30,033 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-21 02:49:30,073 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-21 02:49:30,074 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-21 02:49:30,077 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-21 02:49:30,078 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-21 02:49:30,113 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-21 02:49:30,114 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-21 02:49:30,115 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-21 02:49:30,117 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-21 02:49:30,117 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-21 02:49:30,124 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 02:49:30,152 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR o.a.c.p.e.DefaultErrorHandler -  - Failed delivery for (MessageId: ID-unicred-fabio-souza-1600667370016-0-10 on ExchangeId: ID-unicred-fabio-souza-1600667370016-0-10). Exhausted after delivery attempt: 1 caught: java.lang.NullPointerException

Message History (complete message history is disabled)
---------------------------------------------------------------------------------------------------------------------------------------
RouteId              ProcessorId          Processor                                                                        Elapsed (ms)
[filesystemReadingI] [filesystemReadingI] [from[file:///home/fabio/Documents/sales-importer/in?delay=1000&move=%2Fhome%2F] [       146]

Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------

java.lang.NullPointerException: null
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesImportRoutes$1.process(SalesImportRoutes.java:121)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 02:49:30,153 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-21 02:49:30,155 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.r.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.IsValidRecordPredicate.matches(IsValidRecordPredicate.java:24)
	at org.apache.camel.support.builder.PredicateBuilder$1.matches(PredicateBuilder.java:51)
	at org.apache.camel.processor.FilterProcessor.matches(FilterProcessor.java:77)
	at org.apache.camel.processor.ChoiceProcessor.process(ChoiceProcessor.java:80)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 02:49:30,157 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.NullPointerException - java.lang.NullPointerException
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesImportRoutes$1.process(SalesImportRoutes.java:121)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.ChoiceProcessor.process(ChoiceProcessor.java:96)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 02:49:30,178 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR o.a.c.p.e.DefaultErrorHandler -  - Failed delivery for (MessageId: ID-unicred-fabio-souza-1600667370016-0-11 on ExchangeId: ID-unicred-fabio-souza-1600667370016-0-11). Exhausted after delivery attempt: 1 caught: java.lang.NullPointerException

Message History (complete message history is disabled)
---------------------------------------------------------------------------------------------------------------------------------------
RouteId              ProcessorId          Processor                                                                        Elapsed (ms)
[filesystemReadingI] [filesystemReadingI] [from[file:///home/fabio/Documents/sales-importer/in?delay=1000&move=%2Fhome%2F] [       175]

Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------

java.lang.NullPointerException: null
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesImportRoutes$1.process(SalesImportRoutes.java:121)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 02:49:30,199 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR o.a.c.p.e.DefaultErrorHandler -  - Failed delivery for (MessageId: ID-unicred-fabio-souza-1600667370016-0-12 on ExchangeId: ID-unicred-fabio-souza-1600667370016-0-1). Exhausted after delivery attempt: 1 caught: com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40

Message History (complete message history is disabled)
---------------------------------------------------------------------------------------------------------------------------------------
RouteId              ProcessorId          Processor                                                                        Elapsed (ms)
[filesystemReadingI] [filesystemReadingI] [from[file:///home/fabio/Documents/sales-importer/in?delay=1000&move=%2Fhome%2F] [       196]
	...
[direct:transform  ] [process8          ] [Processor@0x22a4ca4a                                                          ] [         0]

Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------

com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesSumarizer.parseSaleItems(SalesSumarizer.java:76)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesSumarizer.totalSale(SalesSumarizer.java:80)
	at java.util.Comparator.lambda$comparing$77a9974f$1(Comparator.java:469)
	at java.util.function.BinaryOperator.lambda$maxBy$1(BinaryOperator.java:74)
	at java.util.stream.ReduceOps$2ReducingSink.accept(ReduceOps.java:123)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.reduce(ReferencePipeline.java:546)
	at java.util.stream.ReferencePipeline.max(ReferencePipeline.java:582)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesSumarizer.findMostExpensiveSaleId(SalesSumarizer.java:44)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesSumarizer.sum(SalesSumarizer.java:36)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.TransformerProcessor.process(TransformerProcessor.java:38)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 02:49:30,200 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] WARN  o.a.c.c.f.GenericFileOnCompletion -  - Rollback file strategy: org.apache.camel.component.file.strategy.GenericFileRenameProcessStrategy@6d406d11 for file: GenericFile[/home/fabio/Documents/sales-importer/in/sales.csv]
2020-09-21 02:50:30,003 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Importando o arquivo sales.csv
2020-09-21 02:50:30,004 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-21 02:50:30,008 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-21 02:50:30,009 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-21 02:50:30,012 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-21 02:50:30,014 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-21 02:50:30,017 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-21 02:50:30,020 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-21 02:50:30,024 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-21 02:50:30,029 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-21 02:50:30,032 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-21 02:50:30,034 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-21 02:50:30,035 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-21 02:50:30,037 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 02:52:29,150 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 19202 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-21 02:52:29,154 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-21 02:52:29,154 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-21 02:52:31,210 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-21 02:52:31,232 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-21 02:52:31,233 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-21 02:52:31,234 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-21 02:52:31,385 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-21 02:52:31,385 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 2154 ms
2020-09-21 02:52:31,796 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-21 02:52:32,141 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 02:52:32,706 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-21 02:52:32,743 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-21 02:52:32,850 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-21 02:52:32,851 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-21 02:52:32,851 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-21 02:52:33,219 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-21 02:52:33,220 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-21 02:52:33,220 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-21 02:52:33,245 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-21 02:52:33,254 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-21 02:52:33,255 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemWritingId started and consuming from: direct://filesystemWriting
2020-09-21 02:52:33,255 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemWritingErrorsId started and consuming from: direct://filesystemWritingErrors
2020-09-21 02:52:33,256 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: exportReportId started and consuming from: direct://exportReport
2020-09-21 02:52:33,256 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-21 02:52:33,256 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-21 02:52:33,256 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-21 02:52:33,256 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-21 02:52:33,257 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-21 02:52:33,257 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-21 02:52:33,260 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 10 routes, of which 10 are started
2020-09-21 02:52:33,260 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.041 seconds
2020-09-21 02:52:33,266 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.927 seconds (JVM running for 5.84)
2020-09-21 02:52:35,022 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Importando o arquivo sales.csv
2020-09-21 02:52:35,024 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-21 02:52:35,047 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-21 02:52:35,049 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-21 02:52:35,081 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-21 02:52:35,082 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-21 02:52:35,083 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-21 02:52:35,084 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-21 02:52:35,112 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-21 02:52:35,114 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-21 02:52:35,115 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-21 02:52:35,115 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-21 02:52:35,116 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-21 02:52:35,120 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 02:52:35,122 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-21 02:52:35,127 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.r.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.IsValidRecordPredicate.matches(IsValidRecordPredicate.java:24)
	at org.apache.camel.support.builder.PredicateBuilder$1.matches(PredicateBuilder.java:51)
	at org.apache.camel.processor.FilterProcessor.matches(FilterProcessor.java:77)
	at org.apache.camel.processor.ChoiceProcessor.process(ChoiceProcessor.java:80)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 02:52:35,152 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR o.a.c.p.e.DefaultErrorHandler -  - Failed delivery for (MessageId: ID-unicred-fabio-souza-1600667555034-0-12 on ExchangeId: ID-unicred-fabio-souza-1600667555034-0-1). Exhausted after delivery attempt: 1 caught: com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40

Message History (complete message history is disabled)
---------------------------------------------------------------------------------------------------------------------------------------
RouteId              ProcessorId          Processor                                                                        Elapsed (ms)
[filesystemReadingI] [filesystemReadingI] [from[file:///home/fabio/Documents/sales-importer/in?delay=1000&move=%2Fhome%2F] [       148]
	...
[direct:transform  ] [process8          ] [Processor@0x6af87130                                                          ] [         0]

Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------

com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesSumarizer.parseSaleItems(SalesSumarizer.java:76)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesSumarizer.totalSale(SalesSumarizer.java:80)
	at java.util.Comparator.lambda$comparing$77a9974f$1(Comparator.java:469)
	at java.util.function.BinaryOperator.lambda$maxBy$1(BinaryOperator.java:74)
	at java.util.stream.ReduceOps$2ReducingSink.accept(ReduceOps.java:123)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.reduce(ReferencePipeline.java:546)
	at java.util.stream.ReferencePipeline.max(ReferencePipeline.java:582)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesSumarizer.findMostExpensiveSaleId(SalesSumarizer.java:44)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesSumarizer.sum(SalesSumarizer.java:36)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.TransformerProcessor.process(TransformerProcessor.java:38)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 02:52:35,153 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] WARN  o.a.c.c.f.GenericFileOnCompletion -  - Rollback file strategy: org.apache.camel.component.file.strategy.GenericFileRenameProcessStrategy@488b94b5 for file: GenericFile[/home/fabio/Documents/sales-importer/in/sales.csv]
2020-09-21 02:53:10,002 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Importando o arquivo sales.csv
2020-09-21 02:53:10,003 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-21 02:53:10,007 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-21 02:53:10,008 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-21 02:53:10,011 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-21 02:53:10,013 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-21 02:53:10,015 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-21 02:53:10,016 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-21 02:53:10,018 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-21 02:53:10,019 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-21 02:53:10,020 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-21 02:53:10,021 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-21 02:53:10,022 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-21 02:53:10,023 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 02:53:28,733 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-21 02:53:28,735 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.r.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.IsValidRecordPredicate.matches(IsValidRecordPredicate.java:24)
	at org.apache.camel.support.builder.PredicateBuilder$1.matches(PredicateBuilder.java:51)
	at org.apache.camel.processor.FilterProcessor.matches(FilterProcessor.java:77)
	at org.apache.camel.processor.ChoiceProcessor.process(ChoiceProcessor.java:80)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 02:53:37,146 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR o.a.c.p.e.DefaultErrorHandler -  - Failed delivery for (MessageId: ID-unicred-fabio-souza-1600667555034-0-24 on ExchangeId: ID-unicred-fabio-souza-1600667555034-0-13). Exhausted after delivery attempt: 1 caught: com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40

Message History (complete message history is disabled)
---------------------------------------------------------------------------------------------------------------------------------------
RouteId              ProcessorId          Processor                                                                        Elapsed (ms)
[filesystemReadingI] [filesystemReadingI] [from[file:///home/fabio/Documents/sales-importer/in?delay=1000&move=%2Fhome%2F] [     27144]
	...
[direct:transform  ] [process8          ] [Processor@0x6af87130                                                          ] [         0]

Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------

com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesSumarizer.parseSaleItems(SalesSumarizer.java:76)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesSumarizer.totalSale(SalesSumarizer.java:80)
	at java.util.Comparator.lambda$comparing$77a9974f$1(Comparator.java:469)
	at java.util.function.BinaryOperator.lambda$maxBy$1(BinaryOperator.java:74)
	at java.util.stream.ReduceOps$2ReducingSink.accept(ReduceOps.java:123)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.reduce(ReferencePipeline.java:546)
	at java.util.stream.ReferencePipeline.max(ReferencePipeline.java:582)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesSumarizer.findMostExpensiveSaleId(SalesSumarizer.java:44)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesSumarizer.sum(SalesSumarizer.java:36)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.TransformerProcessor.process(TransformerProcessor.java:38)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 02:53:37,147 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] WARN  o.a.c.c.f.GenericFileOnCompletion -  - Rollback file strategy: org.apache.camel.component.file.strategy.GenericFileRenameProcessStrategy@488b94b5 for file: GenericFile[/home/fabio/Documents/sales-importer/in/sales.csv]
2020-09-21 02:54:05,002 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Importando o arquivo sales.csv
2020-09-21 02:54:05,003 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-21 02:54:05,007 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-21 02:54:05,009 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-21 02:54:05,012 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-21 02:54:05,014 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-21 02:54:05,017 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-21 02:54:05,019 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-21 02:54:05,021 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-21 02:54:05,024 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-21 02:54:05,027 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-21 02:54:05,029 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-21 02:54:05,029 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-21 02:54:05,032 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 02:54:28,887 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-21 02:54:28,888 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.r.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.IsValidRecordPredicate.matches(IsValidRecordPredicate.java:24)
	at org.apache.camel.support.builder.PredicateBuilder$1.matches(PredicateBuilder.java:51)
	at org.apache.camel.processor.FilterProcessor.matches(FilterProcessor.java:77)
	at org.apache.camel.processor.ChoiceProcessor.process(ChoiceProcessor.java:80)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 02:54:28,892 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR o.a.c.p.e.DefaultErrorHandler -  - Failed delivery for (MessageId: ID-unicred-fabio-souza-1600667555034-0-36 on ExchangeId: ID-unicred-fabio-souza-1600667555034-0-25). Exhausted after delivery attempt: 1 caught: com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40

Message History (complete message history is disabled)
---------------------------------------------------------------------------------------------------------------------------------------
RouteId              ProcessorId          Processor                                                                        Elapsed (ms)
[filesystemReadingI] [filesystemReadingI] [from[file:///home/fabio/Documents/sales-importer/in?delay=1000&move=%2Fhome%2F] [     23891]
	...
[direct:transform  ] [process8          ] [Processor@0x6af87130                                                          ] [         0]

Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------

com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesSumarizer.parseSaleItems(SalesSumarizer.java:76)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesSumarizer.totalSale(SalesSumarizer.java:80)
	at java.util.Comparator.lambda$comparing$77a9974f$1(Comparator.java:469)
	at java.util.function.BinaryOperator.lambda$maxBy$1(BinaryOperator.java:74)
	at java.util.stream.ReduceOps$2ReducingSink.accept(ReduceOps.java:123)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.reduce(ReferencePipeline.java:546)
	at java.util.stream.ReferencePipeline.max(ReferencePipeline.java:582)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesSumarizer.findMostExpensiveSaleId(SalesSumarizer.java:44)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesSumarizer.sum(SalesSumarizer.java:36)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.TransformerProcessor.process(TransformerProcessor.java:38)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 02:54:28,893 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] WARN  o.a.c.c.f.GenericFileOnCompletion -  - Rollback file strategy: org.apache.camel.component.file.strategy.GenericFileRenameProcessStrategy@488b94b5 for file: GenericFile[/home/fabio/Documents/sales-importer/in/sales.csv]
2020-09-21 02:54:55,001 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Importando o arquivo sales.csv
2020-09-21 02:54:55,002 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-21 02:54:55,006 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-21 02:54:55,007 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-21 02:54:55,010 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-21 02:54:55,012 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-21 02:54:55,014 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-21 02:54:55,016 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-21 02:54:55,018 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-21 02:54:55,020 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-21 02:54:55,021 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-21 02:54:55,022 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-21 02:54:55,023 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-21 02:54:55,024 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 02:54:55,027 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-21 02:54:55,028 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.r.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.IsValidRecordPredicate.matches(IsValidRecordPredicate.java:24)
	at org.apache.camel.support.builder.PredicateBuilder$1.matches(PredicateBuilder.java:51)
	at org.apache.camel.processor.FilterProcessor.matches(FilterProcessor.java:77)
	at org.apache.camel.processor.ChoiceProcessor.process(ChoiceProcessor.java:80)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 02:54:55,034 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR o.a.c.p.e.DefaultErrorHandler -  - Failed delivery for (MessageId: ID-unicred-fabio-souza-1600667555034-0-48 on ExchangeId: ID-unicred-fabio-souza-1600667555034-0-37). Exhausted after delivery attempt: 1 caught: com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40

Message History (complete message history is disabled)
---------------------------------------------------------------------------------------------------------------------------------------
RouteId              ProcessorId          Processor                                                                        Elapsed (ms)
[filesystemReadingI] [filesystemReadingI] [from[file:///home/fabio/Documents/sales-importer/in?delay=1000&move=%2Fhome%2F] [        33]
	...
[direct:transform  ] [process8          ] [Processor@0x6af87130                                                          ] [         0]

Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------

com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesSumarizer.parseSaleItems(SalesSumarizer.java:76)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesSumarizer.totalSale(SalesSumarizer.java:80)
	at java.util.Comparator.lambda$comparing$77a9974f$1(Comparator.java:469)
	at java.util.function.BinaryOperator.lambda$maxBy$1(BinaryOperator.java:74)
	at java.util.stream.ReduceOps$2ReducingSink.accept(ReduceOps.java:123)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.reduce(ReferencePipeline.java:546)
	at java.util.stream.ReferencePipeline.max(ReferencePipeline.java:582)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesSumarizer.findMostExpensiveSaleId(SalesSumarizer.java:44)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.SalesSumarizer.sum(SalesSumarizer.java:36)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.TransformerProcessor.process(TransformerProcessor.java:38)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 02:54:55,034 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] WARN  o.a.c.c.f.GenericFileOnCompletion -  - Rollback file strategy: org.apache.camel.component.file.strategy.GenericFileRenameProcessStrategy@488b94b5 for file: GenericFile[/home/fabio/Documents/sales-importer/in/sales.csv]
2020-09-21 03:04:08,567 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 20402 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-21 03:04:08,574 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-21 03:04:08,575 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-21 03:04:11,381 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-21 03:04:11,404 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-21 03:04:11,406 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-21 03:04:11,406 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-21 03:04:11,542 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-21 03:04:11,542 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 2810 ms
2020-09-21 03:04:11,890 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-21 03:04:12,255 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 03:04:12,760 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-21 03:04:12,812 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-21 03:04:12,937 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-21 03:04:12,937 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-21 03:04:12,937 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-21 03:04:13,533 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-21 03:04:13,535 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-21 03:04:13,536 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-21 03:04:13,568 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-21 03:04:13,589 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-21 03:04:13,591 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemWritingId started and consuming from: direct://filesystemWriting
2020-09-21 03:04:13,591 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemWritingErrorsId started and consuming from: direct://filesystemWritingErrors
2020-09-21 03:04:13,592 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: exportReportId started and consuming from: direct://exportReport
2020-09-21 03:04:13,592 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-21 03:04:13,592 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-21 03:04:13,592 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-21 03:04:13,592 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-21 03:04:13,593 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-21 03:04:13,593 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-21 03:04:13,612 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 10 routes, of which 10 are started
2020-09-21 03:04:13,612 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.079 seconds
2020-09-21 03:04:13,618 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 6.378 seconds (JVM running for 8.034)
2020-09-21 03:04:15,016 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Importando o arquivo sales.csv
2020-09-21 03:04:15,016 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-21 03:04:15,037 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-21 03:04:15,038 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-21 03:04:15,072 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-21 03:04:15,073 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-21 03:04:15,075 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-21 03:04:15,076 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-21 03:04:15,102 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-21 03:04:15,103 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-21 03:04:15,104 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-21 03:04:15,105 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-21 03:04:15,106 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-21 03:04:15,110 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 03:08:36,997 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 21484 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-21 03:08:37,002 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-21 03:08:37,003 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-21 03:08:38,905 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-21 03:08:38,929 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-21 03:08:38,930 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-21 03:08:38,931 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-21 03:08:39,082 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-21 03:08:39,082 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1988 ms
2020-09-21 03:08:39,487 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-21 03:08:39,861 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 03:08:40,330 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-21 03:08:40,366 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-21 03:08:40,502 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-21 03:08:40,503 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-21 03:08:40,503 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-21 03:08:41,005 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-21 03:08:41,007 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-21 03:08:41,007 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-21 03:08:41,042 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-21 03:08:41,051 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-21 03:08:41,052 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemWritingId started and consuming from: direct://filesystemWriting
2020-09-21 03:08:41,053 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemWritingErrorsId started and consuming from: direct://filesystemWritingErrors
2020-09-21 03:08:41,053 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: exportReportId started and consuming from: direct://exportReport
2020-09-21 03:08:41,053 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-21 03:08:41,053 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-21 03:08:41,053 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-21 03:08:41,054 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-21 03:08:41,054 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-21 03:08:41,054 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-21 03:08:41,058 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 10 routes, of which 10 are started
2020-09-21 03:08:41,058 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.053 seconds
2020-09-21 03:08:41,063 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.8 seconds (JVM running for 5.719)
2020-09-21 03:08:45,040 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Importando o arquivo sales.csv
2020-09-21 03:08:45,042 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-21 03:08:45,062 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-21 03:08:45,063 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-21 03:08:45,090 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-21 03:08:45,090 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-21 03:08:45,091 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-21 03:08:45,092 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-21 03:08:45,110 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-21 03:08:45,110 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-21 03:08:45,111 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-21 03:08:45,111 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-21 03:08:45,112 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-21 03:08:45,115 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 03:08:45,116 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-21 03:08:45,120 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.r.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.IsValidRecordPredicate.matches(IsValidRecordPredicate.java:24)
	at org.apache.camel.support.builder.PredicateBuilder$1.matches(PredicateBuilder.java:51)
	at org.apache.camel.processor.FilterProcessor.matches(FilterProcessor.java:77)
	at org.apache.camel.processor.ChoiceProcessor.process(ChoiceProcessor.java:80)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 03:08:45,122 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.r.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.TransformerProcessor.lambda$2(TransformerProcessor.java:38)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:174)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.TransformerProcessor.process(TransformerProcessor.java:39)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 03:08:45,130 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado da Importao. Summary [totalClients=2, totalSellers=2, mostExpensiveSaleId=04, worstPerformanceSellerName=Pedro]
2020-09-21 03:08:45,133 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesExportRoutes -  -  Resultado Total ClientsTotal SellersMost Expensive Sale IdWorst Performance Seller
2204Pedro

2020-09-21 03:08:45,133 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Exportando o arquivo sales.out.csv
2020-09-21 03:20:40,126 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 22724 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-21 03:20:40,131 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-21 03:20:40,131 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-21 03:20:41,953 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-21 03:20:41,969 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-21 03:20:41,970 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-21 03:20:41,970 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-21 03:20:42,086 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-21 03:20:42,086 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1873 ms
2020-09-21 03:20:42,404 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-21 03:20:42,683 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 03:20:43,035 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-21 03:20:43,071 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-21 03:20:43,174 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-21 03:20:43,174 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-21 03:20:43,174 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-21 03:20:43,449 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-21 03:20:43,451 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-21 03:20:43,451 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-21 03:20:43,477 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-21 03:20:43,486 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-21 03:20:43,487 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemWritingId started and consuming from: direct://filesystemWriting
2020-09-21 03:20:43,487 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemWritingErrorsId started and consuming from: direct://filesystemWritingErrors
2020-09-21 03:20:43,488 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: exportReportId started and consuming from: direct://exportReport
2020-09-21 03:20:43,488 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: exportErrorsId started and consuming from: direct://exportErrors
2020-09-21 03:20:43,488 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-21 03:20:43,488 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-21 03:20:43,488 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-21 03:20:43,488 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-21 03:20:43,489 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-21 03:20:43,490 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-21 03:20:43,493 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 11 routes, of which 11 are started
2020-09-21 03:20:43,493 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.043 seconds
2020-09-21 03:20:43,498 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.157 seconds (JVM running for 5.055)
2020-09-21 03:20:45,038 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Importando o arquivo sales.csv
2020-09-21 03:20:45,039 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-21 03:20:45,060 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-21 03:20:45,061 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-21 03:20:45,087 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-21 03:20:45,088 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-21 03:20:45,090 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-21 03:20:45,091 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-21 03:20:45,113 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-21 03:20:45,114 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-21 03:20:45,115 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-21 03:20:45,115 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-21 03:20:45,115 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-21 03:20:45,119 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 03:20:45,120 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-21 03:20:45,123 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.r.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.IsValidRecordPredicate.matches(IsValidRecordPredicate.java:24)
	at org.apache.camel.support.builder.PredicateBuilder$1.matches(PredicateBuilder.java:51)
	at org.apache.camel.processor.FilterProcessor.matches(FilterProcessor.java:77)
	at org.apache.camel.processor.ChoiceProcessor.process(ChoiceProcessor.java:80)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 03:20:45,126 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.r.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.TransformerProcessor.lambda$2(TransformerProcessor.java:38)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:174)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.TransformerProcessor.process(TransformerProcessor.java:39)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 03:20:45,134 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado da Importao. Summary [totalClients=2, totalSellers=2, mostExpensiveSaleId=04, worstPerformanceSellerName=Pedro]
2020-09-21 03:20:45,136 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesExportRoutes -  -  Resultado Total ClientsTotal SellersMost Expensive Sale IdWorst Performance Seller
2204Pedro

2020-09-21 03:20:45,136 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Exportando o arquivo sales.out.csv
2020-09-21 03:24:24,363 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 23066 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-21 03:24:24,370 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-21 03:24:24,371 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-21 03:24:26,265 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-21 03:24:26,290 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-21 03:24:26,291 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-21 03:24:26,292 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-21 03:24:26,434 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-21 03:24:26,434 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1953 ms
2020-09-21 03:24:26,797 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-21 03:24:27,105 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 03:24:27,488 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-21 03:24:27,516 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-21 03:24:27,615 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-21 03:24:27,615 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-21 03:24:27,616 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-21 03:24:27,994 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-21 03:24:27,996 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-21 03:24:27,997 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-21 03:24:28,026 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-21 03:24:28,036 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-21 03:24:28,038 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemWritingId started and consuming from: direct://filesystemWriting
2020-09-21 03:24:28,038 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemWritingErrorsId started and consuming from: direct://filesystemWritingErrors
2020-09-21 03:24:28,039 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: exportReportId started and consuming from: direct://exportReport
2020-09-21 03:24:28,039 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: exportErrorsId started and consuming from: direct://exportErrors
2020-09-21 03:24:28,039 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-21 03:24:28,040 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-21 03:24:28,040 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-21 03:24:28,040 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-21 03:24:28,040 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-21 03:24:28,041 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-21 03:24:28,045 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 11 routes, of which 11 are started
2020-09-21 03:24:28,046 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.051 seconds
2020-09-21 03:24:28,054 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.579 seconds (JVM running for 5.464)
2020-09-21 03:24:50,016 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Importando o arquivo sales.csv
2020-09-21 03:24:50,017 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-21 03:24:50,036 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-21 03:24:50,038 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-21 03:24:50,065 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-21 03:24:50,066 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-21 03:24:50,067 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-21 03:24:50,068 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-21 03:24:50,090 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-21 03:24:50,091 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-21 03:24:50,092 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-21 03:24:50,092 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-21 03:24:50,092 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-21 03:24:50,096 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 03:24:50,097 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-21 03:24:50,101 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.r.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.IsValidRecordPredicate.matches(IsValidRecordPredicate.java:24)
	at org.apache.camel.support.builder.PredicateBuilder$1.matches(PredicateBuilder.java:51)
	at org.apache.camel.processor.FilterProcessor.matches(FilterProcessor.java:77)
	at org.apache.camel.processor.ChoiceProcessor.process(ChoiceProcessor.java:80)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 03:24:50,104 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.r.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.record.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parseRecord(SaleItemsParser.java:33)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.record.SaleItemsParser.parse(SaleItemsParser.java:26)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.TransformerProcessor.lambda$2(TransformerProcessor.java:38)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:174)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.routes.TransformerProcessor.process(TransformerProcessor.java:39)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 03:24:50,115 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado da Importao. Summary [totalClients=2, totalSellers=2, mostExpensiveSaleId=04, worstPerformanceSellerName=Pedro]
2020-09-21 03:24:50,118 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesExportRoutes -  -  Resultado Total ClientsTotal SellersMost Expensive Sale IdWorst Performance Seller
2204Pedro

2020-09-21 03:24:50,118 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Exportando o arquivo sales.out.csv
2020-09-21 03:24:50,121 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesExportRoutes -  -  Erros 
2020-09-21 03:24:50,121 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Exportando o arquivo sales.out.out.errors.csv
2020-09-21 03:24:50,126 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR o.a.c.p.e.DefaultErrorHandler -  - Failed delivery for (MessageId: ID-unicred-fabio-souza-1600669490024-0-12 on ExchangeId: ID-unicred-fabio-souza-1600669490024-0-1). Exhausted after delivery attempt: 1 caught: org.apache.camel.component.file.GenericFileOperationFailedException: Cannot store file: /home/fabio/Documents/sales-importer/out/sales.out.out.errors.csv

Message History (complete message history is disabled)
---------------------------------------------------------------------------------------------------------------------------------------
RouteId              ProcessorId          Processor                                                                        Elapsed (ms)
[filesystemReadingI] [filesystemReadingI] [from[file:///home/fabio/Documents/sales-importer/in?delay=1000&move=%2Fhome%2F] [       123]
	...
[filesystemWritingI] [to2               ] [file:///home/fabio/Documents/sales-importer/out?fileExist=Override            ] [         0]

Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------

org.apache.camel.component.file.GenericFileOperationFailedException: Cannot store file: /home/fabio/Documents/sales-importer/out/sales.out.out.errors.csv
	at org.apache.camel.component.file.FileOperations.storeFile(FileOperations.java:399)
	at org.apache.camel.component.file.GenericFileProducer.writeFile(GenericFileProducer.java:318)
	at org.apache.camel.component.file.GenericFileProducer.processExchange(GenericFileProducer.java:173)
	at org.apache.camel.component.file.GenericFileProducer.process(GenericFileProducer.java:78)
	at org.apache.camel.support.AsyncProcessorConverterHelper$ProcessorToAsyncProcessorBridge.process(AsyncProcessorConverterHelper.java:66)
	at org.apache.camel.processor.SendProcessor.process(SendProcessor.java:169)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.camel.InvalidPayloadException: No body available of type: java.io.InputStream but has value: [] of type: java.util.ArrayList on: sales.csv. Caused by: No type converter available to convert from type: java.util.ArrayList to the required type: java.io.InputStream with value []. Exchange[ID-unicred-fabio-souza-1600669490024-0-1]. Caused by: [org.apache.camel.NoTypeConversionAvailableException - No type converter available to convert from type: java.util.ArrayList to the required type: java.io.InputStream with value []]
	at org.apache.camel.support.MessageSupport.getMandatoryBody(MessageSupport.java:117)
	at org.apache.camel.component.file.FileOperations.storeFile(FileOperations.java:378)
	... 24 common frames omitted
Caused by: org.apache.camel.NoTypeConversionAvailableException: No type converter available to convert from type: java.util.ArrayList to the required type: java.io.InputStream with value []
	at org.apache.camel.impl.converter.CoreTypeConverterRegistry.mandatoryConvertTo(CoreTypeConverterRegistry.java:220)
	at org.apache.camel.support.MessageSupport.getMandatoryBody(MessageSupport.java:115)
	... 25 common frames omitted
2020-09-21 03:24:50,127 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] WARN  o.a.c.c.f.GenericFileOnCompletion -  - Rollback file strategy: org.apache.camel.component.file.strategy.GenericFileRenameProcessStrategy@3596e6b4 for file: GenericFile[/home/fabio/Documents/sales-importer/in/sales.csv]
2020-09-21 03:45:38,930 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 25621 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-21 03:45:38,935 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-21 03:45:38,935 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-21 03:45:40,520 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-21 03:45:40,538 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-21 03:45:40,539 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-21 03:45:40,539 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-21 03:45:40,660 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-21 03:45:40,661 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1650 ms
2020-09-21 03:45:41,034 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-21 03:45:41,301 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 03:45:41,659 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-21 03:45:41,691 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-21 03:45:41,802 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-21 03:45:41,803 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-21 03:45:41,803 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-21 03:45:42,127 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-21 03:45:42,129 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-21 03:45:42,129 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-21 03:45:42,155 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-21 03:45:42,165 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-21 03:45:42,166 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemWritingId started and consuming from: direct://filesystemWriting
2020-09-21 03:45:42,167 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemWritingErrorsId started and consuming from: direct://filesystemWritingErrors
2020-09-21 03:45:42,167 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: exportReportId started and consuming from: direct://exportReport
2020-09-21 03:45:42,167 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: exportErrorsId started and consuming from: direct://exportErrors
2020-09-21 03:45:42,167 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-21 03:45:42,167 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-21 03:45:42,168 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-21 03:45:42,168 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-21 03:45:42,168 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-21 03:45:42,169 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-21 03:45:42,173 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 11 routes, of which 11 are started
2020-09-21 03:45:42,173 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.046 seconds
2020-09-21 03:45:42,179 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 3.911 seconds (JVM running for 4.796)
2020-09-21 03:46:05,034 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Importando o arquivo sales.csv
2020-09-21 03:46:05,036 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-21 03:46:05,057 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-21 03:46:05,059 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-21 03:46:05,094 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-21 03:46:05,095 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-21 03:46:05,097 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-21 03:46:05,098 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-21 03:46:05,129 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-21 03:46:05,130 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-21 03:46:05,131 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-21 03:46:05,132 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-21 03:46:05,133 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-21 03:46:05,137 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 03:46:05,139 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-21 03:46:05,144 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.v.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.exception.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parseRecord(SaleItemsParser.java:35)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parse(SaleItemsParser.java:28)
	at com.github.fabiosoaza.salesimporter.infrastructure.validator.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.infrastructure.predicate.IsValidRecordPredicate.matches(IsValidRecordPredicate.java:25)
	at org.apache.camel.support.builder.PredicateBuilder$1.matches(PredicateBuilder.java:51)
	at org.apache.camel.processor.FilterProcessor.matches(FilterProcessor.java:77)
	at org.apache.camel.processor.ChoiceProcessor.process(ChoiceProcessor.java:80)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 03:46:05,147 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.v.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.exception.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parseRecord(SaleItemsParser.java:35)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parse(SaleItemsParser.java:28)
	at com.github.fabiosoaza.salesimporter.infrastructure.validator.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.infrastructure.processor.TransformerProcessor.lambda$2(TransformerProcessor.java:40)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:174)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.processor.TransformerProcessor.process(TransformerProcessor.java:41)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 03:46:05,159 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado da Importao. Summary [totalClients=2, totalSellers=2, mostExpensiveSaleId=04, worstPerformanceSellerName=Pedro]
2020-09-21 03:46:05,161 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesExportRoutes -  -  Resultado Total ClientsTotal SellersMost Expensive Sale IdWorst Performance Seller
2204Pedro

2020-09-21 03:46:05,161 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Exportando o arquivo sales.out.csv
2020-09-21 03:46:05,164 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesExportRoutes -  - Importao no contm erros.
2020-09-21 03:47:55,003 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Importando o arquivo sales.csv
2020-09-21 03:47:55,004 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-21 03:47:55,009 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-21 03:47:55,010 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-21 03:47:55,012 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-21 03:47:55,014 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-21 03:47:55,016 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-21 03:47:55,019 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-21 03:47:55,021 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-21 03:47:55,024 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-21 03:47:55,026 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-21 03:47:55,028 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-21 03:47:55,029 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-21 03:47:55,031 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 03:48:13,293 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-21 03:48:13,296 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.v.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.exception.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parseRecord(SaleItemsParser.java:35)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parse(SaleItemsParser.java:28)
	at com.github.fabiosoaza.salesimporter.infrastructure.validator.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.infrastructure.predicate.IsValidRecordPredicate.matches(IsValidRecordPredicate.java:25)
	at org.apache.camel.support.builder.PredicateBuilder$1.matches(PredicateBuilder.java:51)
	at org.apache.camel.processor.FilterProcessor.matches(FilterProcessor.java:77)
	at org.apache.camel.processor.ChoiceProcessor.process(ChoiceProcessor.java:80)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 03:48:13,299 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.v.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.exception.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parseRecord(SaleItemsParser.java:35)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parse(SaleItemsParser.java:28)
	at com.github.fabiosoaza.salesimporter.infrastructure.validator.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.infrastructure.processor.TransformerProcessor.lambda$2(TransformerProcessor.java:40)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:174)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.processor.TransformerProcessor.process(TransformerProcessor.java:41)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 03:48:13,304 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado da Importao. Summary [totalClients=2, totalSellers=2, mostExpensiveSaleId=04, worstPerformanceSellerName=Pedro]
2020-09-21 03:48:13,305 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesExportRoutes -  -  Resultado Total ClientsTotal SellersMost Expensive Sale IdWorst Performance Seller
2204Pedro

2020-09-21 03:48:13,305 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Exportando o arquivo sales.out.csv
2020-09-21 03:48:50,063 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesExportRoutes -  - Importao no contm erros.
2020-09-21 03:51:26,904 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 26313 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-21 03:51:26,911 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-21 03:51:26,911 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-21 03:51:28,607 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-21 03:51:28,626 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-21 03:51:28,627 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-21 03:51:28,627 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-21 03:51:28,744 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-21 03:51:28,744 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1772 ms
2020-09-21 03:51:29,079 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-21 03:51:29,369 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 03:51:29,795 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-21 03:51:29,828 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-21 03:51:29,932 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-21 03:51:29,933 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-21 03:51:29,933 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-21 03:51:30,187 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-21 03:51:30,188 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-21 03:51:30,189 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-21 03:51:30,209 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-21 03:51:30,215 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-21 03:51:30,216 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemWritingId started and consuming from: direct://filesystemWriting
2020-09-21 03:51:30,216 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemWritingErrorsId started and consuming from: direct://filesystemWritingErrors
2020-09-21 03:51:30,216 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: exportReportId started and consuming from: direct://exportReport
2020-09-21 03:51:30,216 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: exportErrorsId started and consuming from: direct://exportErrors
2020-09-21 03:51:30,216 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-21 03:51:30,216 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-21 03:51:30,216 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-21 03:51:30,217 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-21 03:51:30,217 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-21 03:51:30,217 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-21 03:51:30,220 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 11 routes, of which 11 are started
2020-09-21 03:51:30,220 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.033 seconds
2020-09-21 03:51:30,226 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 3.997 seconds (JVM running for 4.915)
2020-09-21 03:51:50,019 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Importando o arquivo sales.csv
2020-09-21 03:51:50,020 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-21 03:51:50,040 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-21 03:51:50,041 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-21 03:51:50,075 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-21 03:51:50,077 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-21 03:51:50,079 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-21 03:51:50,080 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-21 03:51:50,103 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-21 03:51:50,104 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-21 03:51:50,105 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-21 03:51:50,106 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-21 03:51:50,106 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-21 03:51:50,111 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 03:51:50,112 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-21 03:51:50,115 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.v.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.exception.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parseRecord(SaleItemsParser.java:35)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parse(SaleItemsParser.java:28)
	at com.github.fabiosoaza.salesimporter.infrastructure.validator.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.infrastructure.predicate.IsValidRecordPredicate.matches(IsValidRecordPredicate.java:25)
	at org.apache.camel.support.builder.PredicateBuilder$1.matches(PredicateBuilder.java:51)
	at org.apache.camel.processor.FilterProcessor.matches(FilterProcessor.java:77)
	at org.apache.camel.processor.ChoiceProcessor.process(ChoiceProcessor.java:80)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 03:51:50,138 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR o.a.c.p.e.DefaultErrorHandler -  - Failed delivery for (MessageId: ID-unicred-fabio-souza-1600671110027-0-12 on ExchangeId: ID-unicred-fabio-souza-1600671110027-0-1). Exhausted after delivery attempt: 1 caught: java.util.NoSuchElementException: No value present

Message History (complete message history is disabled)
---------------------------------------------------------------------------------------------------------------------------------------
RouteId              ProcessorId          Processor                                                                        Elapsed (ms)
[filesystemReadingI] [filesystemReadingI] [from[file:///home/fabio/Documents/sales-importer/in?delay=1000&move=%2Fhome%2F] [       135]
	...
[direct:transform  ] [process10         ] [Processor@0x6ce26986                                                          ] [         0]

Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------

java.util.NoSuchElementException: No value present
	at java.util.Optional.get(Optional.java:135)
	at com.github.fabiosoaza.salesimporter.infrastructure.components.SalesSumarizer.findWorstPerformanceSeller(SalesSumarizer.java:71)
	at com.github.fabiosoaza.salesimporter.infrastructure.components.SalesSumarizer.sum(SalesSumarizer.java:37)
	at com.github.fabiosoaza.salesimporter.infrastructure.processor.TransformerProcessor.process(TransformerProcessor.java:42)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 03:51:50,139 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] WARN  o.a.c.c.f.GenericFileOnCompletion -  - Rollback file strategy: org.apache.camel.component.file.strategy.GenericFileRenameProcessStrategy@508699a4 for file: GenericFile[/home/fabio/Documents/sales-importer/in/sales.csv]
2020-09-21 04:07:37,931 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 28019 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-21 04:07:37,936 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-21 04:07:37,937 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-21 04:07:39,607 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-21 04:07:39,628 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-21 04:07:39,629 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-21 04:07:39,629 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-21 04:07:39,763 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-21 04:07:39,763 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1755 ms
2020-09-21 04:07:40,142 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-21 04:07:40,464 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 04:07:40,906 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-21 04:07:40,957 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-21 04:07:41,086 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-21 04:07:41,088 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-21 04:07:41,089 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-21 04:07:41,437 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-21 04:07:41,439 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-21 04:07:41,439 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-21 04:07:41,464 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-21 04:07:41,472 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-21 04:07:41,473 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemWritingId started and consuming from: direct://filesystemWriting
2020-09-21 04:07:41,474 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemWritingErrorsId started and consuming from: direct://filesystemWritingErrors
2020-09-21 04:07:41,474 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: exportReportId started and consuming from: direct://exportReport
2020-09-21 04:07:41,474 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: exportErrorsId started and consuming from: direct://exportErrors
2020-09-21 04:07:41,474 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-21 04:07:41,475 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-21 04:07:41,475 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-21 04:07:41,475 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-21 04:07:41,475 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-21 04:07:41,476 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-21 04:07:41,480 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 11 routes, of which 11 are started
2020-09-21 04:07:41,480 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.043 seconds
2020-09-21 04:07:41,486 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.263 seconds (JVM running for 5.164)
2020-09-21 04:07:45,015 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Importando o arquivo sales.csv
2020-09-21 04:07:45,016 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-21 04:07:45,032 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-21 04:07:45,034 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-21 04:07:45,062 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-21 04:07:45,063 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-21 04:07:45,065 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-21 04:07:45,066 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-21 04:07:45,096 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-21 04:07:45,098 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-21 04:07:45,099 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-21 04:07:45,100 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-21 04:07:45,100 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-21 04:07:45,107 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 04:07:45,108 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-21 04:07:45,112 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.v.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.exception.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parseRecord(SaleItemsParser.java:35)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parse(SaleItemsParser.java:28)
	at com.github.fabiosoaza.salesimporter.infrastructure.validator.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.infrastructure.predicate.IsValidRecordPredicate.matches(IsValidRecordPredicate.java:25)
	at org.apache.camel.support.builder.PredicateBuilder$1.matches(PredicateBuilder.java:51)
	at org.apache.camel.processor.FilterProcessor.matches(FilterProcessor.java:77)
	at org.apache.camel.processor.ChoiceProcessor.process(ChoiceProcessor.java:80)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 04:07:45,115 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.v.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.exception.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parseRecord(SaleItemsParser.java:35)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parse(SaleItemsParser.java:28)
	at com.github.fabiosoaza.salesimporter.infrastructure.validator.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.infrastructure.processor.TransformerProcessor.lambda$2(TransformerProcessor.java:40)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:174)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.processor.TransformerProcessor.process(TransformerProcessor.java:41)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 04:07:45,128 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado da Importao. Summary [totalClients=2, totalSellers=2, mostExpensiveSaleId=04, worstPerformanceSellerName=Pedro]
2020-09-21 04:07:45,131 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesExportRoutes -  -  Resultado Total ClientsTotal SellersMost Expensive Sale IdWorst Performance Seller
2204Pedro

2020-09-21 04:07:45,131 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Exportando o arquivo sales.out.csv
2020-09-21 04:07:45,134 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesExportRoutes -  - Importao contm erros gerando o arquivo com os detalhes.
2020-09-21 04:07:45,134 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesExportRoutes -  -  Erros Error parsing line 11
Error parsing line 12
2020-09-21 04:07:45,134 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Exportando o arquivo sales.out.out.errors.csv
2020-09-21 04:10:59,324 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 28333 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-21 04:10:59,330 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-21 04:10:59,331 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-21 04:11:01,102 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-21 04:11:01,119 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-21 04:11:01,120 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-21 04:11:01,120 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-21 04:11:01,227 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-21 04:11:01,227 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1805 ms
2020-09-21 04:11:01,532 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-21 04:11:01,808 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 04:11:02,181 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-21 04:11:02,215 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-21 04:11:02,338 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-21 04:11:02,339 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-21 04:11:02,339 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-21 04:11:02,673 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-21 04:11:02,675 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-21 04:11:02,675 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-21 04:11:02,703 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-21 04:11:02,713 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-21 04:11:02,715 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemWritingId started and consuming from: direct://filesystemWriting
2020-09-21 04:11:02,716 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemWritingErrorsId started and consuming from: direct://filesystemWritingErrors
2020-09-21 04:11:02,716 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: exportReportId started and consuming from: direct://exportReport
2020-09-21 04:11:02,716 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: exportErrorsId started and consuming from: direct://exportErrors
2020-09-21 04:11:02,716 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-21 04:11:02,716 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-21 04:11:02,716 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-21 04:11:02,717 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-21 04:11:02,717 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-21 04:11:02,717 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-21 04:11:02,725 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 11 routes, of which 11 are started
2020-09-21 04:11:02,726 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.053 seconds
2020-09-21 04:11:02,732 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 4.205 seconds (JVM running for 5.197)
2020-09-21 04:11:30,014 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Importando o arquivo sales.csv
2020-09-21 04:11:30,015 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-21 04:11:30,035 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-21 04:11:30,037 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-21 04:11:30,077 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-21 04:11:30,078 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-21 04:11:30,081 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-21 04:11:30,082 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-21 04:11:30,107 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-21 04:11:30,108 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-21 04:11:30,109 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-21 04:11:30,110 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-21 04:11:30,110 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-21 04:11:30,115 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 04:11:30,116 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-21 04:11:30,120 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.v.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.exception.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parseRecord(SaleItemsParser.java:35)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parse(SaleItemsParser.java:28)
	at com.github.fabiosoaza.salesimporter.infrastructure.validator.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.infrastructure.predicate.IsValidRecordPredicate.matches(IsValidRecordPredicate.java:25)
	at org.apache.camel.support.builder.PredicateBuilder$1.matches(PredicateBuilder.java:51)
	at org.apache.camel.processor.FilterProcessor.matches(FilterProcessor.java:77)
	at org.apache.camel.processor.ChoiceProcessor.process(ChoiceProcessor.java:80)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 04:11:30,122 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.v.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.exception.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parseRecord(SaleItemsParser.java:35)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parse(SaleItemsParser.java:28)
	at com.github.fabiosoaza.salesimporter.infrastructure.validator.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.infrastructure.processor.TransformerProcessor.lambda$2(TransformerProcessor.java:40)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:174)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.processor.TransformerProcessor.process(TransformerProcessor.java:41)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 04:11:30,133 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado da Importao. Summary [totalClients=2, totalSellers=2, mostExpensiveSaleId=04, worstPerformanceSellerName=Pedro]
2020-09-21 04:11:30,135 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesExportRoutes -  -  Resultado Total ClientsTotal SellersMost Expensive Sale IdWorst Performance Seller
2204Pedro

2020-09-21 04:11:30,136 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Exportando o arquivo sales.out.csv
2020-09-21 04:11:30,138 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesExportRoutes -  - Importao contm erros gerando o arquivo com os detalhes.
2020-09-21 04:11:30,138 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesExportRoutes -  -  Erros Error parsing line 11
Error parsing line 12
2020-09-21 04:11:30,138 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Exportando o arquivo com os erros da importao sales.out.errors.csv
2020-09-21 04:21:42,791 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 29431 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-21 04:21:42,798 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-21 04:21:42,798 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-21 04:21:44,605 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-21 04:21:44,628 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-21 04:21:44,629 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-21 04:21:44,630 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-21 04:21:44,766 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-21 04:21:44,766 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1877 ms
2020-09-21 04:21:44,852 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext -  - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'fileSystemConfigs' defined in file [/opt/projects/source/sales-importer/bin/main/com/github/fabiosoaza/salesimporter/infrastructure/configuration/FileSystemConfigs.class]: Unexpected exception during bean creation; nested exception is java.lang.IllegalArgumentException: Could not resolve placeholder 'homePath' in value "${homePath}in"
2020-09-21 04:21:44,856 [main] INFO  o.a.catalina.core.StandardService -  - Stopping service [Tomcat]
2020-09-21 04:21:44,872 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLoggingListener -  - 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2020-09-21 04:21:44,878 [main] ERROR o.s.boot.SpringApplication -  - Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'fileSystemConfigs' defined in file [/opt/projects/source/sales-importer/bin/main/com/github/fabiosoaza/salesimporter/infrastructure/configuration/FileSystemConfigs.class]: Unexpected exception during bean creation; nested exception is java.lang.IllegalArgumentException: Could not resolve placeholder 'homePath' in value "${homePath}in"
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:324)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:322)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:897)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:879)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:551)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:143)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:758)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:750)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:397)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:315)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1237)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1226)
	at com.github.fabiosoaza.salesimporter.application.SalesImporterApplication.main(SalesImporterApplication.java:12)
Caused by: java.lang.IllegalArgumentException: Could not resolve placeholder 'homePath' in value "${homePath}in"
	at org.springframework.util.PropertyPlaceholderHelper.parseStringValue(PropertyPlaceholderHelper.java:178)
	at org.springframework.util.PropertyPlaceholderHelper.parseStringValue(PropertyPlaceholderHelper.java:166)
	at org.springframework.util.PropertyPlaceholderHelper.replacePlaceholders(PropertyPlaceholderHelper.java:124)
	at org.springframework.core.env.AbstractPropertyResolver.doResolvePlaceholders(AbstractPropertyResolver.java:239)
	at org.springframework.core.env.AbstractPropertyResolver.resolveRequiredPlaceholders(AbstractPropertyResolver.java:210)
	at org.springframework.core.env.AbstractPropertyResolver.resolveNestedPlaceholders(AbstractPropertyResolver.java:230)
	at org.springframework.core.env.PropertySourcesPropertyResolver.getProperty(PropertySourcesPropertyResolver.java:88)
	at org.springframework.core.env.PropertySourcesPropertyResolver.getProperty(PropertySourcesPropertyResolver.java:62)
	at org.springframework.core.env.AbstractEnvironment.getProperty(AbstractEnvironment.java:535)
	at org.springframework.context.support.PropertySourcesPlaceholderConfigurer$1.getProperty(PropertySourcesPlaceholderConfigurer.java:137)
	at org.springframework.context.support.PropertySourcesPlaceholderConfigurer$1.getProperty(PropertySourcesPlaceholderConfigurer.java:133)
	at org.springframework.core.env.PropertySourcesPropertyResolver.getProperty(PropertySourcesPropertyResolver.java:85)
	at org.springframework.core.env.PropertySourcesPropertyResolver.getPropertyAsRawString(PropertySourcesPropertyResolver.java:74)
	at org.springframework.util.PropertyPlaceholderHelper.parseStringValue(PropertyPlaceholderHelper.java:151)
	at org.springframework.util.PropertyPlaceholderHelper.replacePlaceholders(PropertyPlaceholderHelper.java:124)
	at org.springframework.core.env.AbstractPropertyResolver.doResolvePlaceholders(AbstractPropertyResolver.java:239)
	at org.springframework.core.env.AbstractPropertyResolver.resolveRequiredPlaceholders(AbstractPropertyResolver.java:210)
	at org.springframework.context.support.PropertySourcesPlaceholderConfigurer.lambda$processProperties$0(PropertySourcesPlaceholderConfigurer.java:175)
	at org.springframework.beans.factory.support.AbstractBeanFactory.resolveEmbeddedValue(AbstractBeanFactory.java:918)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1248)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1227)
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:884)
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:788)
	at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:227)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1356)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1203)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:556)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:516)
	... 15 common frames omitted
2020-09-21 04:22:36,005 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 29529 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-21 04:22:36,010 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-21 04:22:36,010 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-21 04:22:37,478 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-21 04:22:37,494 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-21 04:22:37,495 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-21 04:22:37,495 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-21 04:22:37,598 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-21 04:22:37,598 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1523 ms
2020-09-21 04:22:37,884 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-21 04:22:38,140 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 04:22:38,633 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-21 04:22:38,644 [main] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext -  - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'; nested exception is org.springframework.boot.web.server.PortInUseException: Port 8080 is already in use
2020-09-21 04:22:38,646 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Shutting down ExecutorService 'applicationTaskExecutor'
2020-09-21 04:22:38,651 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Pausing ProtocolHandler ["http-nio-8080"]
2020-09-21 04:22:38,651 [main] INFO  o.a.catalina.core.StandardService -  - Stopping service [Tomcat]
2020-09-21 04:22:38,659 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Stopping ProtocolHandler ["http-nio-8080"]
2020-09-21 04:22:38,659 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Destroying ProtocolHandler ["http-nio-8080"]
2020-09-21 04:22:38,672 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLoggingListener -  - 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2020-09-21 04:22:38,677 [main] ERROR o.s.b.d.LoggingFailureAnalysisReporter -  - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Web server failed to start. Port 8080 was already in use.

Action:

Identify and stop the process that's listening on port 8080 or configure this application to listen on another port.

2020-09-21 04:22:54,111 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 29582 (/opt/projects/source/sales-importer/bin/main started by fabio in /opt/projects/source/sales-importer)
2020-09-21 04:22:54,115 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-21 04:22:54,116 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-21 04:22:55,552 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-21 04:22:55,567 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-21 04:22:55,567 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-21 04:22:55,568 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-21 04:22:55,666 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-21 04:22:55,666 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1491 ms
2020-09-21 04:22:56,007 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-21 04:22:56,353 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 04:22:56,737 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-21 04:22:56,768 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-21 04:22:56,896 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-21 04:22:56,897 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-21 04:22:56,897 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-21 04:22:57,242 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-21 04:22:57,244 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-21 04:22:57,245 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-21 04:22:57,267 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-21 04:22:57,274 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-21 04:22:57,276 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemWritingId started and consuming from: direct://filesystemWriting
2020-09-21 04:22:57,276 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemWritingErrorsId started and consuming from: direct://filesystemWritingErrors
2020-09-21 04:22:57,276 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: exportReportId started and consuming from: direct://exportReport
2020-09-21 04:22:57,276 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: exportErrorsId started and consuming from: direct://exportErrors
2020-09-21 04:22:57,276 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-21 04:22:57,276 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-21 04:22:57,277 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-21 04:22:57,277 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-21 04:22:57,277 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-21 04:22:57,277 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-21 04:22:57,280 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 11 routes, of which 11 are started
2020-09-21 04:22:57,281 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.039 seconds
2020-09-21 04:22:57,285 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 3.815 seconds (JVM running for 4.617)
2020-09-21 04:23:20,011 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Importando o arquivo sales.csv
2020-09-21 04:23:20,012 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-21 04:23:20,027 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-21 04:23:20,028 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-21 04:23:20,052 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-21 04:23:20,053 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-21 04:23:20,054 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-21 04:23:20,055 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-21 04:23:20,074 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-21 04:23:20,075 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-21 04:23:20,076 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-21 04:23:20,077 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-21 04:23:20,077 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-21 04:23:20,081 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 04:23:20,082 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-21 04:23:20,085 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.v.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.exception.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parseRecord(SaleItemsParser.java:35)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parse(SaleItemsParser.java:28)
	at com.github.fabiosoaza.salesimporter.infrastructure.validator.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.infrastructure.predicate.IsValidRecordPredicate.matches(IsValidRecordPredicate.java:25)
	at org.apache.camel.support.builder.PredicateBuilder$1.matches(PredicateBuilder.java:51)
	at org.apache.camel.processor.FilterProcessor.matches(FilterProcessor.java:77)
	at org.apache.camel.processor.ChoiceProcessor.process(ChoiceProcessor.java:80)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 04:23:20,087 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.v.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.exception.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parseRecord(SaleItemsParser.java:35)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parse(SaleItemsParser.java:28)
	at com.github.fabiosoaza.salesimporter.infrastructure.validator.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.infrastructure.processor.TransformerProcessor.lambda$2(TransformerProcessor.java:40)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:174)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1382)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.processor.TransformerProcessor.process(TransformerProcessor.java:41)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 04:23:20,099 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado da Importao. Summary [totalClients=2, totalSellers=2, mostExpensiveSaleId=04, worstPerformanceSellerName=Pedro]
2020-09-21 04:23:20,101 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesExportRoutes -  -  Resultado Total ClientsTotal SellersMost Expensive Sale IdWorst Performance Seller
2204Pedro

2020-09-21 04:23:20,102 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Exportando o arquivo sales.out.csv
2020-09-21 04:23:20,104 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesExportRoutes -  - Importao contm erros gerando o arquivo com os detalhes.
2020-09-21 04:23:20,104 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesExportRoutes -  -  Erros Error parsing line 11
Error parsing line 12
2020-09-21 04:23:20,104 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Exportando o arquivo com os erros da importao sales.out.errors.csv
2020-09-21 04:29:23,562 [Test worker] INFO  o.s.b.t.c.SpringBootTestContextBootstrapper -  - Neither @ContextConfiguration nor @ContextHierarchy found for test class [com.github.fabiosoaza.salesimporter.SalesImporterApplicationTests], using SpringBootContextLoader
2020-09-21 04:29:23,570 [Test worker] INFO  o.s.t.c.s.AbstractContextLoader -  - Could not detect default resource locations for test class [com.github.fabiosoaza.salesimporter.SalesImporterApplicationTests]: no resource found for suffixes {-context.xml, Context.groovy}.
2020-09-21 04:29:23,572 [Test worker] INFO  o.s.t.c.s.AnnotationConfigContextLoaderUtils -  - Could not detect default configuration classes for test class [com.github.fabiosoaza.salesimporter.SalesImporterApplicationTests]: SalesImporterApplicationTests does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2020-09-21 04:29:23,714 [Test worker] INFO  o.s.b.t.c.SpringBootTestContextBootstrapper -  - Neither @ContextConfiguration nor @ContextHierarchy found for test class [com.github.fabiosoaza.salesimporter.SalesImporterApplicationTests], using SpringBootContextLoader
2020-09-21 04:29:23,718 [Test worker] INFO  o.s.t.c.s.AbstractContextLoader -  - Could not detect default resource locations for test class [com.github.fabiosoaza.salesimporter.SalesImporterApplicationTests]: no resource found for suffixes {-context.xml, Context.groovy}.
2020-09-21 04:29:23,719 [Test worker] INFO  o.s.t.c.s.AnnotationConfigContextLoaderUtils -  - Could not detect default configuration classes for test class [com.github.fabiosoaza.salesimporter.SalesImporterApplicationTests]: SalesImporterApplicationTests does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2020-09-21 04:29:23,752 [Test worker] INFO  o.s.b.t.c.SpringBootTestContextBootstrapper -  - Neither @ContextConfiguration nor @ContextHierarchy found for test class [com.github.fabiosoaza.salesimporter.SalesImporterApplicationTests], using SpringBootContextLoader
2020-09-21 04:29:23,753 [Test worker] INFO  o.s.t.c.s.AbstractContextLoader -  - Could not detect default resource locations for test class [com.github.fabiosoaza.salesimporter.SalesImporterApplicationTests]: no resource found for suffixes {-context.xml, Context.groovy}.
2020-09-21 04:29:23,753 [Test worker] INFO  o.s.t.c.s.AnnotationConfigContextLoaderUtils -  - Could not detect default configuration classes for test class [com.github.fabiosoaza.salesimporter.SalesImporterApplicationTests]: SalesImporterApplicationTests does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2020-09-21 04:34:08,700 [main] INFO  o.s.b.t.c.SpringBootTestContextBootstrapper -  - Neither @ContextConfiguration nor @ContextHierarchy found for test class [com.github.fabiosoaza.salesimporter.SalesImporterApplicationTests], using SpringBootContextLoader
2020-09-21 04:34:08,706 [main] INFO  o.s.t.c.s.AbstractContextLoader -  - Could not detect default resource locations for test class [com.github.fabiosoaza.salesimporter.SalesImporterApplicationTests]: no resource found for suffixes {-context.xml, Context.groovy}.
2020-09-21 04:34:08,707 [main] INFO  o.s.t.c.s.AnnotationConfigContextLoaderUtils -  - Could not detect default configuration classes for test class [com.github.fabiosoaza.salesimporter.SalesImporterApplicationTests]: SalesImporterApplicationTests does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2020-09-21 04:34:08,810 [main] INFO  o.s.b.t.c.SpringBootTestContextBootstrapper -  - Neither @ContextConfiguration nor @ContextHierarchy found for test class [com.github.fabiosoaza.salesimporter.SalesImporterApplicationTests], using SpringBootContextLoader
2020-09-21 04:34:08,810 [main] INFO  o.s.t.c.s.AbstractContextLoader -  - Could not detect default resource locations for test class [com.github.fabiosoaza.salesimporter.SalesImporterApplicationTests]: no resource found for suffixes {-context.xml, Context.groovy}.
2020-09-21 04:34:08,811 [main] INFO  o.s.t.c.s.AnnotationConfigContextLoaderUtils -  - Could not detect default configuration classes for test class [com.github.fabiosoaza.salesimporter.SalesImporterApplicationTests]: SalesImporterApplicationTests does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2020-09-21 04:34:08,832 [main] INFO  o.s.b.t.c.SpringBootTestContextBootstrapper -  - Neither @ContextConfiguration nor @ContextHierarchy found for test class [com.github.fabiosoaza.salesimporter.SalesImporterApplicationTests], using SpringBootContextLoader
2020-09-21 04:34:08,834 [main] INFO  o.s.t.c.s.AbstractContextLoader -  - Could not detect default resource locations for test class [com.github.fabiosoaza.salesimporter.SalesImporterApplicationTests]: no resource found for suffixes {-context.xml, Context.groovy}.
2020-09-21 04:34:08,834 [main] INFO  o.s.t.c.s.AnnotationConfigContextLoaderUtils -  - Could not detect default configuration classes for test class [com.github.fabiosoaza.salesimporter.SalesImporterApplicationTests]: SalesImporterApplicationTests does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2020-09-21 04:38:23,743 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Starting SalesImporterApplication on unicred-fabio-souza with PID 31848 (/opt/projects/source/sales-importer/build/libs/sales-importer-0.0.1-SNAPSHOT.jar started by fabio in /opt/projects/source/sales-importer)
2020-09-21 04:38:23,745 [main] DEBUG c.g.f.s.a.SalesImporterApplication -  - Running with Spring Boot v2.3.4.RELEASE, Spring v5.2.9.RELEASE
2020-09-21 04:38:23,745 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - No active profile set, falling back to default profiles: default
2020-09-21 04:38:24,851 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat initialized with port(s): 8080 (http)
2020-09-21 04:38:24,865 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Initializing ProtocolHandler ["http-nio-8080"]
2020-09-21 04:38:24,866 [main] INFO  o.a.catalina.core.StandardService -  - Starting service [Tomcat]
2020-09-21 04:38:24,866 [main] INFO  o.a.catalina.core.StandardEngine -  - Starting Servlet engine: [Apache Tomcat/9.0.38]
2020-09-21 04:38:24,967 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] -  - Initializing Spring embedded WebApplicationContext
2020-09-21 04:38:24,968 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext -  - Root WebApplicationContext: initialization completed in 1176 ms
2020-09-21 04:38:25,185 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Initializing ExecutorService 'applicationTaskExecutor'
2020-09-21 04:38:25,380 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 04:38:25,708 [main] INFO  o.a.coyote.http11.Http11NioProtocol -  - Starting ProtocolHandler ["http-nio-8080"]
2020-09-21 04:38:25,733 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer -  - Tomcat started on port(s): 8080 (http) with context path ''
2020-09-21 04:38:25,808 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML routes from: classpath:camel/*.xml
2020-09-21 04:38:25,809 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML route templates from: classpath:camel-template/*.xml
2020-09-21 04:38:25,809 [main] INFO  o.a.c.s.b.SpringBootRoutesCollector -  - Loading additional Camel XML rests from: classpath:camel-rest/*.xml
2020-09-21 04:38:26,067 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is starting
2020-09-21 04:38:26,068 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
2020-09-21 04:38:26,068 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Using HealthCheck: camel-health
2020-09-21 04:38:26,089 [main] INFO  o.a.c.s.u.CamelThreadPoolTaskScheduler -  - Initializing ExecutorService
2020-09-21 04:38:26,096 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemReadingId started and consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-21 04:38:26,098 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemWritingId started and consuming from: direct://filesystemWriting
2020-09-21 04:38:26,098 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: filesystemWritingErrorsId started and consuming from: direct://filesystemWritingErrors
2020-09-21 04:38:26,099 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: exportReportId started and consuming from: direct://exportReport
2020-09-21 04:38:26,099 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: exportErrorsId started and consuming from: direct://exportErrors
2020-09-21 04:38:26,099 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: salesImportId started and consuming from: direct://salesImport
2020-09-21 04:38:26,100 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: parseImportId started and consuming from: direct://parseImport
2020-09-21 04:38:26,100 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSellerId started and consuming from: direct://unmarshalSeller
2020-09-21 04:38:26,100 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalClientId started and consuming from: direct://unmarshalClient
2020-09-21 04:38:26,100 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: unmarshalSaleId started and consuming from: direct://unmarshalSale
2020-09-21 04:38:26,100 [main] INFO  o.a.c.i.e.InternalRouteStartupManager -  - Route: direct:transform started and consuming from: direct://transform
2020-09-21 04:38:26,103 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Total 11 routes, of which 11 are started
2020-09-21 04:38:26,103 [main] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) started in 0.036 seconds
2020-09-21 04:38:26,107 [main] INFO  c.g.f.s.a.SalesImporterApplication -  - Started SalesImporterApplication in 2.771 seconds (JVM running for 3.329)
2020-09-21 04:39:00,033 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Importando o arquivo sales.csv
2020-09-21 04:39:00,035 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesImportRoutes -  - Inicio SPLIT arquivo. sales.csv
2020-09-21 04:39:00,060 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro HeaderHeaderHeaderHeader
2020-09-21 04:39:00,062 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0011234567891234Pedro50000
2020-09-21 04:39:00,084 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 0013245678865434Paulo40000.99
2020-09-21 04:39:00,084 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675434544345Jose da SilvaRural
2020-09-21 04:39:00,085 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Cliente 0022345675433444345Eduardo PereiraRural
2020-09-21 04:39:00,086 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00310[1-10-100,2-30-2.50,3-40-3.10]Pedro
2020-09-21 04:39:00,101 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00308[1-34-10,2-33-1.50,3-40-0.10]Paulo
2020-09-21 04:39:00,102 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00305[1-34-1000,2-33-1.50,3-40-0.10]Fabio
2020-09-21 04:39:00,102 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00304[1-65-1000,2-33-19.50,3-40-0.10]Paulo
2020-09-21 04:39:00,103 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Ignorando Registro Fim do Arquivo
2020-09-21 04:39:00,103 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Vendedor 001Registro Invalido
2020-09-21 04:39:00,105 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.routes.SalesImportRoutes -  -  Erro ao fazer parse da linha. Arquivo sales.csv, Exception: java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1 - java.lang.IllegalArgumentException: Some mandatory fields are missing, line: 1
	at org.apache.camel.dataformat.bindy.BindyCsvFactory.bind(BindyCsvFactory.java:196)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.lambda$consumeFile$0(BindyCsvDataFormat.java:256)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.ReferencePipeline$Head.forEachOrdered(ReferencePipeline.java:657)
	at org.apache.camel.dataformat.bindy.csv.BindyCsvDataFormat.unmarshal(BindyCsvDataFormat.java:179)
	at org.apache.camel.support.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:64)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2020-09-21 04:39:00,105 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Dados Venda 00309[1-34-10,2-33-1.50,3-40]Paulo
2020-09-21 04:39:00,107 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.v.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.exception.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parseRecord(SaleItemsParser.java:35)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parse(SaleItemsParser.java:28)
	at com.github.fabiosoaza.salesimporter.infrastructure.validator.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.infrastructure.predicate.IsValidRecordPredicate.matches(IsValidRecordPredicate.java:25)
	at org.apache.camel.support.builder.PredicateBuilder$1.matches(PredicateBuilder.java:51)
	at org.apache.camel.processor.FilterProcessor.matches(FilterProcessor.java:77)
	at org.apache.camel.processor.ChoiceProcessor.process(ChoiceProcessor.java:80)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.processor.Pipeline$PipelineTask.run(Pipeline.java:90)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 04:39:00,109 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] ERROR c.g.f.s.i.v.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.exception.ParseRecordException: Invalid Record: 3-40
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parseRecord(SaleItemsParser.java:35)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.parser.SaleItemsParser.parse(SaleItemsParser.java:28)
	at com.github.fabiosoaza.salesimporter.infrastructure.validator.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.infrastructure.processor.TransformerProcessor.lambda$process$2(TransformerProcessor.java:40)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:174)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)
	at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1384)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.collect(ReferencePipeline.java:566)
	at com.github.fabiosoaza.salesimporter.infrastructure.processor.TransformerProcessor.process(TransformerProcessor.java:41)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:66)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:404)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:147)
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:287)
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:483)
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:237)
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:198)
	at org.apache.camel.support.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:190)
	at org.apache.camel.support.ScheduledPollConsumer.run(ScheduledPollConsumer.java:107)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:93)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2020-09-21 04:39:00,114 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesImportRoutes -  - Resultado da Importao. Summary [totalClients=2, totalSellers=2, mostExpensiveSaleId=04, worstPerformanceSellerName=Pedro]
2020-09-21 04:39:00,115 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesExportRoutes -  -  Resultado Total ClientsTotal SellersMost Expensive Sale IdWorst Performance Seller
2204Pedro

2020-09-21 04:39:00,115 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Exportando o arquivo sales.out.csv
2020-09-21 04:39:00,118 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.SalesExportRoutes -  - Importao contm erros gerando o arquivo com os detalhes.
2020-09-21 04:39:00,118 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] DEBUG c.g.f.s.i.routes.SalesExportRoutes -  -  Erros Error parsing line 11
Error parsing line 12
2020-09-21 04:39:00,118 [Camel (camel-1) thread #1 - file:///home/fabio/Documents/sales-importer/in] INFO  c.g.f.s.i.routes.FileSystemIORoutes -  - Exportando o arquivo com os erros da importao sales.out.errors.csv
2020-09-21 04:39:19,671 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutting down
2020-09-21 04:39:19,672 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Starting to graceful shutdown 11 routes (timeout 45 seconds)
2020-09-21 04:39:19,676 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: direct:transform shutdown complete, was consuming from: direct://transform
2020-09-21 04:39:19,676 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: unmarshalSaleId shutdown complete, was consuming from: direct://unmarshalSale
2020-09-21 04:39:19,676 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: unmarshalClientId shutdown complete, was consuming from: direct://unmarshalClient
2020-09-21 04:39:19,676 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: unmarshalSellerId shutdown complete, was consuming from: direct://unmarshalSeller
2020-09-21 04:39:19,676 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: parseImportId shutdown complete, was consuming from: direct://parseImport
2020-09-21 04:39:19,676 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: salesImportId shutdown complete, was consuming from: direct://salesImport
2020-09-21 04:39:19,677 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: exportErrorsId shutdown complete, was consuming from: direct://exportErrors
2020-09-21 04:39:19,677 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: exportReportId shutdown complete, was consuming from: direct://exportReport
2020-09-21 04:39:19,677 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemWritingErrorsId shutdown complete, was consuming from: direct://filesystemWritingErrors
2020-09-21 04:39:19,677 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemWritingId shutdown complete, was consuming from: direct://filesystemWriting
2020-09-21 04:39:19,678 [Camel (camel-1) thread #2 - ShutdownTask] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Route: filesystemReadingId shutdown complete, was consuming from: file:///home/fabio/Documents/sales-importer/in
2020-09-21 04:39:19,679 [SpringContextShutdownHook] INFO  o.a.c.i.e.DefaultShutdownStrategy -  - Graceful shutdown of 11 routes completed in 0 seconds
2020-09-21 04:39:19,687 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) uptime 53.620 seconds
2020-09-21 04:39:19,687 [SpringContextShutdownHook] INFO  o.a.c.i.engine.AbstractCamelContext -  - Apache Camel 3.5.0 (camel-1) is shutdown in 0.016 seconds
2020-09-21 04:39:19,747 [SpringContextShutdownHook] INFO  o.s.s.c.ThreadPoolTaskExecutor -  - Shutting down ExecutorService 'applicationTaskExecutor'
2020-09-21 20:14:06,318 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 20:14:36,123 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 20:14:46,854 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 20:15:37,761 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 20:15:49,361 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 20:17:27,285 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 20:17:36,525 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 20:35:54,390 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 20:37:55,094 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 20:39:20,433 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 20:40:07,430 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 20:41:06,848 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 20:47:16,440 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 20:48:17,514 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 20:49:16,925 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 20:49:27,984 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 20:50:10,769 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 20:51:26,041 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 20:52:46,659 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 20:54:46,392 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 20:54:55,340 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 21:07:18,589 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 21:11:58,729 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 21:17:33,198 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 21:19:11,048 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 21:20:00,022 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 21:20:28,219 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 21:21:22,946 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 21:22:04,604 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 21:27:04,748 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 21:30:10,776 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 21:33:57,553 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 21:35:03,460 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 21:36:12,340 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 21:38:38,829 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 21:39:54,226 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 21:42:49,282 [main] INFO  o.a.camel.support.LRUCacheFactory -  - Detected and using LRUCacheFactory: camel-caffeine-lrucache
2020-09-21 22:47:51,055 [main] ERROR c.g.f.s.i.v.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.exception.ParseRecordException: Exception
	at com.github.fabiosoaza.salesimporter.infrastructure.validator.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.validator.ImportRecordValidatorTest.shouReturnFalseIfExceptionIsThrown(ImportRecordValidatorTest.java:47)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:686)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$6(TestMethodTestDescriptor.java:212)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:208)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:137)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:71)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:135)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:125)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:135)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:123)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:122)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:80)
	at java.util.ArrayList.forEach(ArrayList.java:1257)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:125)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:135)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:123)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:122)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:80)
	at java.util.ArrayList.forEach(ArrayList.java:1257)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:125)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:135)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:123)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:122)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:80)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:229)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$6(DefaultLauncher.java:197)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:191)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:137)
	at org.eclipse.jdt.internal.junit5.runner.JUnit5TestReference.run(JUnit5TestReference.java:89)
	at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:41)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:541)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:763)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:463)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:209)
2020-09-21 22:47:56,407 [main] ERROR c.g.f.s.i.v.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.exception.ParseRecordException: Exception
	at com.github.fabiosoaza.salesimporter.infrastructure.validator.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.validator.ImportRecordValidatorTest.shouReturnFalseIfExceptionIsThrown(ImportRecordValidatorTest.java:47)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:686)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$6(TestMethodTestDescriptor.java:212)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:208)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:137)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:71)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:135)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:125)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:135)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:123)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:122)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:80)
	at java.util.ArrayList.forEach(ArrayList.java:1257)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:125)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:135)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:123)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:122)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:80)
	at java.util.ArrayList.forEach(ArrayList.java:1257)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:125)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:135)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:123)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:122)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:80)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:229)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$6(DefaultLauncher.java:197)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:191)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:137)
	at org.eclipse.jdt.internal.junit5.runner.JUnit5TestReference.run(JUnit5TestReference.java:89)
	at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:41)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:541)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:763)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:463)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:209)
2020-09-21 22:49:22,677 [main] ERROR c.g.f.s.i.v.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.exception.ParseRecordException: Exception
	at com.github.fabiosoaza.salesimporter.infrastructure.validator.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.validator.ImportRecordValidatorTest.shouReturnFalseIfExceptionIsThrown(ImportRecordValidatorTest.java:47)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:686)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$6(TestMethodTestDescriptor.java:212)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:208)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:137)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:71)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:135)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:125)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:135)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:123)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:122)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:80)
	at java.util.ArrayList.forEach(ArrayList.java:1257)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:125)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:135)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:123)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:122)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:80)
	at java.util.ArrayList.forEach(ArrayList.java:1257)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:125)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:135)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:123)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:122)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:80)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:229)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$6(DefaultLauncher.java:197)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:191)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:137)
	at org.eclipse.jdt.internal.junit5.runner.JUnit5TestReference.run(JUnit5TestReference.java:89)
	at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:41)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:541)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:763)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:463)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:209)
2020-09-21 22:49:56,597 [main] ERROR c.g.f.s.i.v.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.exception.ParseRecordException: Exception
	at com.github.fabiosoaza.salesimporter.infrastructure.validator.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.validator.ImportRecordValidatorTest.shouReturnFalseIfExceptionIsThrown(ImportRecordValidatorTest.java:47)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:686)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$6(TestMethodTestDescriptor.java:212)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:208)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:137)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:71)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:135)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:125)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:135)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:123)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:122)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:80)
	at java.util.ArrayList.forEach(ArrayList.java:1257)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:125)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:135)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:123)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:122)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:80)
	at java.util.ArrayList.forEach(ArrayList.java:1257)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:125)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:135)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:123)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:122)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:80)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:229)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$6(DefaultLauncher.java:197)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:191)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:137)
	at org.eclipse.jdt.internal.junit5.runner.JUnit5TestReference.run(JUnit5TestReference.java:89)
	at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:41)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:541)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:763)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:463)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:209)
2020-09-21 22:50:03,039 [main] ERROR c.g.f.s.i.v.ImportRecordValidator -  - Error parsing record
com.github.fabiosoaza.salesimporter.infrastructure.exception.ParseRecordException: Exception
	at com.github.fabiosoaza.salesimporter.infrastructure.validator.ImportRecordValidator.validate(ImportRecordValidator.java:33)
	at com.github.fabiosoaza.salesimporter.validator.ImportRecordValidatorTest.shouReturnFalseIfExceptionIsThrown(ImportRecordValidatorTest.java:47)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:686)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$6(TestMethodTestDescriptor.java:212)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:208)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:137)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:71)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:135)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:125)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:135)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:123)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:122)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:80)
	at java.util.ArrayList.forEach(ArrayList.java:1257)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:125)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:135)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:123)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:122)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:80)
	at java.util.ArrayList.forEach(ArrayList.java:1257)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:125)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:135)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:123)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:122)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:80)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:229)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$6(DefaultLauncher.java:197)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:191)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:137)
	at org.eclipse.jdt.internal.junit5.runner.JUnit5TestReference.run(JUnit5TestReference.java:89)
	at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:41)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:541)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:763)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:463)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:209)
